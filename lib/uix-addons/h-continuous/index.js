!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("UIExtension"),require("UIExtension").PDFViewCtrl):"function"==typeof define&&define.amd?define(["UIExtension",["UIExtension","PDFViewCtrl"]],t):"object"==typeof exports?exports.HContinuousViewModeAddon=t(require("UIExtension"),require("UIExtension").PDFViewCtrl):e.HContinuousViewModeAddon=t(e.UIExtension,e.UIExtension.PDFViewCtrl)}(self,(function(e,t){return function(){var n={469:function(e){e.exports=null},616:function(t){"use strict";t.exports=e},290:function(e){"use strict";e.exports=t}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={exports:{}};return n[e](r,r.exports,i),r.exports}i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var r={};return function(){"use strict";function e(){return e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},e.apply(this,arguments)}function t(e,n){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},t(e,n)}function n(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,t(e,n)}i.d(r,{default:function(){return v}});var o=i(616),s=i(469),a=i.n(s);var d=i(290);let l=function(e){function t(){return e.apply(this,arguments)||this}return n(t,e),t}(d.viewMode.UsualViewModeShortcutHandler);const{ViewerEvents:c,vendors:u}=d,{jQuery:h}=u,{debounce:g}=d.commons;let f=function(e){function t(t){var n;return(n=e.call(this,t)||this).diffHCache=null,n.pdfViewer=t.pdfViewer,n._rotateCallback=n._rotateCallback.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n)),n.scrollCurrentPageIntoView_debounced=g((()=>{n.scrollCurrentPageIntoView()}),20),n}n(t,e),t.getName=function(){return"h-continuous-view-mode"};var o=t.prototype;return o.getJQItems=function(){return h(e.prototype.getItems.call(this))},o.into=function(t,n){e.prototype.into.call(this,t,n),this.pdfViewer.element.classList.add("fv__h-continuous-view-mode-layout");const o=this.constructor.getName(),i=["<style>","."+o+"{","white-space:nowrap;","height:100%;","display: flex;","align-items: center","}","."+o+":before{",'content:"";',"display:inline-block;","height:100%;","vertical-align: middle;","}","."+o+" .fv__pdf-view-mode-item{","margin-left:10px;","display:inline-block;","vertical-align: middle;","align-self: stretch;","display: flex;","align-items: center;","}","."+o+" .fv__pdf-view-mode-item .fv__pdf-page-not-rendered{","width: 50vw;","}","."+o+" .fv__pdf-page-layout.fv__rendering{","min-width:128px;","}","."+o+" .fv__pdf-view-mode-item:first-child{","margin-left:10px;","}","</style>"].join("");this.$style=h(i),this.docRender.$container.after(this.$style),this.docRender.$container.addClass(this.constructor.getName()),this.docRender.$ui.parents(".fv__ui-pdfviewer").css({"overflow-y":"unset","overflow-x":"scroll"}),this.pdfViewer.eventEmitter.on(c.pageRotationChange,this.rotateCallback=(e,t,n)=>{let o=this.pdfViewer.getPDFPageRender(e.getIndex());this._rotateCallback(o,t)}),this.pdfViewer.eventEmitter.on(c.pagesRotated,this.rotatePagesCallback=(e,t,n)=>{e.forEach(((e,t)=>{this.rotateCallback(e,newRotation,oldRotations[t])}))});let r=this.docRender.viewerRender.scrollWrap;this._unwatchScrollEvent=r.addScrollEventListener((()=>{clearTimeout(this.scrollEventTimer);const e=this.getCurrentPageIndex();this.scrollEventTimer=setTimeout((()=>{let t=this.docRender.pagesRender;t&&t.renderVisiblePages().then((()=>{const t=this.getCurrentPageIndex();t!==e&&this.docRender.setCurrentPageIndex(t)}),(function(){}))}),30)})),this.onPageNumberChange=()=>{this.scrollCurrentPageIntoView_debounced()},this.unobservePageNumberChangeEvent=this.pdfViewer.addEventListener(c.pageNumberChange,this.onPageNumberChange)},o.renderViewMode=function(e,t,n,o,i){},o.jumpToPage=function(e,{x:t=0,y:n=0}){let o=this.getJQItems();e>=o.length?e=o.length-1:e<0&&(e=0);let i=o[e],r=i.offsetLeft+t,s=i.firstElementChild.offsetTop+n;this.docRender.viewerRender.scrollWrap.scrollTo(r,s),this.docRender.viewerRender.scrollWrap.disabled||this.scrollCurrentPageIntoView_debounced()},o._rotateCallback=function(e,t){let n=e.getShowWidth(),o=e.getShowHeight();this.getJQItems().eq(e.index);if(t%2!=0){let e=n;n=o,o=e}this.docRender.pagesRender.$ui.height()},o.getCurrentPageIndex=function(){let e,t=this.getJQItems(),n=this.docRender.viewerRender.scrollWrap.getScrollHost();e=n===window?{x:0,y:0,right:window.innerWidth,height:window.innerHeight}:n.getBoundingClientRect();let o=0,i=0,r=0;for(let n=0;n<t.length;n++){let s=t[n].getBoundingClientRect(),a=p(e,s);if(a&&0==r&&(r=1),a>o&&(o=a,i=n),!a&&1==r){r=2;break}}return i},o.getFitHeight=function(e){let t=this.docRender.viewerRender.scrollWrap;return t.getHeight()-t.getScrollOffsetTop()},o.getFitWidth=function(e){return this.docRender.viewerRender.scrollWrap.getScrollHost().clientWidth},o.getNextPageIndex=function(){const e=this.docRender.doc.getPageCount();let t=this.getCurrentPageIndex();return t<e-1&&t++,t},o.getPrevPageIndex=function(){let e=this.getCurrentPageIndex();return e>0&&e--,e},o.out=function(){this.pdfViewer.element.classList.remove("fv__h-continuous-view-mode-layout"),this._unwatchScrollEvent&&this._unwatchScrollEvent(),this.docRender.$container.removeClass(this.constructor.getName()),this.docRender.$ui.parents(".fv__ui-pdfviewer").css({"overflow-x":"","overflow-y":""}),this.pdfViewer.eventEmitter.off(c.pageRotationChange,this.rotateCallback),this.pdfViewer.eventEmitter.off(c.pagesRotated,this.rotatePagesCallback),this.docRender.pagesRender.$ui.css({paddingTop:"",paddingBottom:""}),this.unobservePageNumberChangeEvent(),this.$style&&this.$style.remove();const e=this.getJQItems();for(let t=0;t<e.length;t++)e.eq(t).css({paddingTop:"",paddingBottom:"",marginTop:"",marginBottom:"",paddingLeft:"",paddingRight:"",marginLeft:"",marginRight:""})},o.generateShortcutEventHandler=function(){return new l(this)},o.scrollCurrentPageIntoView=function(){if(!this.docRender)return;const e=this.docRender.getCurrentPageIndex(),t=this.docRender.getPDFPageRender(e);t&&!t.pageAreaIsVisible&&t.$ui.get(0).scrollIntoViewIfNeeded(!0)},t}(d.IViewMode);const p=(e,t,n=!1)=>{let o=Math.max(e.left,t.left),i=Math[n?"min":"max"](e.top,t.top),r=Math[n?"max":"min"](e.bottom,t.bottom),s=Math.min(e.right,t.right);if(o<=s)if(n){if(i>=r)return(s-o)*(i-r)}else if(i<=r)return(s-o)*(r-i);return 0},{replaceRibbonButton2XButton:m}=o.shared,w=(o.Controller,o.PDFViewCtrl.Events);let v=function(t){function i(){return t.apply(this,arguments)||this}return n(i,t),i.getName=function(){return"h-continuous"},i.getLoader=function(){return a()},i.initOnLoad=function(){const t=o.modular.module("h-continuous",[]);t.registerController(function(e){function t(t){return e.call(this,t,f.getName())||this}return n(t,e),t.getName=function(){return"HContinuousViewModeController"},t.prototype.mounted=function(){const t=this.getPDFUI(),n=t.addViewerEventListener(w.openFileSuccess,(e=>{let n=e.getPageCount();this.getPDFUI().getPDFViewerRender().then((e=>{let o=e.getViewMode().getName();n<2||this.portfolioService.isDocumentClosed()||t.pdfViewer.currentPDFDoc.isPortfolio()&&"cover"!==this.portfolioLayoutService.getLayoutMode()?this.component.disable():(this.component.enable(),o===this.viewModeName&&this.component.active())}))}));this.addDestroyHook(n),this.addDestroyHook(t.addViewerEventListener(w.pageAdded,(()=>{t.getPDFViewerRender().then((e=>{e.pdfDocRender.getPDFDoc().getPageCount()<2?this.component.disable():this.component.enable()}))}))),this.addDestroyHook(t.addViewerEventListener(w.insertPages,(()=>{t.getPDFViewerRender().then((e=>{e.pdfDocRender.getPDFDoc().getPageCount()<2?this.component.disable():this.component.enable()}))}))),this.addDestroyHook(t.addViewerEventListener(w.pageRemoved,(()=>{t.getPDFViewerRender().then((e=>{e.pdfDocRender.getPDFDoc().getPageCount()<2?this.component.disable():this.component.enable()}))}))),this.addDestroyHook(t.addViewerEventListener(w.pagesRemoved,(()=>{t.getPDFViewerRender().then((e=>{e.pdfDocRender.getPDFDoc().getPageCount()<2?this.component.disable():this.component.enable()}))}))),e.prototype.mounted.call(this)},t}(o.controllers.ViewModeController));const i={template:'\n            <ribbon-button small="true" @tooltip tooltip-title="h-continuous:buttons.title" @controller="h-continuous:HContinuousViewModeController" name="h-continuous-button" icon-class="fv__icon-toolbar-h-continuous-page" @aria:label="h-continuous:buttons.title">h-continuous:buttons.title</ribbon-button>\n            '};t.registerPreConfiguredComponent("h-continuous-ribbon-button",i),t.registerPreConfiguredComponent("h-continuous-button",e({},i,{template:m(i.template)}))},i.prototype.init=function(e,n){t.prototype.init.call(this,e,n),n.getViewModeManager().register(f)},i}(o.UIXAddon)}(),r=r.default}()}));