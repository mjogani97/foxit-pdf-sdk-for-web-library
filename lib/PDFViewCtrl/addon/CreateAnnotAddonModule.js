!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("PDFViewCtrl"),require("jquery"),require("PDFViewCtrl").PDFViewer,require("PDFViewCtrl").commons):"function"==typeof define&&define.amd?define(["PDFViewCtrl","jquery",["PDFViewCtrl","PDFViewer"],["PDFViewCtrl","commons"]],e):"object"==typeof exports?exports.PDFViewCtrl_CreateAnnotAddonModule=e(require("PDFViewCtrl"),require("jquery"),require("PDFViewCtrl").PDFViewer,require("PDFViewCtrl").commons):t.PDFViewCtrl_CreateAnnotAddonModule=e(t.PDFViewCtrl,t.jQuery,t.PDFViewCtrl.PDFViewer,t.PDFViewCtrl.commons)}(self,(function(t,e,n,r){return function(){var i={6425:function(t,e,n){var r=n(3118),i=n(9435);function o(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}o.prototype=r(i.prototype),o.prototype.constructor=o,t.exports=o},7548:function(t,e,n){var r=n(3118),i=n(9435);function o(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}o.prototype=r(i.prototype),o.prototype.constructor=o,t.exports=o},3118:function(t,e,n){var r=n(3218),i=Object.create,o=function(){function t(){}return function(e){if(!r(e))return{};if(i)return i(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=o},9435:function(t){t.exports=function(){}},6450:function(t){t.exports=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}},1913:function(t,e,n){var r=n(6425),i=n(7548),o=n(6450);t.exports=function(t){if(t instanceof r)return t.clone();var e=new i(t.__wrapped__,t.__chain__);return e.__actions__=o(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}},1263:function(t,e,n){var r=n(8111);t.exports=function(t){var e=r(t);return e.__chain__=!0,e}},1469:function(t){var e=Array.isArray;t.exports=e},3218:function(t){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},7005:function(t){t.exports=function(t){return null!=t&&"object"==typeof t}},8111:function(t,e,n){var r=n(6425),i=n(7548),o=n(9435),a=n(1469),s=n(7005),c=n(1913),u=Object.prototype.hasOwnProperty;function l(t){if(s(t)&&!a(t)&&!(t instanceof r)){if(t instanceof i)return t;if(u.call(t,"__wrapped__"))return c(t)}return new i(t)}l.prototype=o.prototype,l.prototype.constructor=l,t.exports=l},5778:function(e){"use strict";e.exports=t},2047:function(t){"use strict";t.exports=e},5602:function(t){"use strict";t.exports=n},8457:function(t){"use strict";t.exports=r},509:function(t,e,n){"use strict";var r=n(9985),i=n(3691),o=TypeError;t.exports=function(t){if(r(t))return t;throw new o(i(t)+" is not a function")}},2655:function(t,e,n){"use strict";var r=n(9429),i=n(3691),o=TypeError;t.exports=function(t){if(r(t))return t;throw new o(i(t)+" is not a constructor")}},3550:function(t,e,n){"use strict";var r=n(9985),i=String,o=TypeError;t.exports=function(t){if("object"==typeof t||r(t))return t;throw new o("Can't set "+i(t)+" as a prototype")}},7370:function(t,e,n){"use strict";var r=n(4201),i=n(5391),o=n(2560).f,a=r("unscopables"),s=Array.prototype;void 0===s[a]&&o(s,a,{configurable:!0,value:i(null)}),t.exports=function(t){s[a][t]=!0}},1514:function(t,e,n){"use strict";var r=n(730).charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},767:function(t,e,n){"use strict";var r=n(3622),i=TypeError;t.exports=function(t,e){if(r(e,t))return t;throw new i("Incorrect invocation")}},5027:function(t,e,n){"use strict";var r=n(8999),i=String,o=TypeError;t.exports=function(t){if(r(t))return t;throw new o(i(t)+" is not an object")}},7075:function(t){"use strict";t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},4872:function(t,e,n){"use strict";var r,i,o,a=n(7075),s=n(7697),c=n(9037),u=n(9985),l=n(8999),h=n(6812),d=n(926),f=n(3691),p=n(5773),g=n(1880),m=n(2148),v=n(3622),y=n(1868),w=n(9385),S=n(4201),A=n(4630),x=n(618),b=x.enforce,R=x.get,E=c.Int8Array,T=E&&E.prototype,P=c.Uint8ClampedArray,C=P&&P.prototype,_=E&&y(E),I=T&&y(T),D=Object.prototype,M=c.TypeError,L=S("toStringTag"),k=A("TYPED_ARRAY_TAG"),V="TypedArrayConstructor",H=a&&!!w&&"Opera"!==d(c.opera),O=!1,N={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},U={BigInt64Array:8,BigUint64Array:8},j=function(t){var e=y(t);if(l(e)){var n=R(e);return n&&h(n,V)?n[V]:j(e)}},F=function(t){if(!l(t))return!1;var e=d(t);return h(N,e)||h(U,e)};for(r in N)(o=(i=c[r])&&i.prototype)?b(o)[V]=i:H=!1;for(r in U)(o=(i=c[r])&&i.prototype)&&(b(o)[V]=i);if((!H||!u(_)||_===Function.prototype)&&(_=function(){throw new M("Incorrect invocation")},H))for(r in N)c[r]&&w(c[r],_);if((!H||!I||I===D)&&(I=_.prototype,H))for(r in N)c[r]&&w(c[r].prototype,I);if(H&&y(C)!==I&&w(C,I),s&&!h(I,L))for(r in O=!0,m(I,L,{configurable:!0,get:function(){return l(this)?this[k]:void 0}}),N)c[r]&&p(c[r],k,r);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:H,TYPED_ARRAY_TAG:O&&k,aTypedArray:function(t){if(F(t))return t;throw new M("Target is not a typed array")},aTypedArrayConstructor:function(t){if(u(t)&&(!w||v(_,t)))return t;throw new M(f(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,n,r){if(s){if(n)for(var i in N){var o=c[i];if(o&&h(o.prototype,t))try{delete o.prototype[t]}catch(n){try{o.prototype[t]=e}catch(t){}}}I[t]&&!n||g(I,t,n?e:H&&T[t]||e,r)}},exportTypedArrayStaticMethod:function(t,e,n){var r,i;if(s){if(w){if(n)for(r in N)if((i=c[r])&&h(i,t))try{delete i[t]}catch(t){}if(_[t]&&!n)return;try{return g(_,t,n?e:H&&_[t]||e)}catch(t){}}for(r in N)!(i=c[r])||i[t]&&!n||g(i,t,e)}},getTypedArrayConstructor:j,isView:function(t){if(!l(t))return!1;var e=d(t);return"DataView"===e||h(N,e)||h(U,e)},isTypedArray:F,TypedArray:_,TypedArrayPrototype:I}},1055:function(t,e,n){"use strict";var r=n(4071),i=n(2615),o=n(690),a=n(1228),s=n(3292),c=n(9429),u=n(6310),l=n(6522),h=n(5185),d=n(1664),f=Array;t.exports=function(t){var e=o(t),n=c(this),p=arguments.length,g=p>1?arguments[1]:void 0,m=void 0!==g;m&&(g=r(g,p>2?arguments[2]:void 0));var v,y,w,S,A,x,b=d(e),R=0;if(!b||this===f&&s(b))for(v=u(e),y=n?new this(v):f(v);v>R;R++)x=m?g(e[R],R):e[R],l(y,R,x);else for(A=(S=h(e,b)).next,y=n?new this:[];!(w=i(A,S)).done;R++)x=m?a(S,g,[w.value,R],!0):w.value,l(y,R,x);return y.length=R,y}},4328:function(t,e,n){"use strict";var r=n(5290),i=n(7578),o=n(6310),a=function(t){return function(e,n,a){var s,c=r(e),u=o(c),l=i(a,u);if(t&&n!=n){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((t||l in c)&&c[l]===n)return t||l||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},6834:function(t,e,n){"use strict";var r=n(3689);t.exports=function(t,e){var n=[][t];return!!n&&r((function(){n.call(null,e||function(){return 1},1)}))}},8820:function(t,e,n){"use strict";var r=n(509),i=n(690),o=n(4413),a=n(6310),s=TypeError,c=function(t){return function(e,n,c,u){r(n);var l=i(e),h=o(l),d=a(l),f=t?d-1:0,p=t?-1:1;if(c<2)for(;;){if(f in h){u=h[f],f+=p;break}if(f+=p,t?f<0:d<=f)throw new s("Reduce of empty array with no initial value")}for(;t?f>=0:d>f;f+=p)f in h&&(u=n(u,h[f],f,l));return u}};t.exports={left:c(!1),right:c(!0)}},9015:function(t,e,n){"use strict";var r=n(7578),i=n(6310),o=n(6522),a=Array,s=Math.max;t.exports=function(t,e,n){for(var c=i(t),u=r(e,c),l=r(void 0===n?c:n,c),h=a(s(l-u,0)),d=0;u<l;u++,d++)o(h,d,t[u]);return h.length=d,h}},6004:function(t,e,n){"use strict";var r=n(8844);t.exports=r([].slice)},382:function(t,e,n){"use strict";var r=n(9015),i=Math.floor,o=function(t,e){var n=t.length,c=i(n/2);return n<8?a(t,e):s(t,o(r(t,0,c),e),o(r(t,c),e),e)},a=function(t,e){for(var n,r,i=t.length,o=1;o<i;){for(r=o,n=t[o];r&&e(t[r-1],n)>0;)t[r]=t[--r];r!==o++&&(t[r]=n)}return t},s=function(t,e,n,r){for(var i=e.length,o=n.length,a=0,s=0;a<i||s<o;)t[a+s]=a<i&&s<o?r(e[a],n[s])<=0?e[a++]:n[s++]:a<i?e[a++]:n[s++];return t};t.exports=o},1228:function(t,e,n){"use strict";var r=n(5027),i=n(2125);t.exports=function(t,e,n,o){try{return o?e(r(n)[0],n[1]):e(n)}catch(e){i(t,"throw",e)}}},6431:function(t,e,n){"use strict";var r=n(4201)("iterator"),i=!1;try{var o=0,a={next:function(){return{done:!!o++}},return:function(){i=!0}};a[r]=function(){return this},Array.from(a,(function(){throw 2}))}catch(t){}t.exports=function(t,e){try{if(!e&&!i)return!1}catch(t){return!1}var n=!1;try{var o={};o[r]=function(){return{next:function(){return{done:n=!0}}}},t(o)}catch(t){}return n}},6648:function(t,e,n){"use strict";var r=n(8844),i=r({}.toString),o=r("".slice);t.exports=function(t){return o(i(t),8,-1)}},926:function(t,e,n){"use strict";var r=n(3043),i=n(9985),o=n(6648),a=n(4201)("toStringTag"),s=Object,c="Arguments"===o(function(){return arguments}());t.exports=r?o:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=s(t),a))?n:c?o(e):"Object"===(r=o(e))&&i(e.callee)?"Arguments":r}},8758:function(t,e,n){"use strict";var r=n(6812),i=n(9152),o=n(2474),a=n(2560);t.exports=function(t,e,n){for(var s=i(e),c=a.f,u=o.f,l=0;l<s.length;l++){var h=s[l];r(t,h)||n&&r(n,h)||c(t,h,u(e,h))}}},1748:function(t,e,n){"use strict";var r=n(3689);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},7807:function(t){"use strict";t.exports=function(t,e){return{value:t,done:e}}},5773:function(t,e,n){"use strict";var r=n(7697),i=n(2560),o=n(5684);t.exports=r?function(t,e,n){return i.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},5684:function(t){"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},6522:function(t,e,n){"use strict";var r=n(8360),i=n(2560),o=n(5684);t.exports=function(t,e,n){var a=r(e);a in t?i.f(t,a,o(0,n)):t[a]=n}},2148:function(t,e,n){"use strict";var r=n(8702),i=n(2560);t.exports=function(t,e,n){return n.get&&r(n.get,e,{getter:!0}),n.set&&r(n.set,e,{setter:!0}),i.f(t,e,n)}},1880:function(t,e,n){"use strict";var r=n(9985),i=n(2560),o=n(8702),a=n(5014);t.exports=function(t,e,n,s){s||(s={});var c=s.enumerable,u=void 0!==s.name?s.name:e;if(r(n)&&o(n,u,s),s.global)c?t[e]=n:a(e,n);else{try{s.unsafe?t[e]&&(c=!0):delete t[e]}catch(t){}c?t[e]=n:i.f(t,e,{value:n,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return t}},6045:function(t,e,n){"use strict";var r=n(1880);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},5014:function(t,e,n){"use strict";var r=n(9037),i=Object.defineProperty;t.exports=function(t,e){try{i(r,t,{value:e,configurable:!0,writable:!0})}catch(n){r[t]=e}return e}},7697:function(t,e,n){"use strict";var r=n(3689);t.exports=!r((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},2659:function(t){"use strict";var e="object"==typeof document&&document.all,n=void 0===e&&void 0!==e;t.exports={all:e,IS_HTMLDDA:n}},6420:function(t,e,n){"use strict";var r=n(9037),i=n(8999),o=r.document,a=i(o)&&i(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},6338:function(t){"use strict";t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},3265:function(t,e,n){"use strict";var r=n(6420)("span").classList,i=r&&r.constructor&&r.constructor.prototype;t.exports=i===Object.prototype?void 0:i},7365:function(t,e,n){"use strict";var r=n(71).match(/firefox\/(\d+)/i);t.exports=!!r&&+r[1]},2532:function(t,e,n){"use strict";var r=n(8563),i=n(806);t.exports=!r&&!i&&"object"==typeof window&&"object"==typeof document},8563:function(t){"use strict";t.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},7298:function(t,e,n){"use strict";var r=n(71);t.exports=/MSIE|Trident/.test(r)},3221:function(t,e,n){"use strict";var r=n(71);t.exports=/ipad|iphone|ipod/i.test(r)&&"undefined"!=typeof Pebble},4764:function(t,e,n){"use strict";var r=n(71);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},806:function(t,e,n){"use strict";var r=n(9037),i=n(6648);t.exports="process"===i(r.process)},7486:function(t,e,n){"use strict";var r=n(71);t.exports=/web0s(?!.*chrome)/i.test(r)},71:function(t){"use strict";t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},3615:function(t,e,n){"use strict";var r,i,o=n(9037),a=n(71),s=o.process,c=o.Deno,u=s&&s.versions||c&&c.version,l=u&&u.v8;l&&(i=(r=l.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=+r[1]),t.exports=i},7922:function(t,e,n){"use strict";var r=n(71).match(/AppleWebKit\/(\d+)\./);t.exports=!!r&&+r[1]},2739:function(t){"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},9989:function(t,e,n){"use strict";var r=n(9037),i=n(2474).f,o=n(5773),a=n(1880),s=n(5014),c=n(8758),u=n(5266);t.exports=function(t,e){var n,l,h,d,f,p=t.target,g=t.global,m=t.stat;if(n=g?r:m?r[p]||s(p,{}):(r[p]||{}).prototype)for(l in e){if(d=e[l],h=t.dontCallGetSet?(f=i(n,l))&&f.value:n[l],!u(g?l:p+(m?".":"#")+l,t.forced)&&void 0!==h){if(typeof d==typeof h)continue;c(d,h)}(t.sham||h&&h.sham)&&o(d,"sham",!0),a(n,l,d,t)}}},3689:function(t){"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},8678:function(t,e,n){"use strict";n(4043);var r=n(6576),i=n(1880),o=n(6308),a=n(3689),s=n(4201),c=n(5773),u=s("species"),l=RegExp.prototype;t.exports=function(t,e,n,h){var d=s(t),f=!a((function(){var e={};return e[d]=function(){return 7},7!==""[t](e)})),p=f&&!a((function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[u]=function(){return n},n.flags="",n[d]=/./[d]),n.exec=function(){return e=!0,null},n[d](""),!e}));if(!f||!p||n){var g=r(/./[d]),m=e(d,""[t],(function(t,e,n,i,a){var s=r(t),c=e.exec;return c===o||c===l.exec?f&&!a?{done:!0,value:g(e,n,i)}:{done:!0,value:s(n,e,i)}:{done:!1}}));i(String.prototype,t,m[0]),i(l,d,m[1])}h&&c(l[d],"sham",!0)}},1735:function(t,e,n){"use strict";var r=n(7215),i=Function.prototype,o=i.apply,a=i.call;t.exports="object"==typeof Reflect&&Reflect.apply||(r?a.bind(o):function(){return a.apply(o,arguments)})},4071:function(t,e,n){"use strict";var r=n(6576),i=n(509),o=n(7215),a=r(r.bind);t.exports=function(t,e){return i(t),void 0===e?t:o?a(t,e):function(){return t.apply(e,arguments)}}},7215:function(t,e,n){"use strict";var r=n(3689);t.exports=!r((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},2615:function(t,e,n){"use strict";var r=n(7215),i=Function.prototype.call;t.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},1236:function(t,e,n){"use strict";var r=n(7697),i=n(6812),o=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,s=i(o,"name"),c=s&&"something"===function(){}.name,u=s&&(!r||r&&a(o,"name").configurable);t.exports={EXISTS:s,PROPER:c,CONFIGURABLE:u}},2743:function(t,e,n){"use strict";var r=n(8844),i=n(509);t.exports=function(t,e,n){try{return r(i(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(t){}}},6576:function(t,e,n){"use strict";var r=n(6648),i=n(8844);t.exports=function(t){if("Function"===r(t))return i(t)}},8844:function(t,e,n){"use strict";var r=n(7215),i=Function.prototype,o=i.call,a=r&&i.bind.bind(o,o);t.exports=r?a:function(t){return function(){return o.apply(t,arguments)}}},6058:function(t,e,n){"use strict";var r=n(9037),i=n(9985);t.exports=function(t,e){return arguments.length<2?(n=r[t],i(n)?n:void 0):r[t]&&r[t][e];var n}},1664:function(t,e,n){"use strict";var r=n(926),i=n(4849),o=n(981),a=n(9478),s=n(4201)("iterator");t.exports=function(t){if(!o(t))return i(t,s)||i(t,"@@iterator")||a[r(t)]}},5185:function(t,e,n){"use strict";var r=n(2615),i=n(509),o=n(5027),a=n(3691),s=n(1664),c=TypeError;t.exports=function(t,e){var n=arguments.length<2?s(t):e;if(i(n))return o(r(n,t));throw new c(a(t)+" is not iterable")}},4849:function(t,e,n){"use strict";var r=n(509),i=n(981);t.exports=function(t,e){var n=t[e];return i(n)?void 0:r(n)}},7017:function(t,e,n){"use strict";var r=n(8844),i=n(690),o=Math.floor,a=r("".charAt),s=r("".replace),c=r("".slice),u=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,n,r,h,d){var f=n+t.length,p=r.length,g=l;return void 0!==h&&(h=i(h),g=u),s(d,g,(function(i,s){var u;switch(a(s,0)){case"$":return"$";case"&":return t;case"`":return c(e,0,n);case"'":return c(e,f);case"<":u=h[c(s,1,-1)];break;default:var l=+s;if(0===l)return i;if(l>p){var d=o(l/10);return 0===d?i:d<=p?void 0===r[d-1]?a(s,1):r[d-1]+a(s,1):i}u=r[l-1]}return void 0===u?"":u}))}},9037:function(t,e,n){"use strict";var r=function(t){return t&&t.Math===Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},6812:function(t,e,n){"use strict";var r=n(8844),i=n(690),o=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return o(i(t),e)}},7248:function(t){"use strict";t.exports={}},920:function(t){"use strict";t.exports=function(t,e){try{1===arguments.length?console.error(t):console.error(t,e)}catch(t){}}},2688:function(t,e,n){"use strict";var r=n(6058);t.exports=r("document","documentElement")},8506:function(t,e,n){"use strict";var r=n(7697),i=n(3689),o=n(6420);t.exports=!r&&!i((function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},4413:function(t,e,n){"use strict";var r=n(8844),i=n(3689),o=n(6648),a=Object,s=r("".split);t.exports=i((function(){return!a("z").propertyIsEnumerable(0)}))?function(t){return"String"===o(t)?s(t,""):a(t)}:a},3457:function(t,e,n){"use strict";var r=n(9985),i=n(8999),o=n(9385);t.exports=function(t,e,n){var a,s;return o&&r(a=e.constructor)&&a!==n&&i(s=a.prototype)&&s!==n.prototype&&o(t,s),t}},6738:function(t,e,n){"use strict";var r=n(8844),i=n(9985),o=n(4091),a=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(t){return a(t)}),t.exports=o.inspectSource},618:function(t,e,n){"use strict";var r,i,o,a=n(9834),s=n(9037),c=n(8999),u=n(5773),l=n(6812),h=n(4091),d=n(2713),f=n(7248),p="Object already initialized",g=s.TypeError,m=s.WeakMap;if(a||h.state){var v=h.state||(h.state=new m);v.get=v.get,v.has=v.has,v.set=v.set,r=function(t,e){if(v.has(t))throw new g(p);return e.facade=t,v.set(t,e),e},i=function(t){return v.get(t)||{}},o=function(t){return v.has(t)}}else{var y=d("state");f[y]=!0,r=function(t,e){if(l(t,y))throw new g(p);return e.facade=t,u(t,y,e),e},i=function(t){return l(t,y)?t[y]:{}},o=function(t){return l(t,y)}}t.exports={set:r,get:i,has:o,enforce:function(t){return o(t)?i(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=i(e)).type!==t)throw new g("Incompatible receiver, "+t+" required");return n}}}},3292:function(t,e,n){"use strict";var r=n(4201),i=n(9478),o=r("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||a[o]===t)}},9985:function(t,e,n){"use strict";var r=n(2659),i=r.all;t.exports=r.IS_HTMLDDA?function(t){return"function"==typeof t||t===i}:function(t){return"function"==typeof t}},9429:function(t,e,n){"use strict";var r=n(8844),i=n(3689),o=n(9985),a=n(926),s=n(6058),c=n(6738),u=function(){},l=[],h=s("Reflect","construct"),d=/^\s*(?:class|function)\b/,f=r(d.exec),p=!d.test(u),g=function(t){if(!o(t))return!1;try{return h(u,l,t),!0}catch(t){return!1}},m=function(t){if(!o(t))return!1;switch(a(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return p||!!f(d,c(t))}catch(t){return!0}};m.sham=!0,t.exports=!h||i((function(){var t;return g(g.call)||!g(Object)||!g((function(){t=!0}))||t}))?m:g},5266:function(t,e,n){"use strict";var r=n(3689),i=n(9985),o=/#|\.prototype\./,a=function(t,e){var n=c[s(t)];return n===l||n!==u&&(i(e)?r(e):!!e)},s=a.normalize=function(t){return String(t).replace(o,".").toLowerCase()},c=a.data={},u=a.NATIVE="N",l=a.POLYFILL="P";t.exports=a},981:function(t){"use strict";t.exports=function(t){return null==t}},8999:function(t,e,n){"use strict";var r=n(9985),i=n(2659),o=i.all;t.exports=i.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:r(t)||t===o}:function(t){return"object"==typeof t?null!==t:r(t)}},3931:function(t){"use strict";t.exports=!1},1245:function(t,e,n){"use strict";var r=n(8999),i=n(6648),o=n(4201)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"===i(t))}},734:function(t,e,n){"use strict";var r=n(6058),i=n(9985),o=n(3622),a=n(9525),s=Object;t.exports=a?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return i(e)&&o(e.prototype,s(t))}},8734:function(t,e,n){"use strict";var r=n(4071),i=n(2615),o=n(5027),a=n(3691),s=n(3292),c=n(6310),u=n(3622),l=n(5185),h=n(1664),d=n(2125),f=TypeError,p=function(t,e){this.stopped=t,this.result=e},g=p.prototype;t.exports=function(t,e,n){var m,v,y,w,S,A,x,b=n&&n.that,R=!(!n||!n.AS_ENTRIES),E=!(!n||!n.IS_RECORD),T=!(!n||!n.IS_ITERATOR),P=!(!n||!n.INTERRUPTED),C=r(e,b),_=function(t){return m&&d(m,"normal",t),new p(!0,t)},I=function(t){return R?(o(t),P?C(t[0],t[1],_):C(t[0],t[1])):P?C(t,_):C(t)};if(E)m=t.iterator;else if(T)m=t;else{if(!(v=h(t)))throw new f(a(t)+" is not iterable");if(s(v)){for(y=0,w=c(t);w>y;y++)if((S=I(t[y]))&&u(g,S))return S;return new p(!1)}m=l(t,v)}for(A=E?t.next:m.next;!(x=i(A,m)).done;){try{S=I(x.value)}catch(t){d(m,"throw",t)}if("object"==typeof S&&S&&u(g,S))return S}return new p(!1)}},2125:function(t,e,n){"use strict";var r=n(2615),i=n(5027),o=n(4849);t.exports=function(t,e,n){var a,s;i(t);try{if(!(a=o(t,"return"))){if("throw"===e)throw n;return n}a=r(a,t)}catch(t){s=!0,a=t}if("throw"===e)throw n;if(s)throw a;return i(a),n}},974:function(t,e,n){"use strict";var r=n(2013).IteratorPrototype,i=n(5391),o=n(5684),a=n(5997),s=n(9478),c=function(){return this};t.exports=function(t,e,n,u){var l=e+" Iterator";return t.prototype=i(r,{next:o(+!u,n)}),a(t,l,!1,!0),s[l]=c,t}},1934:function(t,e,n){"use strict";var r=n(9989),i=n(2615),o=n(3931),a=n(1236),s=n(9985),c=n(974),u=n(1868),l=n(9385),h=n(5997),d=n(5773),f=n(1880),p=n(4201),g=n(9478),m=n(2013),v=a.PROPER,y=a.CONFIGURABLE,w=m.IteratorPrototype,S=m.BUGGY_SAFARI_ITERATORS,A=p("iterator"),x="keys",b="values",R="entries",E=function(){return this};t.exports=function(t,e,n,a,p,m,T){c(n,e,a);var P,C,_,I=function(t){if(t===p&&V)return V;if(!S&&t&&t in L)return L[t];switch(t){case x:case b:case R:return function(){return new n(this,t)}}return function(){return new n(this)}},D=e+" Iterator",M=!1,L=t.prototype,k=L[A]||L["@@iterator"]||p&&L[p],V=!S&&k||I(p),H="Array"===e&&L.entries||k;if(H&&(P=u(H.call(new t)))!==Object.prototype&&P.next&&(o||u(P)===w||(l?l(P,w):s(P[A])||f(P,A,E)),h(P,D,!0,!0),o&&(g[D]=E)),v&&p===b&&k&&k.name!==b&&(!o&&y?d(L,"name",b):(M=!0,V=function(){return i(k,this)})),p)if(C={values:I(b),keys:m?V:I(x),entries:I(R)},T)for(_ in C)(S||M||!(_ in L))&&f(L,_,C[_]);else r({target:e,proto:!0,forced:S||M},C);return o&&!T||L[A]===V||f(L,A,V,{name:p}),g[e]=V,C}},2013:function(t,e,n){"use strict";var r,i,o,a=n(3689),s=n(9985),c=n(8999),u=n(5391),l=n(1868),h=n(1880),d=n(4201),f=n(3931),p=d("iterator"),g=!1;[].keys&&("next"in(o=[].keys())?(i=l(l(o)))!==Object.prototype&&(r=i):g=!0),!c(r)||a((function(){var t={};return r[p].call(t)!==t}))?r={}:f&&(r=u(r)),s(r[p])||h(r,p,(function(){return this})),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:g}},9478:function(t){"use strict";t.exports={}},6310:function(t,e,n){"use strict";var r=n(3126);t.exports=function(t){return r(t.length)}},8702:function(t,e,n){"use strict";var r=n(8844),i=n(3689),o=n(9985),a=n(6812),s=n(7697),c=n(1236).CONFIGURABLE,u=n(6738),l=n(618),h=l.enforce,d=l.get,f=String,p=Object.defineProperty,g=r("".slice),m=r("".replace),v=r([].join),y=s&&!i((function(){return 8!==p((function(){}),"length",{value:8}).length})),w=String(String).split("String"),S=t.exports=function(t,e,n){"Symbol("===g(f(e),0,7)&&(e="["+m(f(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!a(t,"name")||c&&t.name!==e)&&(s?p(t,"name",{value:e,configurable:!0}):t.name=e),y&&n&&a(n,"arity")&&t.length!==n.arity&&p(t,"length",{value:n.arity});try{n&&a(n,"constructor")&&n.constructor?s&&p(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=h(t);return a(r,"source")||(r.source=v(w,"string"==typeof e?e:"")),t};Function.prototype.toString=S((function(){return o(this)&&d(this).source||u(this)}),"toString")},8828:function(t){"use strict";var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var r=+t;return(r>0?n:e)(r)}},231:function(t,e,n){"use strict";var r,i,o,a,s,c=n(9037),u=n(4071),l=n(2474).f,h=n(9886).set,d=n(4410),f=n(4764),p=n(3221),g=n(7486),m=n(806),v=c.MutationObserver||c.WebKitMutationObserver,y=c.document,w=c.process,S=c.Promise,A=l(c,"queueMicrotask"),x=A&&A.value;if(!x){var b=new d,R=function(){var t,e;for(m&&(t=w.domain)&&t.exit();e=b.get();)try{e()}catch(t){throw b.head&&r(),t}t&&t.enter()};f||m||g||!v||!y?!p&&S&&S.resolve?((a=S.resolve(void 0)).constructor=S,s=u(a.then,a),r=function(){s(R)}):m?r=function(){w.nextTick(R)}:(h=u(h,c),r=function(){h(R)}):(i=!0,o=y.createTextNode(""),new v(R).observe(o,{characterData:!0}),r=function(){o.data=i=!i}),x=function(t){b.head||r(),b.add(t)}}t.exports=x},8742:function(t,e,n){"use strict";var r=n(509),i=TypeError,o=function(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw new i("Bad Promise constructor");e=t,n=r})),this.resolve=r(e),this.reject=r(n)};t.exports.f=function(t){return new o(t)}},5394:function(t,e,n){"use strict";var r=n(7697),i=n(8844),o=n(2615),a=n(3689),s=n(300),c=n(7518),u=n(9556),l=n(690),h=n(4413),d=Object.assign,f=Object.defineProperty,p=i([].concat);t.exports=!d||a((function(){if(r&&1!==d({b:1},d(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol("assign detection"),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach((function(t){e[t]=t})),7!==d({},t)[n]||s(d({},e)).join("")!==i}))?function(t,e){for(var n=l(t),i=arguments.length,a=1,d=c.f,f=u.f;i>a;)for(var g,m=h(arguments[a++]),v=d?p(s(m),d(m)):s(m),y=v.length,w=0;y>w;)g=v[w++],r&&!o(f,m,g)||(n[g]=m[g]);return n}:d},5391:function(t,e,n){"use strict";var r,i=n(5027),o=n(8920),a=n(2739),s=n(7248),c=n(2688),u=n(6420),l=n(2713),h="prototype",d="script",f=l("IE_PROTO"),p=function(){},g=function(t){return"<"+d+">"+t+"</"+d+">"},m=function(t){t.write(g("")),t.close();var e=t.parentWindow.Object;return t=null,e},v=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}var t,e,n;v="undefined"!=typeof document?document.domain&&r?m(r):(e=u("iframe"),n="java"+d+":",e.style.display="none",c.appendChild(e),e.src=String(n),(t=e.contentWindow.document).open(),t.write(g("document.F=Object")),t.close(),t.F):m(r);for(var i=a.length;i--;)delete v[h][a[i]];return v()};s[f]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(p[h]=i(t),n=new p,p[h]=null,n[f]=t):n=v(),void 0===e?n:o.f(n,e)}},8920:function(t,e,n){"use strict";var r=n(7697),i=n(5648),o=n(2560),a=n(5027),s=n(5290),c=n(300);e.f=r&&!i?Object.defineProperties:function(t,e){a(t);for(var n,r=s(e),i=c(e),u=i.length,l=0;u>l;)o.f(t,n=i[l++],r[n]);return t}},2560:function(t,e,n){"use strict";var r=n(7697),i=n(8506),o=n(5648),a=n(5027),s=n(8360),c=TypeError,u=Object.defineProperty,l=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",f="writable";e.f=r?o?function(t,e,n){if(a(t),e=s(e),a(n),"function"==typeof t&&"prototype"===e&&"value"in n&&f in n&&!n[f]){var r=l(t,e);r&&r[f]&&(t[e]=n.value,n={configurable:d in n?n[d]:r[d],enumerable:h in n?n[h]:r[h],writable:!1})}return u(t,e,n)}:u:function(t,e,n){if(a(t),e=s(e),a(n),i)try{return u(t,e,n)}catch(t){}if("get"in n||"set"in n)throw new c("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},2474:function(t,e,n){"use strict";var r=n(7697),i=n(2615),o=n(9556),a=n(5684),s=n(5290),c=n(8360),u=n(6812),l=n(8506),h=Object.getOwnPropertyDescriptor;e.f=r?h:function(t,e){if(t=s(t),e=c(e),l)try{return h(t,e)}catch(t){}if(u(t,e))return a(!i(o.f,t,e),t[e])}},2741:function(t,e,n){"use strict";var r=n(4948),i=n(2739).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},7518:function(t,e){"use strict";e.f=Object.getOwnPropertySymbols},1868:function(t,e,n){"use strict";var r=n(6812),i=n(9985),o=n(690),a=n(2713),s=n(1748),c=a("IE_PROTO"),u=Object,l=u.prototype;t.exports=s?u.getPrototypeOf:function(t){var e=o(t);if(r(e,c))return e[c];var n=e.constructor;return i(n)&&e instanceof n?n.prototype:e instanceof u?l:null}},3622:function(t,e,n){"use strict";var r=n(8844);t.exports=r({}.isPrototypeOf)},4948:function(t,e,n){"use strict";var r=n(8844),i=n(6812),o=n(5290),a=n(4328).indexOf,s=n(7248),c=r([].push);t.exports=function(t,e){var n,r=o(t),u=0,l=[];for(n in r)!i(s,n)&&i(r,n)&&c(l,n);for(;e.length>u;)i(r,n=e[u++])&&(~a(l,n)||c(l,n));return l}},300:function(t,e,n){"use strict";var r=n(4948),i=n(2739);t.exports=Object.keys||function(t){return r(t,i)}},9556:function(t,e){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);e.f=i?function(t){var e=r(this,t);return!!e&&e.enumerable}:n},9385:function(t,e,n){"use strict";var r=n(2743),i=n(5027),o=n(3550);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=r(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return i(n),o(r),e?t(n,r):n.__proto__=r,n}}():void 0)},5899:function(t,e,n){"use strict";var r=n(2615),i=n(9985),o=n(8999),a=TypeError;t.exports=function(t,e){var n,s;if("string"===e&&i(n=t.toString)&&!o(s=r(n,t)))return s;if(i(n=t.valueOf)&&!o(s=r(n,t)))return s;if("string"!==e&&i(n=t.toString)&&!o(s=r(n,t)))return s;throw new a("Can't convert object to primitive value")}},9152:function(t,e,n){"use strict";var r=n(6058),i=n(8844),o=n(2741),a=n(7518),s=n(5027),c=i([].concat);t.exports=r("Reflect","ownKeys")||function(t){var e=o.f(s(t)),n=a.f;return n?c(e,n(t)):e}},9302:function(t){"use strict";t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},7073:function(t,e,n){"use strict";var r=n(9037),i=n(7919),o=n(9985),a=n(5266),s=n(6738),c=n(4201),u=n(2532),l=n(8563),h=n(3931),d=n(3615),f=i&&i.prototype,p=c("species"),g=!1,m=o(r.PromiseRejectionEvent),v=a("Promise",(function(){var t=s(i),e=t!==String(i);if(!e&&66===d)return!0;if(h&&(!f.catch||!f.finally))return!0;if(!d||d<51||!/native code/.test(t)){var n=new i((function(t){t(1)})),r=function(t){t((function(){}),(function(){}))};if((n.constructor={})[p]=r,!(g=n.then((function(){}))instanceof r))return!0}return!e&&(u||l)&&!m}));t.exports={CONSTRUCTOR:v,REJECTION_EVENT:m,SUBCLASSING:g}},7919:function(t,e,n){"use strict";var r=n(9037);t.exports=r.Promise},2945:function(t,e,n){"use strict";var r=n(5027),i=n(8999),o=n(8742);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},562:function(t,e,n){"use strict";var r=n(7919),i=n(6431),o=n(7073).CONSTRUCTOR;t.exports=o||!i((function(t){r.all(t).then(void 0,(function(){}))}))},8055:function(t,e,n){"use strict";var r=n(2560).f;t.exports=function(t,e,n){n in t||r(t,n,{configurable:!0,get:function(){return e[n]},set:function(t){e[n]=t}})}},4410:function(t){"use strict";var e=function(){this.head=null,this.tail=null};e.prototype={add:function(t){var e={item:t,next:null},n=this.tail;n?n.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}},t.exports=e},6100:function(t,e,n){"use strict";var r=n(2615),i=n(5027),o=n(9985),a=n(6648),s=n(6308),c=TypeError;t.exports=function(t,e){var n=t.exec;if(o(n)){var u=r(n,t,e);return null!==u&&i(u),u}if("RegExp"===a(t))return r(s,t,e);throw new c("RegExp#exec called on incompatible receiver")}},6308:function(t,e,n){"use strict";var r,i,o=n(2615),a=n(8844),s=n(4327),c=n(9633),u=n(7901),l=n(3430),h=n(5391),d=n(618).get,f=n(2100),p=n(6422),g=l("native-string-replace",String.prototype.replace),m=RegExp.prototype.exec,v=m,y=a("".charAt),w=a("".indexOf),S=a("".replace),A=a("".slice),x=(i=/b*/g,o(m,r=/a/,"a"),o(m,i,"a"),0!==r.lastIndex||0!==i.lastIndex),b=u.BROKEN_CARET,R=void 0!==/()??/.exec("")[1];(x||R||b||f||p)&&(v=function(t){var e,n,r,i,a,u,l,f=this,p=d(f),E=s(t),T=p.raw;if(T)return T.lastIndex=f.lastIndex,e=o(v,T,E),f.lastIndex=T.lastIndex,e;var P=p.groups,C=b&&f.sticky,_=o(c,f),I=f.source,D=0,M=E;if(C&&(_=S(_,"y",""),-1===w(_,"g")&&(_+="g"),M=A(E,f.lastIndex),f.lastIndex>0&&(!f.multiline||f.multiline&&"\n"!==y(E,f.lastIndex-1))&&(I="(?: "+I+")",M=" "+M,D++),n=new RegExp("^(?:"+I+")",_)),R&&(n=new RegExp("^"+I+"$(?!\\s)",_)),x&&(r=f.lastIndex),i=o(m,C?n:f,M),C?i?(i.input=A(i.input,D),i[0]=A(i[0],D),i.index=f.lastIndex,f.lastIndex+=i[0].length):f.lastIndex=0:x&&i&&(f.lastIndex=f.global?i.index+i[0].length:r),R&&i&&i.length>1&&o(g,i[0],n,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(i[a]=void 0)})),i&&P)for(i.groups=u=h(null),a=0;a<P.length;a++)u[(l=P[a])[0]]=i[l[1]];return i}),t.exports=v},9633:function(t,e,n){"use strict";var r=n(5027);t.exports=function(){var t=r(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},3477:function(t,e,n){"use strict";var r=n(2615),i=n(6812),o=n(3622),a=n(9633),s=RegExp.prototype;t.exports=function(t){var e=t.flags;return void 0!==e||"flags"in s||i(t,"flags")||!o(s,t)?e:r(a,t)}},7901:function(t,e,n){"use strict";var r=n(3689),i=n(9037).RegExp,o=r((function(){var t=i("a","y");return t.lastIndex=2,null!==t.exec("abcd")})),a=o||r((function(){return!i("a","y").sticky})),s=o||r((function(){var t=i("^r","gy");return t.lastIndex=2,null!==t.exec("str")}));t.exports={BROKEN_CARET:s,MISSED_STICKY:a,UNSUPPORTED_Y:o}},2100:function(t,e,n){"use strict";var r=n(3689),i=n(9037).RegExp;t.exports=r((function(){var t=i(".","s");return!(t.dotAll&&t.test("\n")&&"s"===t.flags)}))},6422:function(t,e,n){"use strict";var r=n(3689),i=n(9037).RegExp;t.exports=r((function(){var t=i("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}))},4684:function(t,e,n){"use strict";var r=n(981),i=TypeError;t.exports=function(t){if(r(t))throw new i("Can't call method on "+t);return t}},4241:function(t,e,n){"use strict";var r=n(6058),i=n(2148),o=n(4201),a=n(7697),s=o("species");t.exports=function(t){var e=r(t);a&&e&&!e[s]&&i(e,s,{configurable:!0,get:function(){return this}})}},5997:function(t,e,n){"use strict";var r=n(2560).f,i=n(6812),o=n(4201)("toStringTag");t.exports=function(t,e,n){t&&!n&&(t=t.prototype),t&&!i(t,o)&&r(t,o,{configurable:!0,value:e})}},2713:function(t,e,n){"use strict";var r=n(3430),i=n(4630),o=r("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},4091:function(t,e,n){"use strict";var r=n(9037),i=n(5014),o="__core-js_shared__",a=r[o]||i(o,{});t.exports=a},3430:function(t,e,n){"use strict";var r=n(3931),i=n(4091);(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.33.3",mode:r?"pure":"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.3/LICENSE",source:"https://github.com/zloirock/core-js"})},6373:function(t,e,n){"use strict";var r=n(5027),i=n(2655),o=n(981),a=n(4201)("species");t.exports=function(t,e){var n,s=r(t).constructor;return void 0===s||o(n=r(s)[a])?e:i(n)}},730:function(t,e,n){"use strict";var r=n(8844),i=n(8700),o=n(4327),a=n(4684),s=r("".charAt),c=r("".charCodeAt),u=r("".slice),l=function(t){return function(e,n){var r,l,h=o(a(e)),d=i(n),f=h.length;return d<0||d>=f?t?"":void 0:(r=c(h,d))<55296||r>56319||d+1===f||(l=c(h,d+1))<56320||l>57343?t?s(h,d):r:t?u(h,d,d+2):l-56320+(r-55296<<10)+65536}};t.exports={codeAt:l(!1),charAt:l(!0)}},6430:function(t,e,n){"use strict";var r=n(8844),i=2147483647,o=/[^\0-\u007E]/,a=/[.\u3002\uFF0E\uFF61]/g,s="Overflow: input needs wider integers to process",c=RangeError,u=r(a.exec),l=Math.floor,h=String.fromCharCode,d=r("".charCodeAt),f=r([].join),p=r([].push),g=r("".replace),m=r("".split),v=r("".toLowerCase),y=function(t){return t+22+75*(t<26)},w=function(t,e,n){var r=0;for(t=n?l(t/700):t>>1,t+=l(t/e);t>455;)t=l(t/35),r+=36;return l(r+36*t/(t+38))},S=function(t){var e=[];t=function(t){for(var e=[],n=0,r=t.length;n<r;){var i=d(t,n++);if(i>=55296&&i<=56319&&n<r){var o=d(t,n++);56320==(64512&o)?p(e,((1023&i)<<10)+(1023&o)+65536):(p(e,i),n--)}else p(e,i)}return e}(t);var n,r,o=t.length,a=128,u=0,g=72;for(n=0;n<t.length;n++)(r=t[n])<128&&p(e,h(r));var m=e.length,v=m;for(m&&p(e,"-");v<o;){var S=i;for(n=0;n<t.length;n++)(r=t[n])>=a&&r<S&&(S=r);var A=v+1;if(S-a>l((i-u)/A))throw new c(s);for(u+=(S-a)*A,a=S,n=0;n<t.length;n++){if((r=t[n])<a&&++u>i)throw new c(s);if(r===a){for(var x=u,b=36;;){var R=b<=g?1:b>=g+26?26:b-g;if(x<R)break;var E=x-R,T=36-R;p(e,h(y(R+E%T))),x=l(E/T),b+=36}p(e,h(y(x))),g=w(u,A,v===m),u=0,v++}}u++,a++}return f(e,"")};t.exports=function(t){var e,n,r=[],i=m(g(v(t),a,"."),".");for(e=0;e<i.length;e++)n=i[e],p(r,u(o,n)?"xn--"+S(n):n);return f(r,".")}},146:function(t,e,n){"use strict";var r=n(3615),i=n(3689),o=n(9037).String;t.exports=!!Object.getOwnPropertySymbols&&!i((function(){var t=Symbol("symbol detection");return!o(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},9886:function(t,e,n){"use strict";var r,i,o,a,s=n(9037),c=n(1735),u=n(4071),l=n(9985),h=n(6812),d=n(3689),f=n(2688),p=n(6004),g=n(6420),m=n(1500),v=n(4764),y=n(806),w=s.setImmediate,S=s.clearImmediate,A=s.process,x=s.Dispatch,b=s.Function,R=s.MessageChannel,E=s.String,T=0,P={},C="onreadystatechange";d((function(){r=s.location}));var _=function(t){if(h(P,t)){var e=P[t];delete P[t],e()}},I=function(t){return function(){_(t)}},D=function(t){_(t.data)},M=function(t){s.postMessage(E(t),r.protocol+"//"+r.host)};w&&S||(w=function(t){m(arguments.length,1);var e=l(t)?t:b(t),n=p(arguments,1);return P[++T]=function(){c(e,void 0,n)},i(T),T},S=function(t){delete P[t]},y?i=function(t){A.nextTick(I(t))}:x&&x.now?i=function(t){x.now(I(t))}:R&&!v?(a=(o=new R).port2,o.port1.onmessage=D,i=u(a.postMessage,a)):s.addEventListener&&l(s.postMessage)&&!s.importScripts&&r&&"file:"!==r.protocol&&!d(M)?(i=M,s.addEventListener("message",D,!1)):i=C in g("script")?function(t){f.appendChild(g("script"))[C]=function(){f.removeChild(this),_(t)}}:function(t){setTimeout(I(t),0)}),t.exports={set:w,clear:S}},7578:function(t,e,n){"use strict";var r=n(8700),i=Math.max,o=Math.min;t.exports=function(t,e){var n=r(t);return n<0?i(n+e,0):o(n,e)}},5290:function(t,e,n){"use strict";var r=n(4413),i=n(4684);t.exports=function(t){return r(i(t))}},8700:function(t,e,n){"use strict";var r=n(8828);t.exports=function(t){var e=+t;return e!=e||0===e?0:r(e)}},3126:function(t,e,n){"use strict";var r=n(8700),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},690:function(t,e,n){"use strict";var r=n(4684),i=Object;t.exports=function(t){return i(r(t))}},3250:function(t,e,n){"use strict";var r=n(5904),i=RangeError;t.exports=function(t,e){var n=r(t);if(n%e)throw new i("Wrong offset");return n}},5904:function(t,e,n){"use strict";var r=n(8700),i=RangeError;t.exports=function(t){var e=r(t);if(e<0)throw new i("The argument can't be less than 0");return e}},8732:function(t,e,n){"use strict";var r=n(2615),i=n(8999),o=n(734),a=n(4849),s=n(5899),c=n(4201),u=TypeError,l=c("toPrimitive");t.exports=function(t,e){if(!i(t)||o(t))return t;var n,c=a(t,l);if(c){if(void 0===e&&(e="default"),n=r(c,t,e),!i(n)||o(n))return n;throw new u("Can't convert object to primitive value")}return void 0===e&&(e="number"),s(t,e)}},8360:function(t,e,n){"use strict";var r=n(8732),i=n(734);t.exports=function(t){var e=r(t,"string");return i(e)?e:e+""}},3043:function(t,e,n){"use strict";var r={};r[n(4201)("toStringTag")]="z",t.exports="[object z]"===String(r)},4327:function(t,e,n){"use strict";var r=n(926),i=String;t.exports=function(t){if("Symbol"===r(t))throw new TypeError("Cannot convert a Symbol value to a string");return i(t)}},3691:function(t){"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},4630:function(t,e,n){"use strict";var r=n(8844),i=0,o=Math.random(),a=r(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+a(++i+o,36)}},6837:function(t,e,n){"use strict";var r=n(3689),i=n(4201),o=n(7697),a=n(3931),s=i("iterator");t.exports=!r((function(){var t=new URL("b?a=1&b=2&c=3","http://a"),e=t.searchParams,n=new URLSearchParams("a=1&a=2&b=3"),r="";return t.pathname="c%20d",e.forEach((function(t,n){e.delete("b"),r+=n+t})),n.delete("a",2),n.delete("b",void 0),a&&(!t.toJSON||!n.has("a",1)||n.has("a",2)||!n.has("a",void 0)||n.has("b"))||!e.size&&(a||!o)||!e.sort||"http://a/c%20d?a=1&c=3"!==t.href||"3"!==e.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!e[s]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host}))},9525:function(t,e,n){"use strict";var r=n(146);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},5648:function(t,e,n){"use strict";var r=n(7697),i=n(3689);t.exports=r&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},1500:function(t){"use strict";var e=TypeError;t.exports=function(t,n){if(t<n)throw new e("Not enough arguments");return t}},9834:function(t,e,n){"use strict";var r=n(9037),i=n(9985),o=r.WeakMap;t.exports=i(o)&&/native code/.test(String(o))},4201:function(t,e,n){"use strict";var r=n(9037),i=n(3430),o=n(6812),a=n(4630),s=n(146),c=n(9525),u=r.Symbol,l=i("wks"),h=c?u.for||u:u&&u.withoutSetter||a;t.exports=function(t){return o(l,t)||(l[t]=s&&o(u,t)?u[t]:h("Symbol."+t)),l[t]}},752:function(t,e,n){"use strict";var r=n(5290),i=n(7370),o=n(9478),a=n(618),s=n(2560).f,c=n(1934),u=n(7807),l=n(3931),h=n(7697),d="Array Iterator",f=a.set,p=a.getterFor(d);t.exports=c(Array,"Array",(function(t,e){f(this,{type:d,target:r(t),index:0,kind:e})}),(function(){var t=p(this),e=t.target,n=t.index++;if(!e||n>=e.length)return t.target=void 0,u(void 0,!0);switch(t.kind){case"keys":return u(n,!1);case"values":return u(e[n],!1)}return u([n,e[n]],!1)}),"values");var g=o.Arguments=o.Array;if(i("keys"),i("values"),i("entries"),!l&&h&&"values"!==g.name)try{s(g,"name",{value:"values"})}catch(t){}},1386:function(t,e,n){"use strict";var r=n(9989),i=n(8820).right,o=n(6834),a=n(3615);r({target:"Array",proto:!0,forced:!n(806)&&a>79&&a<83||!o("reduceRight")},{reduceRight:function(t){return i(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},278:function(t,e,n){"use strict";var r=n(9989),i=n(8820).left,o=n(6834),a=n(3615);r({target:"Array",proto:!0,forced:!n(806)&&a>79&&a<83||!o("reduce")},{reduce:function(t){var e=arguments.length;return i(this,t,e,e>1?arguments[1]:void 0)}})},1692:function(t,e,n){"use strict";var r=n(9989),i=n(2615),o=n(509),a=n(8742),s=n(9302),c=n(8734);r({target:"Promise",stat:!0,forced:n(562)},{all:function(t){var e=this,n=a.f(e),r=n.resolve,u=n.reject,l=s((function(){var n=o(e.resolve),a=[],s=0,l=1;c(t,(function(t){var o=s++,c=!1;l++,i(n,e,t).then((function(t){c||(c=!0,a[o]=t,--l||r(a))}),u)})),--l||r(a)}));return l.error&&u(l.value),n.promise}})},5089:function(t,e,n){"use strict";var r=n(9989),i=n(3931),o=n(7073).CONSTRUCTOR,a=n(7919),s=n(6058),c=n(9985),u=n(1880),l=a&&a.prototype;if(r({target:"Promise",proto:!0,forced:o,real:!0},{catch:function(t){return this.then(void 0,t)}}),!i&&c(a)){var h=s("Promise").prototype.catch;l.catch!==h&&u(l,"catch",h,{unsafe:!0})}},6697:function(t,e,n){"use strict";var r,i,o,a=n(9989),s=n(3931),c=n(806),u=n(9037),l=n(2615),h=n(1880),d=n(9385),f=n(5997),p=n(4241),g=n(509),m=n(9985),v=n(8999),y=n(767),w=n(6373),S=n(9886).set,A=n(231),x=n(920),b=n(9302),R=n(4410),E=n(618),T=n(7919),P=n(7073),C=n(8742),_="Promise",I=P.CONSTRUCTOR,D=P.REJECTION_EVENT,M=P.SUBCLASSING,L=E.getterFor(_),k=E.set,V=T&&T.prototype,H=T,O=V,N=u.TypeError,U=u.document,j=u.process,F=C.f,B=F,$=!!(U&&U.createEvent&&u.dispatchEvent),Y="unhandledrejection",X=function(t){var e;return!(!v(t)||!m(e=t.then))&&e},z=function(t,e){var n,r,i,o=e.value,a=1===e.state,s=a?t.ok:t.fail,c=t.resolve,u=t.reject,h=t.domain;try{s?(a||(2===e.rejection&&J(e),e.rejection=1),!0===s?n=o:(h&&h.enter(),n=s(o),h&&(h.exit(),i=!0)),n===t.promise?u(new N("Promise-chain cycle")):(r=X(n))?l(r,n,c,u):c(n)):u(o)}catch(t){h&&!i&&h.exit(),u(t)}},G=function(t,e){t.notified||(t.notified=!0,A((function(){for(var n,r=t.reactions;n=r.get();)z(n,t);t.notified=!1,e&&!t.rejection&&W(t)})))},q=function(t,e,n){var r,i;$?((r=U.createEvent("Event")).promise=e,r.reason=n,r.initEvent(t,!1,!0),u.dispatchEvent(r)):r={promise:e,reason:n},!D&&(i=u["on"+t])?i(r):t===Y&&x("Unhandled promise rejection",n)},W=function(t){l(S,u,(function(){var e,n=t.facade,r=t.value;if(K(t)&&(e=b((function(){c?j.emit("unhandledRejection",r,n):q(Y,n,r)})),t.rejection=c||K(t)?2:1,e.error))throw e.value}))},K=function(t){return 1!==t.rejection&&!t.parent},J=function(t){l(S,u,(function(){var e=t.facade;c?j.emit("rejectionHandled",e):q("rejectionhandled",e,t.value)}))},Z=function(t,e,n){return function(r){t(e,r,n)}},Q=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=2,G(t,!0))},tt=function(t,e,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===e)throw new N("Promise can't be resolved itself");var r=X(e);r?A((function(){var n={done:!1};try{l(r,e,Z(tt,n,t),Z(Q,n,t))}catch(e){Q(n,e,t)}})):(t.value=e,t.state=1,G(t,!1))}catch(e){Q({done:!1},e,t)}}};if(I&&(O=(H=function(t){y(this,O),g(t),l(r,this);var e=L(this);try{t(Z(tt,e),Z(Q,e))}catch(t){Q(e,t)}}).prototype,(r=function(t){k(this,{type:_,done:!1,notified:!1,parent:!1,reactions:new R,rejection:!1,state:0,value:void 0})}).prototype=h(O,"then",(function(t,e){var n=L(this),r=F(w(this,H));return n.parent=!0,r.ok=!m(t)||t,r.fail=m(e)&&e,r.domain=c?j.domain:void 0,0===n.state?n.reactions.add(r):A((function(){z(r,n)})),r.promise})),i=function(){var t=new r,e=L(t);this.promise=t,this.resolve=Z(tt,e),this.reject=Z(Q,e)},C.f=F=function(t){return t===H||undefined===t?new i(t):B(t)},!s&&m(T)&&V!==Object.prototype)){o=V.then,M||h(V,"then",(function(t,e){var n=this;return new H((function(t,e){l(o,n,t,e)})).then(t,e)}),{unsafe:!0});try{delete V.constructor}catch(t){}d&&d(V,O)}a({global:!0,constructor:!0,wrap:!0,forced:I},{Promise:H}),f(H,_,!1,!0),p(_)},6409:function(t,e,n){"use strict";var r=n(9989),i=n(3931),o=n(7919),a=n(3689),s=n(6058),c=n(9985),u=n(6373),l=n(2945),h=n(1880),d=o&&o.prototype;if(r({target:"Promise",proto:!0,real:!0,forced:!!o&&a((function(){d.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var e=u(this,s("Promise")),n=c(t);return this.then(n?function(n){return l(e,t()).then((function(){return n}))}:t,n?function(n){return l(e,t()).then((function(){throw n}))}:t)}}),!i&&c(o)){var f=s("Promise").prototype.finally;d.finally!==f&&h(d,"finally",f,{unsafe:!0})}},3964:function(t,e,n){"use strict";n(6697),n(1692),n(5089),n(8829),n(2092),n(7905)},8829:function(t,e,n){"use strict";var r=n(9989),i=n(2615),o=n(509),a=n(8742),s=n(9302),c=n(8734);r({target:"Promise",stat:!0,forced:n(562)},{race:function(t){var e=this,n=a.f(e),r=n.reject,u=s((function(){var a=o(e.resolve);c(t,(function(t){i(a,e,t).then(n.resolve,r)}))}));return u.error&&r(u.value),n.promise}})},2092:function(t,e,n){"use strict";var r=n(9989),i=n(2615),o=n(8742);r({target:"Promise",stat:!0,forced:n(7073).CONSTRUCTOR},{reject:function(t){var e=o.f(this);return i(e.reject,void 0,t),e.promise}})},7905:function(t,e,n){"use strict";var r=n(9989),i=n(6058),o=n(3931),a=n(7919),s=n(7073).CONSTRUCTOR,c=n(2945),u=i("Promise"),l=o&&!s;r({target:"Promise",stat:!0,forced:o||s},{resolve:function(t){return c(l&&this===u?a:this,t)}})},2003:function(t,e,n){"use strict";var r=n(7697),i=n(9037),o=n(8844),a=n(5266),s=n(3457),c=n(5773),u=n(2741).f,l=n(3622),h=n(1245),d=n(4327),f=n(3477),p=n(7901),g=n(8055),m=n(1880),v=n(3689),y=n(6812),w=n(618).enforce,S=n(4241),A=n(4201),x=n(2100),b=n(6422),R=A("match"),E=i.RegExp,T=E.prototype,P=i.SyntaxError,C=o(T.exec),_=o("".charAt),I=o("".replace),D=o("".indexOf),M=o("".slice),L=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,k=/a/g,V=/a/g,H=new E(k)!==k,O=p.MISSED_STICKY,N=p.UNSUPPORTED_Y,U=r&&(!H||O||x||b||v((function(){return V[R]=!1,E(k)!==k||E(V)===V||"/a/i"!==String(E(k,"i"))})));if(a("RegExp",U)){for(var j=function(t,e){var n,r,i,o,a,u,p=l(T,this),g=h(t),m=void 0===e,v=[],S=t;if(!p&&g&&m&&t.constructor===j)return t;if((g||l(T,t))&&(t=t.source,m&&(e=f(S))),t=void 0===t?"":d(t),e=void 0===e?"":d(e),S=t,x&&"dotAll"in k&&(r=!!e&&D(e,"s")>-1)&&(e=I(e,/s/g,"")),n=e,O&&"sticky"in k&&(i=!!e&&D(e,"y")>-1)&&N&&(e=I(e,/y/g,"")),b&&(o=function(t){for(var e,n=t.length,r=0,i="",o=[],a={},s=!1,c=!1,u=0,l="";r<=n;r++){if("\\"===(e=_(t,r)))e+=_(t,++r);else if("]"===e)s=!1;else if(!s)switch(!0){case"["===e:s=!0;break;case"("===e:C(L,M(t,r+1))&&(r+=2,c=!0),i+=e,u++;continue;case">"===e&&c:if(""===l||y(a,l))throw new P("Invalid capture group name");a[l]=!0,o[o.length]=[l,u],c=!1,l="";continue}c?l+=e:i+=e}return[i,o]}(t),t=o[0],v=o[1]),a=s(E(t,e),p?this:T,j),(r||i||v.length)&&(u=w(a),r&&(u.dotAll=!0,u.raw=j(function(t){for(var e,n=t.length,r=0,i="",o=!1;r<=n;r++)"\\"!==(e=_(t,r))?o||"."!==e?("["===e?o=!0:"]"===e&&(o=!1),i+=e):i+="[\\s\\S]":i+=e+_(t,++r);return i}(t),n)),i&&(u.sticky=!0),v.length&&(u.groups=v)),t!==S)try{c(a,"source",""===S?"(?:)":S)}catch(t){}return a},F=u(E),B=0;F.length>B;)g(j,E,F[B++]);T.constructor=j,j.prototype=T,m(i,"RegExp",j,{constructor:!0})}S("RegExp")},4043:function(t,e,n){"use strict";var r=n(9989),i=n(6308);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},5847:function(t,e,n){"use strict";var r=n(9037),i=n(7697),o=n(2148),a=n(9633),s=n(3689),c=r.RegExp,u=c.prototype;i&&s((function(){var t=!0;try{c(".","d")}catch(e){t=!1}var e={},n="",r=t?"dgimsy":"gimsy",i=function(t,r){Object.defineProperty(e,t,{get:function(){return n+=r,!0}})},o={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var a in t&&(o.hasIndices="d"),o)i(a,o[a]);return Object.getOwnPropertyDescriptor(u,"flags").get.call(e)!==r||n!==r}))&&o(u,"flags",{configurable:!0,get:a})},1694:function(t,e,n){"use strict";var r=n(730).charAt,i=n(4327),o=n(618),a=n(1934),s=n(7807),c="String Iterator",u=o.set,l=o.getterFor(c);a(String,"String",(function(t){u(this,{type:c,string:i(t),index:0})}),(function(){var t,e=l(this),n=e.string,i=e.index;return i>=n.length?s(void 0,!0):(t=r(n,i),e.index+=t.length,s(t,!1))}))},6532:function(t,e,n){"use strict";var r=n(9989),i=n(2615),o=n(8844),a=n(4684),s=n(9985),c=n(981),u=n(1245),l=n(4327),h=n(4849),d=n(3477),f=n(7017),p=n(4201),g=n(3931),m=p("replace"),v=TypeError,y=o("".indexOf),w=o("".replace),S=o("".slice),A=Math.max,x=function(t,e,n){return n>t.length?-1:""===e?n:y(t,e,n)};r({target:"String",proto:!0},{replaceAll:function(t,e){var n,r,o,p,b,R,E,T,P,C=a(this),_=0,I=0,D="";if(!c(t)){if((n=u(t))&&(r=l(a(d(t))),!~y(r,"g")))throw new v("`.replaceAll` does not allow non-global regexes");if(o=h(t,m))return i(o,t,C,e);if(g&&n)return w(l(C),t,e)}for(p=l(C),b=l(t),(R=s(e))||(e=l(e)),E=b.length,T=A(1,E),_=x(p,b,0);-1!==_;)P=R?l(e(b,_,p)):f(b,p,_,[],void 0,e),D+=S(p,I,_)+P,I=_+E,_=x(p,b,_+T);return I<p.length&&(D+=S(p,I)),D}})},7267:function(t,e,n){"use strict";var r=n(1735),i=n(2615),o=n(8844),a=n(8678),s=n(3689),c=n(5027),u=n(9985),l=n(981),h=n(8700),d=n(3126),f=n(4327),p=n(4684),g=n(1514),m=n(4849),v=n(7017),y=n(6100),w=n(4201)("replace"),S=Math.max,A=Math.min,x=o([].concat),b=o([].push),R=o("".indexOf),E=o("".slice),T="$0"==="a".replace(/./,"$0"),P=!!/./[w]&&""===/./[w]("a","$0");a("replace",(function(t,e,n){var o=P?"$":"$0";return[function(t,n){var r=p(this),o=l(t)?void 0:m(t,w);return o?i(o,t,r,n):i(e,f(r),t,n)},function(t,i){var a=c(this),s=f(t);if("string"==typeof i&&-1===R(i,o)&&-1===R(i,"$<")){var l=n(e,a,s,i);if(l.done)return l.value}var p=u(i);p||(i=f(i));var m,w=a.global;w&&(m=a.unicode,a.lastIndex=0);for(var T,P=[];null!==(T=y(a,s))&&(b(P,T),w);){""===f(T[0])&&(a.lastIndex=g(s,d(a.lastIndex),m))}for(var C,_="",I=0,D=0;D<P.length;D++){for(var M,L=f((T=P[D])[0]),k=S(A(h(T.index),s.length),0),V=[],H=1;H<T.length;H++)b(V,void 0===(C=T[H])?C:String(C));var O=T.groups;if(p){var N=x([L],V,k,s);void 0!==O&&b(N,O),M=f(r(i,void 0,N))}else M=v(L,s,k,V,O,i);k>=I&&(_+=E(s,I,k)+M,I=k+L.length)}return _+E(s,I)}]}),!!s((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!T||P)},9976:function(t,e,n){"use strict";var r=n(9037),i=n(2615),o=n(4872),a=n(6310),s=n(3250),c=n(690),u=n(3689),l=r.RangeError,h=r.Int8Array,d=h&&h.prototype,f=d&&d.set,p=o.aTypedArray,g=o.exportTypedArrayMethod,m=!u((function(){var t=new Uint8ClampedArray(2);return i(f,t,{length:1,0:3},1),3!==t[1]})),v=m&&o.NATIVE_ARRAY_BUFFER_VIEWS&&u((function(){var t=new h(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));g("set",(function(t){p(this);var e=s(arguments.length>1?arguments[1]:void 0,1),n=c(t);if(m)return i(f,this,n,e);var r=this.length,o=a(n),u=0;if(o+e>r)throw new l("Wrong length");for(;u<o;)this[e+u]=n[u++]}),!m||v)},3356:function(t,e,n){"use strict";var r=n(9037),i=n(6576),o=n(3689),a=n(509),s=n(382),c=n(4872),u=n(7365),l=n(7298),h=n(3615),d=n(7922),f=c.aTypedArray,p=c.exportTypedArrayMethod,g=r.Uint16Array,m=g&&i(g.prototype.sort),v=!(!m||o((function(){m(new g(2),null)}))&&o((function(){m(new g(2),{})}))),y=!!m&&!o((function(){if(h)return h<74;if(u)return u<67;if(l)return!0;if(d)return d<602;var t,e,n=new g(516),r=Array(516);for(t=0;t<516;t++)e=t%4,n[t]=515-t,r[t]=t-2*e+3;for(m(n,(function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(n[t]!==r[t])return!0}));p("sort",(function(t){return void 0!==t&&a(t),y?m(this,t):s(f(this),function(t){return function(e,n){return void 0!==t?+t(e,n)||0:n!=n?-1:e!=e?1:0===e&&0===n?1/e>0&&1/n<0?1:-1:e>n}}(t))}),!y||v)},8320:function(t,e,n){"use strict";n(6532)},6265:function(t,e,n){"use strict";var r=n(9037),i=n(6338),o=n(3265),a=n(752),s=n(5773),c=n(4201),u=c("iterator"),l=c("toStringTag"),h=a.values,d=function(t,e){if(t){if(t[u]!==h)try{s(t,u,h)}catch(e){t[u]=h}if(t[l]||s(t,l,e),i[e])for(var n in a)if(t[n]!==a[n])try{s(t,n,a[n])}catch(e){t[n]=a[n]}}};for(var f in i)d(r[f]&&r[f].prototype,f);d(o,"DOMTokenList")},2625:function(t,e,n){"use strict";n(752);var r=n(9989),i=n(9037),o=n(2615),a=n(8844),s=n(7697),c=n(6837),u=n(1880),l=n(2148),h=n(6045),d=n(5997),f=n(974),p=n(618),g=n(767),m=n(9985),v=n(6812),y=n(4071),w=n(926),S=n(5027),A=n(8999),x=n(4327),b=n(5391),R=n(5684),E=n(5185),T=n(1664),P=n(7807),C=n(1500),_=n(4201),I=n(382),D=_("iterator"),M="URLSearchParams",L=M+"Iterator",k=p.set,V=p.getterFor(M),H=p.getterFor(L),O=Object.getOwnPropertyDescriptor,N=function(t){if(!s)return i[t];var e=O(i,t);return e&&e.value},U=N("fetch"),j=N("Request"),F=N("Headers"),B=j&&j.prototype,$=F&&F.prototype,Y=i.RegExp,X=i.TypeError,z=i.decodeURIComponent,G=i.encodeURIComponent,q=a("".charAt),W=a([].join),K=a([].push),J=a("".replace),Z=a([].shift),Q=a([].splice),tt=a("".split),et=a("".slice),nt=/\+/g,rt=Array(4),it=function(t){return rt[t-1]||(rt[t-1]=Y("((?:%[\\da-f]{2}){"+t+"})","gi"))},ot=function(t){try{return z(t)}catch(e){return t}},at=function(t){var e=J(t,nt," "),n=4;try{return z(e)}catch(t){for(;n;)e=J(e,it(n--),ot);return e}},st=/[!'()~]|%20/g,ct={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},ut=function(t){return ct[t]},lt=function(t){return J(G(t),st,ut)},ht=f((function(t,e){k(this,{type:L,target:V(t).entries,index:0,kind:e})}),M,(function(){var t=H(this),e=t.target,n=t.index++;if(!e||n>=e.length)return t.target=void 0,P(void 0,!0);var r=e[n];switch(t.kind){case"keys":return P(r.key,!1);case"values":return P(r.value,!1)}return P([r.key,r.value],!1)}),!0),dt=function(t){this.entries=[],this.url=null,void 0!==t&&(A(t)?this.parseObject(t):this.parseQuery("string"==typeof t?"?"===q(t,0)?et(t,1):t:x(t)))};dt.prototype={type:M,bindURL:function(t){this.url=t,this.update()},parseObject:function(t){var e,n,r,i,a,s,c,u=this.entries,l=T(t);if(l)for(n=(e=E(t,l)).next;!(r=o(n,e)).done;){if(a=(i=E(S(r.value))).next,(s=o(a,i)).done||(c=o(a,i)).done||!o(a,i).done)throw new X("Expected sequence with length 2");K(u,{key:x(s.value),value:x(c.value)})}else for(var h in t)v(t,h)&&K(u,{key:h,value:x(t[h])})},parseQuery:function(t){if(t)for(var e,n,r=this.entries,i=tt(t,"&"),o=0;o<i.length;)(e=i[o++]).length&&(n=tt(e,"="),K(r,{key:at(Z(n)),value:at(W(n,"="))}))},serialize:function(){for(var t,e=this.entries,n=[],r=0;r<e.length;)t=e[r++],K(n,lt(t.key)+"="+lt(t.value));return W(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var ft=function(){g(this,pt);var t=k(this,new dt(arguments.length>0?arguments[0]:void 0));s||(this.size=t.entries.length)},pt=ft.prototype;if(h(pt,{append:function(t,e){var n=V(this);C(arguments.length,2),K(n.entries,{key:x(t),value:x(e)}),s||this.length++,n.updateURL()},delete:function(t){for(var e=V(this),n=C(arguments.length,1),r=e.entries,i=x(t),o=n<2?void 0:arguments[1],a=void 0===o?o:x(o),c=0;c<r.length;){var u=r[c];if(u.key!==i||void 0!==a&&u.value!==a)c++;else if(Q(r,c,1),void 0!==a)break}s||(this.size=r.length),e.updateURL()},get:function(t){var e=V(this).entries;C(arguments.length,1);for(var n=x(t),r=0;r<e.length;r++)if(e[r].key===n)return e[r].value;return null},getAll:function(t){var e=V(this).entries;C(arguments.length,1);for(var n=x(t),r=[],i=0;i<e.length;i++)e[i].key===n&&K(r,e[i].value);return r},has:function(t){for(var e=V(this).entries,n=C(arguments.length,1),r=x(t),i=n<2?void 0:arguments[1],o=void 0===i?i:x(i),a=0;a<e.length;){var s=e[a++];if(s.key===r&&(void 0===o||s.value===o))return!0}return!1},set:function(t,e){var n=V(this);C(arguments.length,1);for(var r,i=n.entries,o=!1,a=x(t),c=x(e),u=0;u<i.length;u++)(r=i[u]).key===a&&(o?Q(i,u--,1):(o=!0,r.value=c));o||K(i,{key:a,value:c}),s||(this.size=i.length),n.updateURL()},sort:function(){var t=V(this);I(t.entries,(function(t,e){return t.key>e.key?1:-1})),t.updateURL()},forEach:function(t){for(var e,n=V(this).entries,r=y(t,arguments.length>1?arguments[1]:void 0),i=0;i<n.length;)r((e=n[i++]).value,e.key,this)},keys:function(){return new ht(this,"keys")},values:function(){return new ht(this,"values")},entries:function(){return new ht(this,"entries")}},{enumerable:!0}),u(pt,D,pt.entries,{name:"entries"}),u(pt,"toString",(function(){return V(this).serialize()}),{enumerable:!0}),s&&l(pt,"size",{get:function(){return V(this).entries.length},configurable:!0,enumerable:!0}),d(ft,M),r({global:!0,constructor:!0,forced:!c},{URLSearchParams:ft}),!c&&m(F)){var gt=a($.has),mt=a($.set),vt=function(t){if(A(t)){var e,n=t.body;if(w(n)===M)return e=t.headers?new F(t.headers):new F,gt(e,"content-type")||mt(e,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),b(t,{body:R(0,x(n)),headers:R(0,e)})}return t};if(m(U)&&r({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(t){return U(t,arguments.length>1?vt(arguments[1]):{})}}),m(j)){var yt=function(t){return g(this,B),new j(t,arguments.length>1?vt(arguments[1]):{})};B.constructor=yt,yt.prototype=B,r({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:yt})}}t.exports={URLSearchParams:ft,getState:V}},9307:function(t,e,n){"use strict";n(2625)},9391:function(t,e,n){"use strict";n(1694);var r,i=n(9989),o=n(7697),a=n(6837),s=n(9037),c=n(4071),u=n(8844),l=n(1880),h=n(2148),d=n(767),f=n(6812),p=n(5394),g=n(1055),m=n(9015),v=n(730).codeAt,y=n(6430),w=n(4327),S=n(5997),A=n(1500),x=n(2625),b=n(618),R=b.set,E=b.getterFor("URL"),T=x.URLSearchParams,P=x.getState,C=s.URL,_=s.TypeError,I=s.parseInt,D=Math.floor,M=Math.pow,L=u("".charAt),k=u(/./.exec),V=u([].join),H=u(1..toString),O=u([].pop),N=u([].push),U=u("".replace),j=u([].shift),F=u("".split),B=u("".slice),$=u("".toLowerCase),Y=u([].unshift),X="Invalid scheme",z="Invalid host",G="Invalid port",q=/[a-z]/i,W=/[\d+-.a-z]/i,K=/\d/,J=/^0x/i,Z=/^[0-7]+$/,Q=/^\d+$/,tt=/^[\da-f]+$/i,et=/[\0\t\n\r #%/:<>?@[\\\]^|]/,nt=/[\0\t\n\r #/:<>?@[\\\]^|]/,rt=/^[\u0000-\u0020]+/,it=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,ot=/[\t\n\r]/g,at=function(t){var e,n,r,i;if("number"==typeof t){for(e=[],n=0;n<4;n++)Y(e,t%256),t=D(t/256);return V(e,".")}if("object"==typeof t){for(e="",r=function(t){for(var e=null,n=1,r=null,i=0,o=0;o<8;o++)0!==t[o]?(i>n&&(e=r,n=i),r=null,i=0):(null===r&&(r=o),++i);return i>n&&(e=r,n=i),e}(t),n=0;n<8;n++)i&&0===t[n]||(i&&(i=!1),r===n?(e+=n?":":"::",i=!0):(e+=H(t[n],16),n<7&&(e+=":")));return"["+e+"]"}return t},st={},ct=p({},st,{" ":1,'"':1,"<":1,">":1,"`":1}),ut=p({},ct,{"#":1,"?":1,"{":1,"}":1}),lt=p({},ut,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),ht=function(t,e){var n=v(t,0);return n>32&&n<127&&!f(e,t)?t:encodeURIComponent(t)},dt={ftp:21,file:null,http:80,https:443,ws:80,wss:443},ft=function(t,e){var n;return 2===t.length&&k(q,L(t,0))&&(":"===(n=L(t,1))||!e&&"|"===n)},pt=function(t){var e;return t.length>1&&ft(B(t,0,2))&&(2===t.length||"/"===(e=L(t,2))||"\\"===e||"?"===e||"#"===e)},gt=function(t){return"."===t||"%2e"===$(t)},mt={},vt={},yt={},wt={},St={},At={},xt={},bt={},Rt={},Et={},Tt={},Pt={},Ct={},_t={},It={},Dt={},Mt={},Lt={},kt={},Vt={},Ht={},Ot=function(t,e,n){var r,i,o,a=w(t);if(e){if(i=this.parse(a))throw new _(i);this.searchParams=null}else{if(void 0!==n&&(r=new Ot(n,!0)),i=this.parse(a,null,r))throw new _(i);(o=P(new T)).bindURL(this),this.searchParams=o}};Ot.prototype={type:"URL",parse:function(t,e,n){var i,o,a,s,c,u=this,l=e||mt,h=0,d="",p=!1,v=!1,y=!1;for(t=w(t),e||(u.scheme="",u.username="",u.password="",u.host=null,u.port=null,u.path=[],u.query=null,u.fragment=null,u.cannotBeABaseURL=!1,t=U(t,rt,""),t=U(t,it,"$1")),t=U(t,ot,""),i=g(t);h<=i.length;){switch(o=i[h],l){case mt:if(!o||!k(q,o)){if(e)return X;l=yt;continue}d+=$(o),l=vt;break;case vt:if(o&&(k(W,o)||"+"===o||"-"===o||"."===o))d+=$(o);else{if(":"!==o){if(e)return X;d="",l=yt,h=0;continue}if(e&&(u.isSpecial()!==f(dt,d)||"file"===d&&(u.includesCredentials()||null!==u.port)||"file"===u.scheme&&!u.host))return;if(u.scheme=d,e)return void(u.isSpecial()&&dt[u.scheme]===u.port&&(u.port=null));d="","file"===u.scheme?l=_t:u.isSpecial()&&n&&n.scheme===u.scheme?l=wt:u.isSpecial()?l=bt:"/"===i[h+1]?(l=St,h++):(u.cannotBeABaseURL=!0,N(u.path,""),l=kt)}break;case yt:if(!n||n.cannotBeABaseURL&&"#"!==o)return X;if(n.cannotBeABaseURL&&"#"===o){u.scheme=n.scheme,u.path=m(n.path),u.query=n.query,u.fragment="",u.cannotBeABaseURL=!0,l=Ht;break}l="file"===n.scheme?_t:At;continue;case wt:if("/"!==o||"/"!==i[h+1]){l=At;continue}l=Rt,h++;break;case St:if("/"===o){l=Et;break}l=Lt;continue;case At:if(u.scheme=n.scheme,o===r)u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=m(n.path),u.query=n.query;else if("/"===o||"\\"===o&&u.isSpecial())l=xt;else if("?"===o)u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=m(n.path),u.query="",l=Vt;else{if("#"!==o){u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=m(n.path),u.path.length--,l=Lt;continue}u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=m(n.path),u.query=n.query,u.fragment="",l=Ht}break;case xt:if(!u.isSpecial()||"/"!==o&&"\\"!==o){if("/"!==o){u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,l=Lt;continue}l=Et}else l=Rt;break;case bt:if(l=Rt,"/"!==o||"/"!==L(d,h+1))continue;h++;break;case Rt:if("/"!==o&&"\\"!==o){l=Et;continue}break;case Et:if("@"===o){p&&(d="%40"+d),p=!0,a=g(d);for(var S=0;S<a.length;S++){var A=a[S];if(":"!==A||y){var x=ht(A,lt);y?u.password+=x:u.username+=x}else y=!0}d=""}else if(o===r||"/"===o||"?"===o||"#"===o||"\\"===o&&u.isSpecial()){if(p&&""===d)return"Invalid authority";h-=g(d).length+1,d="",l=Tt}else d+=o;break;case Tt:case Pt:if(e&&"file"===u.scheme){l=Dt;continue}if(":"!==o||v){if(o===r||"/"===o||"?"===o||"#"===o||"\\"===o&&u.isSpecial()){if(u.isSpecial()&&""===d)return z;if(e&&""===d&&(u.includesCredentials()||null!==u.port))return;if(s=u.parseHost(d))return s;if(d="",l=Mt,e)return;continue}"["===o?v=!0:"]"===o&&(v=!1),d+=o}else{if(""===d)return z;if(s=u.parseHost(d))return s;if(d="",l=Ct,e===Pt)return}break;case Ct:if(!k(K,o)){if(o===r||"/"===o||"?"===o||"#"===o||"\\"===o&&u.isSpecial()||e){if(""!==d){var b=I(d,10);if(b>65535)return G;u.port=u.isSpecial()&&b===dt[u.scheme]?null:b,d=""}if(e)return;l=Mt;continue}return G}d+=o;break;case _t:if(u.scheme="file","/"===o||"\\"===o)l=It;else{if(!n||"file"!==n.scheme){l=Lt;continue}switch(o){case r:u.host=n.host,u.path=m(n.path),u.query=n.query;break;case"?":u.host=n.host,u.path=m(n.path),u.query="",l=Vt;break;case"#":u.host=n.host,u.path=m(n.path),u.query=n.query,u.fragment="",l=Ht;break;default:pt(V(m(i,h),""))||(u.host=n.host,u.path=m(n.path),u.shortenPath()),l=Lt;continue}}break;case It:if("/"===o||"\\"===o){l=Dt;break}n&&"file"===n.scheme&&!pt(V(m(i,h),""))&&(ft(n.path[0],!0)?N(u.path,n.path[0]):u.host=n.host),l=Lt;continue;case Dt:if(o===r||"/"===o||"\\"===o||"?"===o||"#"===o){if(!e&&ft(d))l=Lt;else if(""===d){if(u.host="",e)return;l=Mt}else{if(s=u.parseHost(d))return s;if("localhost"===u.host&&(u.host=""),e)return;d="",l=Mt}continue}d+=o;break;case Mt:if(u.isSpecial()){if(l=Lt,"/"!==o&&"\\"!==o)continue}else if(e||"?"!==o)if(e||"#"!==o){if(o!==r&&(l=Lt,"/"!==o))continue}else u.fragment="",l=Ht;else u.query="",l=Vt;break;case Lt:if(o===r||"/"===o||"\\"===o&&u.isSpecial()||!e&&("?"===o||"#"===o)){if(".."===(c=$(c=d))||"%2e."===c||".%2e"===c||"%2e%2e"===c?(u.shortenPath(),"/"===o||"\\"===o&&u.isSpecial()||N(u.path,"")):gt(d)?"/"===o||"\\"===o&&u.isSpecial()||N(u.path,""):("file"===u.scheme&&!u.path.length&&ft(d)&&(u.host&&(u.host=""),d=L(d,0)+":"),N(u.path,d)),d="","file"===u.scheme&&(o===r||"?"===o||"#"===o))for(;u.path.length>1&&""===u.path[0];)j(u.path);"?"===o?(u.query="",l=Vt):"#"===o&&(u.fragment="",l=Ht)}else d+=ht(o,ut);break;case kt:"?"===o?(u.query="",l=Vt):"#"===o?(u.fragment="",l=Ht):o!==r&&(u.path[0]+=ht(o,st));break;case Vt:e||"#"!==o?o!==r&&("'"===o&&u.isSpecial()?u.query+="%27":u.query+="#"===o?"%23":ht(o,st)):(u.fragment="",l=Ht);break;case Ht:o!==r&&(u.fragment+=ht(o,ct))}h++}},parseHost:function(t){var e,n,r;if("["===L(t,0)){if("]"!==L(t,t.length-1))return z;if(e=function(t){var e,n,r,i,o,a,s,c=[0,0,0,0,0,0,0,0],u=0,l=null,h=0,d=function(){return L(t,h)};if(":"===d()){if(":"!==L(t,1))return;h+=2,l=++u}for(;d();){if(8===u)return;if(":"!==d()){for(e=n=0;n<4&&k(tt,d());)e=16*e+I(d(),16),h++,n++;if("."===d()){if(0===n)return;if(h-=n,u>6)return;for(r=0;d();){if(i=null,r>0){if(!("."===d()&&r<4))return;h++}if(!k(K,d()))return;for(;k(K,d());){if(o=I(d(),10),null===i)i=o;else{if(0===i)return;i=10*i+o}if(i>255)return;h++}c[u]=256*c[u]+i,2!=++r&&4!==r||u++}if(4!==r)return;break}if(":"===d()){if(h++,!d())return}else if(d())return;c[u++]=e}else{if(null!==l)return;h++,l=++u}}if(null!==l)for(a=u-l,u=7;0!==u&&a>0;)s=c[u],c[u--]=c[l+a-1],c[l+--a]=s;else if(8!==u)return;return c}(B(t,1,-1)),!e)return z;this.host=e}else if(this.isSpecial()){if(t=y(t),k(et,t))return z;if(e=function(t){var e,n,r,i,o,a,s,c=F(t,".");if(c.length&&""===c[c.length-1]&&c.length--,(e=c.length)>4)return t;for(n=[],r=0;r<e;r++){if(""===(i=c[r]))return t;if(o=10,i.length>1&&"0"===L(i,0)&&(o=k(J,i)?16:8,i=B(i,8===o?1:2)),""===i)a=0;else{if(!k(10===o?Q:8===o?Z:tt,i))return t;a=I(i,o)}N(n,a)}for(r=0;r<e;r++)if(a=n[r],r===e-1){if(a>=M(256,5-e))return null}else if(a>255)return null;for(s=O(n),r=0;r<n.length;r++)s+=n[r]*M(256,3-r);return s}(t),null===e)return z;this.host=e}else{if(k(nt,t))return z;for(e="",n=g(t),r=0;r<n.length;r++)e+=ht(n[r],st);this.host=e}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme},includesCredentials:function(){return""!==this.username||""!==this.password},isSpecial:function(){return f(dt,this.scheme)},shortenPath:function(){var t=this.path,e=t.length;!e||"file"===this.scheme&&1===e&&ft(t[0],!0)||t.length--},serialize:function(){var t=this,e=t.scheme,n=t.username,r=t.password,i=t.host,o=t.port,a=t.path,s=t.query,c=t.fragment,u=e+":";return null!==i?(u+="//",t.includesCredentials()&&(u+=n+(r?":"+r:"")+"@"),u+=at(i),null!==o&&(u+=":"+o)):"file"===e&&(u+="//"),u+=t.cannotBeABaseURL?a[0]:a.length?"/"+V(a,"/"):"",null!==s&&(u+="?"+s),null!==c&&(u+="#"+c),u},setHref:function(t){var e=this.parse(t);if(e)throw new _(e);this.searchParams.update()},getOrigin:function(){var t=this.scheme,e=this.port;if("blob"===t)try{return new Nt(t.path[0]).origin}catch(t){return"null"}return"file"!==t&&this.isSpecial()?t+"://"+at(this.host)+(null!==e?":"+e:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(t){this.parse(w(t)+":",mt)},getUsername:function(){return this.username},setUsername:function(t){var e=g(w(t));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<e.length;n++)this.username+=ht(e[n],lt)}},getPassword:function(){return this.password},setPassword:function(t){var e=g(w(t));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<e.length;n++)this.password+=ht(e[n],lt)}},getHost:function(){var t=this.host,e=this.port;return null===t?"":null===e?at(t):at(t)+":"+e},setHost:function(t){this.cannotBeABaseURL||this.parse(t,Tt)},getHostname:function(){var t=this.host;return null===t?"":at(t)},setHostname:function(t){this.cannotBeABaseURL||this.parse(t,Pt)},getPort:function(){var t=this.port;return null===t?"":w(t)},setPort:function(t){this.cannotHaveUsernamePasswordPort()||(""===(t=w(t))?this.port=null:this.parse(t,Ct))},getPathname:function(){var t=this.path;return this.cannotBeABaseURL?t[0]:t.length?"/"+V(t,"/"):""},setPathname:function(t){this.cannotBeABaseURL||(this.path=[],this.parse(t,Mt))},getSearch:function(){var t=this.query;return t?"?"+t:""},setSearch:function(t){""===(t=w(t))?this.query=null:("?"===L(t,0)&&(t=B(t,1)),this.query="",this.parse(t,Vt)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var t=this.fragment;return t?"#"+t:""},setHash:function(t){""!==(t=w(t))?("#"===L(t,0)&&(t=B(t,1)),this.fragment="",this.parse(t,Ht)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Nt=function(t){var e=d(this,Ut),n=A(arguments.length,1)>1?arguments[1]:void 0,r=R(e,new Ot(t,!1,n));o||(e.href=r.serialize(),e.origin=r.getOrigin(),e.protocol=r.getProtocol(),e.username=r.getUsername(),e.password=r.getPassword(),e.host=r.getHost(),e.hostname=r.getHostname(),e.port=r.getPort(),e.pathname=r.getPathname(),e.search=r.getSearch(),e.searchParams=r.getSearchParams(),e.hash=r.getHash())},Ut=Nt.prototype,jt=function(t,e){return{get:function(){return E(this)[t]()},set:e&&function(t){return E(this)[e](t)},configurable:!0,enumerable:!0}};if(o&&(h(Ut,"href",jt("serialize","setHref")),h(Ut,"origin",jt("getOrigin")),h(Ut,"protocol",jt("getProtocol","setProtocol")),h(Ut,"username",jt("getUsername","setUsername")),h(Ut,"password",jt("getPassword","setPassword")),h(Ut,"host",jt("getHost","setHost")),h(Ut,"hostname",jt("getHostname","setHostname")),h(Ut,"port",jt("getPort","setPort")),h(Ut,"pathname",jt("getPathname","setPathname")),h(Ut,"search",jt("getSearch","setSearch")),h(Ut,"searchParams",jt("getSearchParams")),h(Ut,"hash",jt("getHash","setHash"))),l(Ut,"toJSON",(function(){return E(this).serialize()}),{enumerable:!0}),l(Ut,"toString",(function(){return E(this).serialize()}),{enumerable:!0}),C){var Ft=C.createObjectURL,Bt=C.revokeObjectURL;Ft&&l(Nt,"createObjectURL",c(Ft,C)),Bt&&l(Nt,"revokeObjectURL",c(Bt,C))}S(Nt,"URL"),i({global:!0,constructor:!0,forced:!a,sham:!o},{URL:Nt})},8730:function(t,e,n){"use strict";n(9391)}},o={};function a(t){var e=o[t];if(void 0!==e)return e.exports;var n=o[t]={exports:{}};return i[t].call(n.exports,n,n.exports,a),n.exports}a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,{a:e}),e},a.d=function(t,e){for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var s={};return function(){"use strict";function t(e,n){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t(e,n)}function e(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,t(e,n)}function n(){return n=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},n.apply(this,arguments)}a.r(s),a.d(s,{CreateAnnotAddon:function(){return La},CreateStampService:function(){return vo}});a(752),a(6265);var r=a(5778);const i=r.stateHandler,o=i.IStateHandler,c=i.HandStateHandler,u=r.vendors.Hammer,{STATE_HANDLER_CREATE_TEXT:l}=i.StateHandlerConsts,h=r.ViewerEvents,{getClientX:d,getClientY:f}=r.shared;let p=function(t){function r(e){var n;return(n=t.call(this,e)||this).cursorStyle="fv__cursor-note",n}e(r,t),r.getStateName=function(){return l};var i=r.prototype;return i.pageHandler=function(t){this.pageRender=t;let e=t.$handler;e.addClass(this.cursorStyle);let r=e[0];(this.hammer=new u.Manager(r,{recognizers:[[u.Tap]]})).on("tap",(e=>{let i=r.getBoundingClientRect(),o=e.srcEvent;const a=d(o),s=f(o);let u=[a-i.left,s-i.top];const l=u[0],p=u[1];return t.getPDFPage().then((e=>{const[r,i]=e.reverseDevicePoint([l,p],t.scale,t.getRotation()),o=this.pdfViewer.getDefaultAnnotConfig()("text");let a=n({flags:28,type:"text",rect:{left:r,right:r+20,top:i,bottom:i-20},subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Note")},o);e.addAnnot(a).then((e=>{const n=e[0],r=t.annotsRender.getAnnotRender(n.getId()).component;t.pdfViewer.eventEmitter.emit(h.addAnnotSuccess,r.annot),t.pdfViewer.getStateHandlerManager().switchTo(c.getStateName()),t.annotsRender.activeAnnot(n.getId()),setTimeout((function(){t.annotsRender.doubleTapAnnot(n.getId())}),100)}))}))}))},i.getNoteRightPanelData=function(){const t=localStorage.getItem("NOTE-STORAGE-KEY");return t?JSON.parse(t):t||{}},i.destroyPageHandler=function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle)},i.out=function(){this.destroyPageHandler()},r}(o);a(3964);const g=r.stateHandler,m=g.IStateHandler,v=(g.HandStateHandler,r.vendors.Hammer),{DebouncePromiseQueue:y}=r.shared,{getDevicePagePoint:w,deltaDeviceRect:S,appendSelectMark:A,removeSelectMark:x,removeTextSelectedRangeMark:b,showTextSelectedRangeMark:R}=g.StateHandlerUtils,E=r.ViewerEvents;let T=function(t){function n(e){var n;return(n=t.call(this,e)||this).cursorStyle="",n}e(n,t);var r=n.prototype;return r.getDefaultProps=function(t){return this.pdfViewer.getDefaultAnnotConfig()(t)},r.pageHandler=function(t){this.pageRender=t;let e=t.$handler;e.addClass(this.cursorStyle);let n,r,i=e[0],o=this.hammer=new v.Manager(i,{recognizers:[[v.Pan,{direction:v.DIRECTION_ALL}],[v.Tap]]}),a=-1,s=-1;o.on("tap",(e=>{this.pageRender.pdfViewer.activeElement();const n=this.pageRender.pdfViewer,r=e.srcEvent,[i,o]=t.getPDFPointFromClientPoint(r.clientX,r.clientY,!0),a=n.getEventEmitter();t.getPDFPage().then((e=>{const n=t.scale,r=t.rotate,a=e.getDeviceMatrix();return a.scale(n,n),a.rotate(r),e.getAnnotObjectNumAtDevicePoint([i,o],1,[a.a,a.b,a.c,a.d,a.e,a.f])})).then((n=>{const r=t.getAnnotRender(n);if(r){const t=r.component;a.emit(E.tapAnnotation,r,e),t.tapAnnot(e)}}))})),o.on("panstart",(e=>{if(!1===this.panStart(e,this))return;a=-1,s=-1;let o=w(i,e);n=[o.x,o.y],this.hideSelectMark(),r=new y,this.shouldDrawRange=!1,t.getTextContinueRectAtDevicePoints([o.x,o.y],[o.x+5,o.y+5],-1,-1).then((t=>{this.shouldDrawRange=!(t||[])[0]}))})),o.on("panmove",(t=>{!1!==this.panMove(t,this)&&r&&r.push((()=>{let e=this.pageRender;const r=[n[0]+t.deltaX,n[1]+t.deltaY];let i;if(this.shouldDrawRange){R(e,n,r);const o=S(n,t.deltaX,t.deltaY);i=e.getTextRectsAtRect(o)}else i=this.getTextRect(n,r,a,s);i.then((t=>{let n;return(n=t[0])&&"string"==typeof n.text&&(a=n.start,s=n.end),Promise.all([e.getPDFPage(),t])})).then((([t,n])=>{this.pdfViewer.eventEmitter.emit("collab-creating-op",{type:"textMarkup",rects:n,page:t.getIndex()});const r=e.transformRectArray(t,n);this.showSelectMark(r)}))}))})),o.on("panend",(e=>{if(!1===this.panEnd(e,this)||!r)return;if(!r)return;r.end(),r=null;const i=[n[0]+e.deltaX,n[1]+e.deltaY];let o;if(this.shouldDrawRange){this.shouldDrawRange=!1,b(t,t.$handler);const r=S(n,e.deltaX,e.deltaY);o=t.getTextRectsAtRect(r)}else o=this.getTextRect(n,i,a,s);o.then((e=>{let n;return(n=e[0])&&"string"==typeof n.text&&(a=n.start,s=n.end),this.hideSelectMark(),Promise.all([t.getPDFPage(),e])})).then((([t,e])=>e.length<1?Promise.resolve():this.addAnnot(t,e).then((t=>{let e=t[0];const n=this.pageRender.annotsRender.getAnnotRender(e.getId()).component;return this.afterAddAnnot(n),this.pageRender.annotsRender.activeAnnot(e.getId()),t})).then((t=>{if(!this.pdfViewer.config.showCommentList)return;const e=t[t.length-2];this.pageRender.annotsRender.getAnnotRender(e.getId()).component.showReplyDialog()})).then((()=>{0}))))}))},r.destroyPageHandler=function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle),this.hideSelectMark(),this.pdfViewer.eventEmitter.emit("collab-creating-op",{cancle:1,page:this.pageRender.index})},r.out=function(){this.destroyPageHandler()},r.panStart=function(){},r.panMove=function(){},r.panEnd=function(){},r.showSelectMark=function(t){A(this.pageRender.$handler,t)},r.hideSelectMark=function(){x(this.pageRender.$handler)},r.getTextRect=function(t,e,n,r){return this.pageRender.getTextContinueRectAtDevicePoints(t,e,n,r)},r.addAnnot=function(t,e){},r.afterAddAnnot=function(t){this.pdfViewer.eventEmitter.emit(E.addAnnotSuccess,t.annot)},n}(m);const P=r.stateHandler,{STATE_HANDLER_CREATE_HIGHLIGHT:C}=P.StateHandlerConsts;let _=function(t){function r(e){var n;return(n=t.call(this,e)||this).cursorStyle="fv__cursor-highlight",n}return e(r,t),r.getStateName=function(){return C},r.prototype.addAnnot=function(t,e){return t.addAnnot(n({flags:4,type:"highlight",subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Highlight"),rect:{left:0,right:0,top:0,bottom:0},coords:e},this.getDefaultProps("highlight")))},r}(T);const I=r.stateHandler,{STATE_HANDLER_CREATE_STRIKE_OUT:D}=I.StateHandlerConsts;let M=function(t){function r(e){var n;return(n=t.call(this,e)||this).cursorStyle="fv__cursor-strikeout",n}return e(r,t),r.getStateName=function(){return D},r.prototype.addAnnot=function(t,e){return t.addAnnot(n({flags:4,type:"strikeout",subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Strikeout"),rect:{left:0,right:0,top:0,bottom:0},coords:e},this.getDefaultProps("strikeout")))},r}(T);const L=r.stateHandler,{STATE_HANDLER_CREATE_UNDERLINE:k}=L.StateHandlerConsts;let V=function(t){function r(e){var n;return(n=t.call(this,e)||this).cursorStyle="fv__cursor-underline",n}return e(r,t),r.getStateName=function(){return k},r.prototype.addAnnot=function(t,e){return t.addAnnot(n({flags:4,type:"underline",rect:{left:0,right:0,top:0,bottom:0},coords:e,subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Underline")},this.getDefaultProps("underline")))},r}(T);const H=r.stateHandler,{STATE_HANDLER_CREATE_SQUIGGLY:O}=H.StateHandlerConsts;let N=function(t){function r(e){var n;return(n=t.call(this,e)||this).cursorStyle="fv__cursor-s-underline",n}return e(r,t),r.getStateName=function(){return O},r.prototype.addAnnot=function(t,e){return t.addAnnot(n({flags:4,type:"squiggly",subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Squiggly"),rect:{left:0,right:0,top:0,bottom:0},coords:e},this.getDefaultProps("squiggly")))},r}(T);const U=r.stateHandler,{STATE_HANDLER_CREATE_REPLACE:j}=U.StateHandlerConsts,{getCaretRectAndRotate:F}=U.StateHandlerUtils;let B=function(t){function n(e){var n;return(n=t.call(this,e)||this).cursorStyle="fv__cursor-replace-text",n}return e(n,t),n.getStateName=function(){return j},n.prototype.addAnnot=function(t,e){const n=this.pdfViewer.getDefaultAnnotConfig()("replace"),{rect:r,rotate:i}=F(e);return t.addAnnotGroup([{flags:4,type:"strikeout",rect:{left:0,right:0,top:0,bottom:0},coords:e,noPopup:!0,typeAlias:"Replace",intent:"StrikeOutTextEdit",color:n.color||255,opacity:n.opacity||1,subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Replace")},{type:"caret",flags:4,rect:r,typeAlias:"Replace",intent:"Replace",rotation:i,color:n.color||255,opacity:n.opacity||1,subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Replace")}],1)},n}(T);function $(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Y(t){return function(t){if(Array.isArray(t))return $(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return $(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(t,e,n){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var r=e.length;return function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}(e,void 0!==n&&n<r?n:r)}return t(e,n)}const{stateHandler:z,Matrix:G}=r,q=z.IStateHandler,W=(z.HandStateHandler,r.vendors.Hammer),{DebouncePromiseQueue:K,getClientX:J,getClientY:Z}=r.shared,{getDevicePagePoint:Q,deltaDeviceRect:tt,appendSelectMark:et,removeSelectMark:nt,getCaretRectAndRotate:rt}=z.StateHandlerUtils,it=r.ViewerEvents,{STATE_HANDLER_CREATE_CARET:ot}=z.StateHandlerConsts;let at=function(t){function n(e){var n;return(n=t.call(this,e)||this).cursorStyle="fv__cursor-insert-text",n}e(n,t),n.getStateName=function(){return ot};var r=n.prototype;return r.pageHandler=function(t){this.pageRender=t;let e=t.$handler;e.addClass(this.cursorStyle);let n,r,i=e[0],o=this.hammer=new W.Manager(i,{recognizers:[[W.Pan,{direction:W.DIRECTION_ALL}],[W.Tap]]}),a=-1,s=-1;o.on("panstart",(t=>{if(!1===this.panStart(t,this))return;a=-1,s=-1;let e=Q(i,t);n=[e.x,e.y],this.hideSelectMark(),r=new K})),o.on("panmove",(t=>{!1!==this.panMove(t,this)&&r.push((()=>{let e=this.pageRender;const r=[n[0]+t.deltaX,n[1]+t.deltaY];return this.getTextRect(n,r,a,s).then((t=>{let n;return(n=t[0])&&"string"==typeof n.text&&(a=n.start,s=n.end),Promise.all([e.getPDFPage(),t])})).then((([t,n])=>e.transformRectArray(t,n))).then((t=>{this.showSelectMark(t)}))}))})),o.on("panend",(e=>{if(!1===this.panEnd(e,this))return;r.end(),r=null;const i=[n[0]+e.deltaX,n[1]+e.deltaY];return this.getTextRect(n,i,a,s).then((e=>{let n;return(n=e[0])&&"string"==typeof n.text&&(a=n.start,s=n.end),this.hideSelectMark(),Promise.all([t.getPDFPage(),e])})).then((([t,e])=>{if(e.length<1)return Promise.resolve();const{rect:n,rotate:r}=rt(e);return t.addAnnot({type:"caret",flags:4,rect:n,rotation:r,subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Insert")}).then((t=>{const e=t[0],n=this.pageRender.annotsRender.getAnnotRender(e.getId()).component;this.pdfViewer.eventEmitter.emit(it.addAnnotSuccess,n.annot),this.pageRender.annotsRender.activeAnnot(e.getId()),this.pdfViewer.config.showCommentList&&n.showReplyDialog()})).then((()=>{0}))}))})),o.on("tap",(e=>{if(!1===this.tap(e,this))return;let n=i.getBoundingClientRect(),r=e.srcEvent;const o=J(r),a=Z(r);let s=[o-n.left,a-n.top];return t.getPDFPage().then((e=>{const n=e.reverseDevicePoint([s[0],s[1]],t.scale,t.getRotation());return e.getCharInfoAtPoint(n).then((t=>{if(!t)return;let n=t.top-t.bottom,r=t.bottom+n/2,i=(t.right+t.left)/2,o=new G;o.e=-i,o.f=-r;let a=(t.bottom+t.top)/2,s=a-n,c=t.right-3*n/8,u=t.right+3*n/8,l=o.transformRect(c,a,u,s),h=t.rotation*Math.PI/2;return o.reset(),o.rotate(-h),l=o.transformRect.apply(o,X(Y,l)),o.reset(),o.e=i,o.f=r,l=o.transformRect.apply(o,X(Y,l)),e.addAnnot({type:"caret",rect:{left:l[0],bottom:l[1],right:l[2],top:l[3]},rotation:h}).then((t=>{const e=t[0],n=this.pageRender.annotsRender.getAnnotRender(e.getId()).component;this.pdfViewer.eventEmitter.emit(it.addAnnotSuccess,n.annot),this.pageRender.annotsRender.activeAnnot(e.getId()),this.pdfViewer.config.showCommentList&&n.showReplyDialog()})).then((()=>{0}))}))}))}))},r.destroyPageHandler=function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle),this.hideSelectMark()},r.out=function(){this.destroyPageHandler()},r.panStart=function(){},r.panMove=function(){},r.panEnd=function(){},r.tap=function(){},r.showSelectMark=function(t){et(this.pageRender.$handler,t)},r.hideSelectMark=function(){nt(this.pageRender.$handler)},r.getTextRect=function(t,e,n,r){return this.pageRender.getTextContinueRectAtDevicePoints(t,e,n,r)},n}(q);a(4043),a(7267),a(8320);const st=r.stateHandler.IStateHandler,{Hammer:ct,jQuery:ut}=r.vendors;let lt=function(t){function n(e){return t.call(this,e)||this}e(n,t),n.textboxWidth=function(){return 100},n.textboxHeight=function(){return 20},n.calloutKneeLength=function(){return 20},n.getStateName=function(){return"createFreetext"};var r=n.prototype;return r.pageHandler=function(t){},n.edit=function(t,e){let n=t.annotsRender.getAnnotRender(e[0].objectNumber).component;n.active(!0),setTimeout((()=>{n.showReplyDialog("comment")}),0)},r.destroyPageHandler=function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass("fv__create-stamp-state-handler")},r.out=function(){this.destroyPageHandler()},n}(st);a(278);function ht(t,e){t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement?function(t,e){const n=t instanceof HTMLInputElement?t.value.length:t.textLength;dt(t,{startOffset:n,endOffset:n},e)}(t,e):"inherit"!==t.contentEditable&&ft(t,e)}function dt(t,e,n){t.focus(n),setTimeout((()=>{t.focus(n),t.setSelectionRange(e.startOffset,e.endOffset)})),t.setSelectionRange(e.startOffset,e.endOffset)}function ft(t,e,n){var r,i;t.focus(e),setTimeout((()=>t.focus(e)));const o=document.createRange();if(o.selectNodeContents(t),n){const e=t.childNodes[n.startNodeIndex||0];e&&o.setStart(e,Math.min(n.startOffset,(null===(r=e.textContent)||void 0===r?void 0:r.length)||0));const a=t.childNodes[n.endNodeIndex||0];a&&o.setStart(a,Math.min(n.endOffset,(null===(i=e.textContent)||void 0===i?void 0:i.length)||0))}o.collapse(!0);const a=window.getSelection();a&&(a.removeAllRanges(),a.addRange(o))}a(2003);const pt=5,gt=0,mt={left:0,center:1,right:2},vt=1,yt=2,wt=3;var St=a(8457);const At="editDiv";let xt=function(){function t(){}return t.formatHtmlStr=function(t){let e=t;const n={split:"split",remove:"remove",removeSelf:"removeTag"};[{startStr:"\x3c!--StartFragment--\x3e",endStr:"\x3c!--EndFragment--\x3e",operate:n.split},{startStr:"\x3c!--[if",endStr:"<![endif]--\x3e",operate:n.remove},{startStr:"<![if",endStr:"<![endif]>",operate:n.remove},{startStr:"<o:p>",endStr:"</o:p>",operate:n.remove},{startStr:"<w:Sdt",endStr:"</w:Sdt>",operate:n.removeTag},{startStr:"<w:sdtPr>",endStr:"</w:sdtPr>",operate:n.remove}].forEach((t=>{let r=e.indexOf(t.startStr);for(;r>-1;){switch(t.operate){case n.split:{let n=e.indexOf(t.endStr);e=e.slice(r+t.startStr.length,n>-1?n:e.length)}break;case n.remove:{let n=e.indexOf(t.endStr),i=e.substring(0,r),o=e.substring(n+t.endStr.length);e=i+o}break;case n.removeTag:{let n=e.substring(r),i=n.indexOf(">");e=e.substring(0,r)+n.substring(i+1),e=e.split(t.endStr).join("")}}r=e.indexOf(t.startStr)}}));const r=document.createElement("div");r.contentEditable=!0,r.id=At,r.style.display="none",document.body.appendChild(r),r.innerHTML=e.replaceAll("\n","").replaceAll("\r","");return this.addTagClassName(r)},t.getFont=function(t){let e=t[0];const n=new RegExp(`^\\s*${e}\\b`),r=["-apple-system","system-ui"," BlinkMacSystemFont"," Segoe UI"," Roboto"," Oxygen"," Ubuntu"," Fira Sans"," Droid Sans"," Helvetica Neue"," sans-serif"].some((t=>n.test(t)));return r?(St.DeviceInfo.isWindows?e="DengXian Light":St.DeviceInfo.isMacOS||St.DeviceInfo.isIOS?e="PingFangSC":St.DeviceInfo.isAndroid?e="Roboto":St.DeviceInfo.isLinux&&(e="Noto Sans"),e):e},t.formatRichText=function(t){const e=this.formatHtmlStr(t),n=document.getElementById(`${At}`);let r=e.map((t=>{let e=n.getElementsByClassName(`${t}`)[0],r=getComputedStyle(e),i=r.fontFamily.replaceAll('"',"").split(","),o=this.getFont(i);return{content:e.textContent,richTextStyle:{font:{name:o},textSize:parseInt(r.fontSize),textAlignment:mt[r.textAlign],textColor:(0,St.colorConvertor)(r.color,"int"),isBold:(()=>{let t=r.fontWeight,e=parseFloat(t);return isNaN(e)?t.includes("bold"):e>400})(),isItalic:(()=>{let t=r.fontStyle;return t.includes("italic")||t.includes("oblique")})(),isUnderline:r.textDecoration.includes("underline"),isStrikethrough:r.textDecoration.includes("line-through"),cornerMarkStyle:(()=>{let t=r.verticalAlign;return{sub:wt,super:yt}[t]||vt})()}}}));return n.remove(),r},t.addTagClassName=function(t,e=[],r={}){let i=e,o=t.childNodes.length;if(["block","flex"].includes(getComputedStyle(t).display)&&t.nextElementSibling&&(t.innerHTML+="\n"),o>0){Array.from(t.childNodes).forEach((e=>{if("#text"===e.nodeName){const n=document.createElement("span");n.innerHTML=`${e.textContent}`,n.style.textDecoration=`${r.underline?"underline":""} ${r.lineThrough?"line-through":""}`,n.style.verticalAlign=r.verticalAlign;const o=`foxitwebsdk-${Date.now()}-${parseInt(1e3*Math.random())}`;i.push(o),n.classList.add(o),t.replaceChild(n,e)}else{let t=getComputedStyle(e).textDecoration,o={};t.includes("underline")&&(o.underline=!0),t.includes("line-through")&&(o.lineThrough=!0);let a=getComputedStyle(e).verticalAlign;["sub","super"].includes(a)&&(o.verticalAlign=a),this.addTagClassName(e,i,n({},r,o))}}))}return i},t}();function bt(t,e,n){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var r=e.length;return function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}(e,void 0!==n&&n<r?n:r)}return t(e,n)}const{stateHandler:Rt,ViewerEvents:Et}=r,{getDevicePagePoint:Tt}=Rt.StateHandlerUtils,{Hammer:Pt}=r.vendors,{extendOptions:Ct,convertFromNumberToHex:_t}=r.shared,{STATE_HANDLER_CREATE_FREETEXT_TYPEWRITER:It}=Rt.StateHandlerConsts,{isFirefox:Dt}=r.BrowserInfo;let Mt=function(t){function n(e){var n;return(n=t.call(this,e)||this).cursorStyle="fv__cursor-typewriter",n}e(n,t),n.getStateName=function(){return It};var r=n.prototype;return r.pageHandler=function(t){this.pageRender=t,this.jqEventNamespace=(Date.now()*Math.random()).toString(34);let e=t.$handler;e.addClass("fv__create-stamp-state-handler "+this.cursorStyle);let n=e[0],r=this.hammer=new Pt.Manager(n,{recognizers:[[Pt.Tap]]});const i=t=>{const e=this.input=document.createElement("div");e.contentEditable=!0,n.appendChild(e),e.focus({preventScroll:!0})};e.on("touchstart",i),this.removeTouchStartListener=()=>{e.off("touchstart",i)},r.on("tap",(e=>{const r=Tt(n,e);const i=e=>{const i=100*t.scale*4/3,o=20*t.scale*2/3;let a={left:r.x,right:r.x+i,top:r.y,bottom:r.y+2*o};const s=this.input=this.input||document.createElement("div");Dt?"plaintext-only"!==s.contentEditable&&(s.contentEditable=!0,s.addEventListener("keyup",(t=>{t.ctrlKey&&/^v$/i.test(t.key)&&(s.innerHTML=s.innerText)}))):s.contentEditable=!0;const c=this.pdfViewer.getDefaultAnnotConfig(),u=Ct({defaultAppearance:{textColor:255,textSize:12,font:"Arial"}},"function"==typeof c?c("freetext","FreeTextTypewriter"):{});let l=u.defaultAppearance.textSize*t.scale*4/3;const{maxHeight:h,maxWidth:d}=function(t){const e=n.getBoundingClientRect();return{maxWidth:e.right-t.left,maxHeight:e.height-t.top}}(a);s.style.cssText=`\n                    position: absolute;\n                    left: ${a.left}px;\n                    top: ${a.top}px;\n                    min-width: ${l+5}px;\n                    min-height: ${l}px;\n                    font-size: ${l}px;\n                    line-height: 1;\n                    color: ${_t(16777215&u.defaultAppearance.textColor)};\n                    outline:1px solid #5aa;\n                    outline-offset:1px;\n                    max-width: ${d}px;\n                    max-height: ${h}px;\n                    overflow: hidden;\n                    white-space: pre-line;\n                    word-break: break-word;\n                `,s.innerText=u.contents||"",n.appendChild(s),ht(s),s.onmousedown=s.ontouchstart=s.onpointerdown=t=>{t.stopPropagation()};s.onkeydown=t=>{39!==t.keyCode&&37!==t.keyCode||t.stopPropagation()},s.onkeyup=t=>{};let f=!1,p="";s.onpaste=t=>{f=!0},s.oninput=t=>{if(f){const t=Array.from(s.childNodes).map((t=>{if(t.nodeType!==Node.TEXT_NODE){let e=t.style.fontFamily.replaceAll('"',"").split(",");return p=xt.getFont(e),new Text(t.innerText)}return t}));s.innerHTML="",s.append.apply(s,bt(Y,t))}f=!1},s.onblur=()=>{if(this.isCreating=1,0===s.innerText.trim().length)n.removeChild(s),this.input=null,this.isCreating=0,this.pdfViewer.customs.isAnnotToolKept&&!this.pdfViewer.customs.isAnnotToolKept(It)&&t.pdfViewer.getStateHandlerManager().switchTo();else{const r=s.getBoundingClientRect();a.right=a.left+r.width,a.bottom=a.top+r.height;const i={type:"freetext",intent:"FreeTextTypewriter",rect:e.reverseDeviceRect(a,t.scale,t.getRotation()),contents:s.innerText.trim(),rotation:((360-90*e.getRotation()-t.getRotation())%360+360)%360,flags:4,borderInfo:{width:0},subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Typewriter")};if(p.length>0){let t=u.defaultAppearance.textColor,e=u.defaultAppearance.textSize;i.defaultAppearance={font:{name:p},textColor:t||255,textSize:e||12}}e.addAnnot(i).then((e=>{n.removeChild(s);const r=e[0],i=t.annotsRender.getAnnotRender(r.getId()).component;i.$textInput.get(0).blur(),t.pdfViewer.eventEmitter.emit(Et.addAnnotSuccess,i.annot),this.isCreating=0}))}}};t.getPDFPage().then((e=>{if(e.isVirtual())return-1;const n=t.scale,i=t.rotate,o=e.getDeviceMatrix(i);return o.scale(n,n),e.getAnnotObjectNumAtDevicePoint([r.x,r.y],1,[o.a,o.b,o.c,o.d,o.e,o.f])})).then((e=>{if(-1!==e){if("freetext"==t.page.getAnnotsSync([e])[0].getType())return t.annotsRender.activeAnnot(e,0,1)}this.pdfViewer.killFocus(),t.page?i(t.page):t.getPDFPage().then(i)}))}))},r.destroyPageHandler=function(){this.hammer&&this.hammer.destroy(),this.removeTouchStartListener(),this.pageRender.$handler.removeClass("fv__create-stamp-state-handler "+this.cursorStyle),this.input&&this.input.blur()},r.out=function(){t.prototype.out.call(this)},n}(lt);const{CreateFreeTextCalloutService:Lt}=r.creation,{stateHandler:kt,ViewerEvents:Vt,CalloutShape:Ht}=r,{getDevicePagePoint:Ot}=(kt.IStateHandler,kt.StateHandlerUtils),{Hammer:Nt,jQuery:Ut}=r.vendors,{getClientX:jt,getClientY:Ft,CalloutPointsReviser:Bt}=r.shared,{STATE_HANDLER_CREATE_FREETEXT_CALLOUT:$t}=kt.StateHandlerConsts;let Yt=function(t){function r(e){var n;return(n=t.call(this,e)||this).cursorStyle="fv__cursor-typewriter",n}e(r,t),r.getStateName=function(){return $t};var i=r.prototype;return i.pageHandler=function(t){this.pageRender=t;let e=t.$handler;e.addClass("fv__create-callout-state-handler "+this.cursorStyle),e.on("mousemove",(t=>{if(this.startAdding){let e=n.getBoundingClientRect();const r=jt(t)-e.left,i=Ft(t)-e.top;this.service.update({x:r,y:i})}}));let n=e[0],r=this.hammer=new Nt.Manager(n,{recognizers:[[Nt.Pan,{direction:Nt.DIRECTION_ALL}],[Nt.Tap]]});const i=e=>{this.service.complete().then((e=>(this.startAdding=0,lt.edit(t,e)))).then((t=>{this.pdfViewer.eventEmitter.once("editingFreeText",(()=>{!function(t){document.body.removeChild(t)}(e)}))})).catch((t=>{}))};r.on("tap",(e=>{if(this.startAdding){this.pdfViewer.killFocus();let t=Xt();setTimeout((()=>{i(t)}),100)}else{this.service||(this.service=new Lt,this.service.prepare(t));let r=Ot(n,e);this.service.start(r),this.service.update(r),this.startAdding=1}})).on("panstart",(e=>{this.service||(this.service=new Lt,this.service.prepare(t));let r=Ot(n,e);this.service.start(r)})).on("panend",(t=>{i(Xt())})).on("panmove",(e=>{let r=n.getBoundingClientRect(),i=e.srcEvent;const o=jt(i)-r.left,a=Ft(i)-r.top;this.service.update({x:o,y:a}),this.service.annotInfo&&this.pdfViewer.eventEmitter.emit("collab-creating-op",{type:"freetext",page:t.index,points:this.service.annotInfo.calloutLinePoints,innerRect:this.service.annotInfo.innerRect,rect:this.service.annotInfo.rect})}))},i.destroyPageHandler=function(){var t,e;null==(t=this.service)||null==(e=t.calloutShape)||e.hide(),this.startAdding=0,this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass("fv__create-callout-state-handler "+this.cursorStyle),this.service&&(this.service.calloutShape.hide(),this.startAdding=0,this.service.destroy()),this.pdfViewer.eventEmitter.emit("collab-creating-op",{cancle:1,page:this.pageRender.index})},i.out=function(){this.destroyPageHandler()},i.addAnnot=function(t){let e=this.pageRender,r=e.pdfViewer;return e.getPDFPage().then((r=>{const i=this.pdfViewer.getDefaultAnnotConfig()("freetext","FreeTextTextbox");let o=n({},{type:"freetext",intent:"FreeTextCallout",subject:"FreeTextCallout","interior-color":16777215,rotation:((360-90*r.getRotation()-e.getRotation())%360+360)%360,flags:4,subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Callout")},t,i);return r.addAnnot(o)})).then((t=>{const n=t[0],i=e.annotsRender.getAnnotRender(n.getId()).component;return r.eventEmitter.emit(Vt.addAnnotSuccess,i.annot),lt.edit(e,t)}))},r}(lt);function Xt(){let t=document.createElement("input");return t.style.position="fixed",t.style.left="-9999px",t.style.top="-9999px",t.style.width="1px",t.style.height="1px",document.body.appendChild(t),t.focus(),t}const{stateHandler:zt,ViewerEvents:Gt}=r,{getDevicePagePoint:qt}=(zt.IStateHandler,zt.StateHandlerUtils),{Hammer:Wt}=r.vendors,{STATE_HANDLER_CREATE_FREETEXT_BOX:Kt}=zt.StateHandlerConsts;let Jt=function(t){function r(e){var n;return(n=t.call(this,e)||this).cursorStyle="fv__cursor-typewriter",n}e(r,t),r.getStateName=function(){return Kt};var i=r.prototype;return i.pageHandler=function(t){this.pageRender=t;let e=t.$handler;e.addClass("fv__create-stamp-state-handler "+this.cursorStyle);let r=e[0];(this.hammer=new Wt.Manager(r,{recognizers:[[Wt.Tap]]})).on("tap",(e=>{let i=function(){let t=document.createElement("input");return t.style.position="fixed",t.style.left="-9999px",t.style.top="-9999px",t.style.width="1px",t.style.height="1px",document.body.appendChild(t),t.focus(),t}(),o=qt(r,e),a=t.pdfViewer;return t.getPDFPage().then((e=>{const r=t.getScale(),i=t.getRotation();let a=100*r*4/3,s=20*r*2/3,c={left:o.x,right:o.x+a,top:o.y-s,bottom:o.y+s};const u=this.pdfViewer.getDefaultAnnotConfig()("freetext","FreeTextTextbox");let l=16777215;void 0!==u.fillColor&&(l=u.fillColor);let h=e.reverseDeviceRect(c,r,i);const d=u.borderInfo;if(d&&d.style===pt){const t=2===d.cloudIntensity?14.25:6;h={left:h.left-t,right:h.right+t,top:h.top+t,bottom:h.bottom-t}}let f=n({type:"freetext",rect:h,"interior-color":l,rotation:((360-90*e.getRotation()-i)%360+360)%360,flags:4,subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Textbox")},u);return e.addAnnot(f)})).then((e=>{const n=e[0],r=t.annotsRender.getAnnotRender(n.getId()).component;return a.eventEmitter.emit(Gt.addAnnotSuccess,r.annot),lt.edit(t,e)})).then((t=>{this.pdfViewer.eventEmitter.once("editingFreeText",(()=>{!function(t){document.body.removeChild(t)}(i)})),a.getStateHandlerManager().switchTo()}))}))},i.destroyPageHandler=function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass("fv__create-stamp-state-handler "+this.cursorStyle),this.__removeHandlerMouseEvent__&&this.__removeHandlerMouseEvent__()},i.out=function(){this.destroyPageHandler()},r}(lt);let Zt=function(){function t(t){this.component=t,this.prepared=!1}var e=t.prototype;return e.prepare=function(){this.prepared||(this.prepared=!0,this.doPrepare())},e.doPrepare=function(){},e.show=function(){this.prepared&&this.doShow()},e.doShow=function(){},e.hide=function(){this.prepared&&this.doHide()},e.doHide=function(){},e.destroy=function(){this.component=null,this.prepared=!1},e.willRender=function(){},e.afterRender=function(){},e.render=function(t,e,n){return this.prepared||this.prepare(),this.doRender(t,e,n)},e.doRender=function(t,e){return Promise.resolve()},e.numberToRGBAString=function(t){const e=(0,St.convertFromNumberToRGBA)(t);return`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`},e.invisibleRender=function(){},t}();function Qt(t){return Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qt(t)}function te(t){var e=function(t,e){if("object"!==Qt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Qt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Qt(e)?e:String(e)}function ee(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,te(r.key),r)}}function ne(t,e,n){return e&&ee(t.prototype,e),n&&ee(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}const re="vertical",ie="horizontal";let oe=function(){function t(t,e){this.fromInchRate=t,this.name=e,Object.defineProperties(this,{fromInchRate:{value:t,enumerable:!0,writable:!1,configurable:!0},name:{value:e,enumerable:!0,writable:!1,configurable:!0}})}var e=t.prototype;return e.convertTo=function(t,e){return t/this.fromInchRate*e.fromInchRate},e.convertAreaTo=function(t,e){return t/Math.pow(this.fromInchRate,2)*Math.pow(e.fromInchRate,2)},ne(t,[{key:"isPixel",get:function(){return!1}}]),t}(),ae=function(t){function n(e){var n;return(n=t.call(this,0,"px")||this).orientation=e,Object.defineProperty(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(n),"fromInchRate",{get(){const t=(0,St.getDPI)();switch(e){case ie:return t.x;case re:return t.y;default:return t.x}}}),n}return e(n,t),ne(n,[{key:"isPixel",get:function(){return!0}}]),n}(oe);var se={inch:"inch",custom:"custom",mi:"mi",pt:"pt",ft:"ft",yd:"yd",km:"km",m:"m",cm:"cm",mm:"mm",pica:"pica"};const ce=new oe(1,se.inch),ue=new oe(1,se.custom),le=new oe(1/63360,se.mi),he=new oe(72,se.pt),de=new oe(1/12,se.ft),fe=new oe(1/36,se.yd),pe=new oe(.0254/1e3,se.km),ge=new oe(.0254,se.m),me=new oe(2.54,se.cm),ve=new oe(25.4,se.mm),ye=new oe(6,se.pica),we=new ae(ie),Se=(new ae(re),{[ce.name]:ce,[ue.name]:ue,[le.name]:le,[he.name]:he,[de.name]:de,[fe.name]:fe,[pe.name]:pe,[ge.name]:ge,[me.name]:me,[ve.name]:ve,[ye.name]:ye,[we.name]:we});function Ae(t){switch(t=(t=t.toLowerCase()).replace(/[^a-z]/g,"")){case"in":t="inch";break;case"p":t="pica"}return Se[t]}let xe=function(t){function r(e){return t.call(this,e)||this}e(r,t);var i=r.prototype;return i.prepare=function(){this.prepared||(this.canvas=document.createElement("canvas"),this.container=this.component.getContainerElement(),this.container.appendChild(this.canvas),t.prototype.prepare.call(this))},i.destroy=function(){t.prototype.destroy.call(this),this.prepared&&this.canvas.remove()},i.doShow=function(){this.canvas.classList.remove("fv__ui-hide")},i.doHide=function(){this.canvas.classList.add("fv__ui-hide")},i.convertPointToPixel=function(t,e=1){return he.convertTo(t,we)*e},i.willRender=function(){this.canvas.style.willChange="left, top, width, height",this.container.style.willChange="left; top"},i.afterRender=function(){this.canvas.style.willChange="auto",this.container.style.willChange="auto"},i.render=function(t,e){this.prepared||this.prepare();const r=this.component.getRenderingData(t,e);if(!r)return Promise.resolve();const i=r.annotInfo,o=i.borderInfo||{},a=this.convertPointToPixel(o.width,t),s=r.smartScale;!r.annotFlag.checkNoZoom()||(t=1);const c=r.rect,u=r.outerDeviceRect,l=r.innerDeviceRect;n(l,{width:l.right-l.left,height:l.bottom-l.top}),n(u,{width:u.right-u.left,height:u.bottom-u.top}),this.resetCanvasSize(u.width,u.height),this.container.style.cssText+=`\n            left: ${c.left}px;\n            top: ${c.top}px;\n        `;let h=this.canvas.style;if(0===a&&0===i.borderColor&&!i.fillColor)return h.visibility="hidden",Promise.resolve();if(0===i.opacity)return h.visibility="hidden",Promise.resolve();h.visibility="unset";try{return Promise.resolve(this.doRender({outerRect:u,innerRect:l,deviceRect:c,scale:t,smartScale:s,rotate:e,renderingData:r}))}catch(t){return console.error(t),Promise.resolve()}},i.doRender=function({outerRect:t,innerRect:e,deviceRect:n,scale:r,rotate:i}){},i.resetCanvasSize=function(t,e){this.canvas.width=Math.ceil(t),this.canvas.height=Math.ceil(e),this.canvas.style.width=null,this.canvas.style.height=null},i.invisibleRender=function(){this.canvas&&(this.canvas.width=0)},r}(Zt);const be=0,Re=1,Ee=2,Te=3,Pe=5,Ce="LineArrow",_e="LineDimension",Ie={0:"None",1:"Square",2:"Circle",3:"Diamond",4:"OpenArrow",5:"ClosedArrow",6:"Butt",7:"ROpenArrow",8:"RClosedArrow",9:"Slash"},De=Object.keys(Ie).reduce(((t,e)=>(t[Ie[e]]=Number(e),t)),{}),Me=0,Le=1;Promise.resolve();let ke=function(){function t(t,e){this.x=t,this.y=e}var e=t.prototype;return e.add=function(e,n){return new t(this.x+e,this.y+n)},e.addp=function(e){return new t(this.x+e.x,this.y+e.y)},e.subtractp=function(e){return new t(this.x-e.x,this.y-e.y)},e.subtract=function(e,n){return new t(this.x-e,this.y-n)},e.move=function(e,n){const r=n.x-this.x,i=n.y-this.y,o=e/Math.sqrt(r*r+i*i);return new t(this.x+r*o,this.y+i*o)},e.rotate=function(e,n){const r=this.x-n.x,i=this.y-n.y,o=Math.sqrt(r*r+i*i),a=Math.atan2(i,r)-e,s=o*Math.cos(a),c=o*Math.sin(a);return new t(n.x+s,n.y+c)},e.distanceTo=function(t){const e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},e.slope=function(t){const e=this._dot(t);return Math.acos(e/(this._disp()*t._disp()))},e._dot=function(t){return this.x*t.x+this.y*t.y},e._disp=function(){return Math.sqrt(this._dot(this))},e.equalTo=function(e,n=0){return n=Math.abs(n),e instanceof t&&Math.abs(this.x-e.x)<=n&&Math.abs(this.y-e.y)<=n},e.clone=function(){return new t(this.x,this.y)},t}(),Ve=function(){function t(){this.segments=[]}var e=t.prototype;return e.addSegment=function(t){t instanceof He&&this.segments.push(t)},e.render=function(t){t.beginPath(),this.segments.forEach((e=>{e.render(t)})),t.closePath()},t}(),He=function(){function t(t,e){this.from=t,this.to=e}var e=t.prototype;return e.render=function(t){(0,St.notImplemented)()},e.isJoinedBefore=function(t){return this.to.equalTo(t.from)},e.isJoinedAfter=function(t){return t.to.equalTo(this.from)},e.isJoinedWith=function(t){return this.isJoinedBefore(t)||this.isJoinedAfter(t)},t}(),Oe=function(){function t(){}return t.prototype.generate=function(){(0,St.notImplemented)()},t}();function Ne(t,e,n){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var r=e.length;return function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}(e,void 0!==n&&n<r?n:r)}return t(e,n)}let Ue=function(t){function n(e,n,r){var i;return(i=t.call(this,null,r)||this).controlPoint1=e,i.controlPoint2=n,i}return e(n,t),n.prototype.render=function(t){t.bezierCurveTo(this.controlPoint1.x,this.controlPoint1.y,this.controlPoint2.x,this.controlPoint2.y,this.to.x,this.to.y)},n}(He),je=function(t){function n(e){return t.call(this,e)||this}return e(n,t),n.prototype.render=function(t){t.moveTo(this.from.x,this.from.y)},n}(He);const Fe=.5522847498308,Be=3.14159265358979;let $e=function(t){function n(e,n,r){var i;return(i=t.call(this)||this).points=e,i.innerRect=n,i.outerRect=r,i}return e(n,t),n.prototype.generate=function(t=4,e,n){const r=new Ve,i=this.points.map((t=>{const e=this.innerRect.height-t.y;return new ke(t.x,e)})),o=i.length;n||(n=o*t);const a=i.map(((t,e)=>t.distanceTo(i[(e+1)%o]))).reduce(((t,e)=>t+e));let s={left:i[0].x,right:i[0].x,top:i[0].y,bottom:i[0].y},c=a/n;if(0==c)return r;const u=[];let l=0,h=i[0],d=i[1],f=h.distanceTo(d);for(let t=0,e=1;t<n;t++){for(;l>f;)l-=f,e++,h=d,d=i[e%o],f=h.distanceTo(d);u.push(h.move(l,d)),l+=c}const p=u.length;let g=!0,m=5*c/8;return u.forEach(((t,e)=>{const n=function(t,e,n){const r=t.subtractp(e),i=n.subtractp(e),o=[];let a=Math.atan2(r.y,r.x),s=Math.atan2(i.y,i.x);a+=Math.acos(t.distanceTo(e)/(2*m))-Be/9,s-=Math.acos(n.distanceTo(e)/(2*m)),s<a&&(s+=2*Be);let c={left:e.x-m,right:e.x+m,bottom:e.y-m,top:e.y+m},u=Ye(c,a,s,g);o.push.apply(o,Ne(Y,u.arrAp)),g=!1;const l=e.subtractp(n);return a=Math.atan2(l.y,l.x),a+=Math.acos(n.distanceTo(e)/(2*m)),s=a-Be/9,c={left:n.x-m,right:n.x+m,bottom:n.y-m,top:n.y+m},u=Ye(c,a,s,g),o.push.apply(o,Ne(Y,u.arrAp)),o}(u[0==e?p-1:e-1],t,u[(e+1)%p]);n.forEach((t=>{const e=t=>{if(t)return new ke(t.x+this.innerRect.left-this.outerRect.left,this.innerRect.height-t.y+(this.innerRect.top-this.outerRect.top))};t.from=e(t.from),t.to=e(t.to),t.controlPoint1=e(t.controlPoint1),t.controlPoint2=e(t.controlPoint2),r.addSegment(t)}))})),r.rect=s,r},n}(Oe);function Ye(t,e,n,r){var i,o,a,s,c,u,l,h,d,f,p,g,m,v,y,w,S,A,x,b,R,E,T,P,C={};if(t.left>=t.right||t.bottom>=t.top)return{arrAp:[],pdfRect:C};if(Math.abs(n-e)<=1e-4)return{arrAp:[],pdfRect:C};var _=[];i=(t.right+t.left)/2,o=(t.top+t.bottom)/2,a=Math.abs(t.right-t.left)/2,s=Math.abs(t.top-t.bottom)/2,T=e,R=i+(p=a*Math.cos(T)),E=o+(g=s*Math.sin(T)),C.left=C.right=R,C.bottom=C.top=E,r&&_.push(new je(new ke(R,E)));var I=1;n<e&&(I=-1);var D=Math.floor(2*e/Be);I>0&&(D+=1),D*=Be/2;for(var M=!1;P=D,I>0?n<=D&&(P=n,M=!0):n>=D&&(P=n,M=!0),p=a*Math.cos(T),g=s*Math.sin(T),S=a*Math.cos(P),d=f=-a*a*s*s,m=p+(R=(x=((l=a*a*g)*f-(h=a*a*(A=s*Math.sin(P)))*d)/((c=s*s*p)*h-(u=s*s*S)*l))-p)*Fe,v=g+(E=(b=(u*d-c*f)/(c*h-u*l))-g)*Fe,y=S+(R=x-S)*Fe,w=A+(E=b-A)*Fe,m=R=i+m,v=E=o+v,C.left>m&&(C.left=m),C.bottom>v&&(C.bottom=v),C.right<m&&(C.right=m),C.top<v&&(C.top=v),y=R=i+y,w=E=o+w,C.left>y&&(C.left=y),C.bottom>w&&(C.bottom=w),C.right<y&&(C.right=y),C.top<w&&(C.top=w),S=R=i+S,A=E=o+A,C.left>S&&(C.left=S),C.bottom>A&&(C.bottom=A),C.right<S&&(C.right=S),C.top<A&&(C.top=A),_.push(new Ue(new ke(m,v),new ke(y,w),new ke(S,A))),!M;)T=P,D+=I*Be/2;return{arrAp:_,pdfRect:C}}let Xe=function(t=0,e=t,n=t,r=e){this.top=t,this.left=e,this.bottom=n,this.right=r},ze=function(){function t(t){this.offsetLeft=0,this.offsetTop=0,this.offsetRight=0,this.offsetBottom=0,this.target=t}t.isOverlap=function(t,e,n=!1){let r=Math.max(t.left,e.left),i=Math[n?"min":"max"](t.top,e.top),o=Math[n?"max":"min"](t.bottom,e.bottom),a=Math.min(t.right,e.right);if(r<=a)if(n){if(i>=o)return(a-r)*(i-o)}else if(i<=o)return(a-r)*(o-i);return 0},t.isInRect=function(t,e,n,r=!1){if(t>=n.left&&t<=n.right)if(r){if(e>=n.bottom&&e<=n.top)return!0}else if(e<=n.bottom&&e>=n.top)return!0;return!1},t.rectInRect=function(t,e,n=!1){return!!(t.left>=e.left&&t.right<=e.right)&&(n?t.top<=e.top&&t.bottom>=e.bottom:t.top>=e.top&&t.bottom<=e.bottom)},t.on=function(e){return new t(e)},t.subtract=function(t,e){return new Xe(t.top-e.top,t.left-e.left,t.bottom-e.bottom,t.right-e.right)},t.expandOffset=function(t,e){return new Xe(t.top-e.top,t.left-e.left,e.bottom-t.bottom,e.right-t.right)},t.copyTo=function(t,e){e.left=t.left,e.top=t.top,e.right=t.right,e.bottom=t.bottom};var e=t.prototype;return e.moveLeft=function(t){return this.offsetLeft+=t,this.offsetRight+=t,this},e.moveTop=function(t){return this.offsetTop+=t,this.offsetBottom+=t,this},e.move=function(t,e){return this.moveLeft(t).moveTop(e)},e.moveTo=function(t,e){return this.offsetLeft=this.offsetRight=this.target.left-t,this.offsetTop=this.offsetBottom=this.target.top-e,this},e.shrink=function(t=0,e=t,n=t,r=e){return this.add(new Xe(t,e,-n,-r))},e.expand=function(t=0,e=t,n=t,r=e){return this.add(new Xe(-t,-e,n,r))},e.zoom=function(t=1,e="center",n="center"){const r=this.target.right+this.offsetRight-(this.target.left+this.offsetLeft),i=this.target.bottom+this.offsetBottom-(this.target.top+this.offsetTop),o=r*t-r,a=i*t-i;let s=0,c=0,u=0,l=0;switch(e){case"right":s=-o;break;case"center":s=-o/2,c=o/2;break;default:c=o}switch(n){case"bottom":u=-a;break;case"center":u=-a/2,l=a/2;break;default:l=a}return this.add(new Xe(u,s,l,c))},e.add=function({top:t=0,left:e=t,bottom:n=t,right:r=e}={}){return this.offsetLeft+=e,this.offsetRight+=r,this.offsetBottom+=n,this.offsetTop+=t,this},e.extract=function(){const t=this.target.left+this.offsetLeft,e=this.target.right+this.offsetRight;return{left:t,top:this.target.top+this.offsetTop,right:e,bottom:this.target.bottom+this.offsetBottom}},e.boundary=function(){const t=this.target.left+this.offsetLeft,e=this.target.right+this.offsetRight,n=this.target.top+this.offsetTop;return{left:t,top:n,width:e-t,height:this.target.bottom+this.offsetBottom-n}},e.intersect=function(e){e instanceof t||(e=t.on(e));const n=this.toPlainObject(),r=e.toPlainObject(),i={left:Math.max(n.left,r.left),right:Math.min(n.right,r.right),top:Math.max(n.top,r.top),bottom:Math.min(n.bottom,r.bottom)};return t.on(i)},e.toPlainObject=function(){return{left:this.target.left+this.offsetLeft,right:this.target.right+this.offsetRight,top:this.target.top+this.offsetTop,bottom:this.target.bottom+this.offsetBottom}},t}(),Ge=function(t){function r(){return t.apply(this,arguments)||this}e(r,t);var i=r.prototype;return i.doPrepare=function(){t.prototype.doPrepare.call(this),this.canvas.classList.add("fv__viewer-render-square-canvas")},i.doRender=function(t,e=!0){const n=t.renderingData.annotInfo,r=n.borderInfo||{},i=this.convertPointToPixel(r.width||1,t.scale),o=this.canvas.getContext("2d");if(o.clearRect(0,0,this.canvas.width,this.canvas.height),o.save(),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){t.lineWidth=i,e&&(o.globalAlpha=n.opacity),0===i||!1===n.hasBorderColor?o.strokeStyle="transparent":o.strokeStyle=this.numberToRGBAString(n.color),o.lineWidth=i;try{switch(r.style){case Te:case Ee:case be:this.renderSolid(o,n,t);break;case Re:this.renderDashed(o,n,t);break;case Pe:this.renderCloud(o,n,t)}const e=n.fillColor;e&&(o.fillStyle=this.numberToRGBAString(e),o.fill()),o.stroke()}finally{o.restore()}}},i.shrinkRect=function(t,e){const r=ze.on(t).shrink(e).extract();return n(r,{width:r.right-r.left,height:r.bottom-r.top})},i.renderCloud=function(t,e,n){e.fillColor;const r=e.borderInfo.cloudIntensity,i=this.shrinkRect(n.innerRect,0),o=this.shrinkRect(n.outerRect,0),a=i.width,s=i.height;new $e([new ke(0,s),new ke(a,s),new ke(a,0),new ke(0,0)],i,o).generate(32/3/r).render(t)},i.renderDashed=function(t,e,n){const r=e.borderInfo,i=r.dashes||[],o=r.dashPhase||0,a=n.scale;t.save(),t.setLineDash&&t.setLineDash(i.map((t=>this.convertPointToPixel(t,a)))),t.lineDashOffset=this.convertPointToPixel(o,a),this.renderSolid(t,e,n)},i.renderSolid=function(t,e,n){const r=n.lineWidth,i=n.innerRect,o=n.outerRect,a=i.width,s=i.height,c=.5*r,u=i.left-o.left,l=i.top-o.top;t.beginPath(),t.rect(c+u,c+l,a-r,s-r),t.closePath()},r}(xe);a(5847);var qe={invisible:1,hidden:2,print:4,noZoom:8,noRotate:16,noView:32,readOnly:64,locked:128,toggleNoView:256,lockedContents:512};var We=function(){function t(t){this.flag=t}var e=t.prototype;return e.getValue=function(){return this.flag},e.checkInvisible=function(){return(this.flag&qe.invisible)===qe.invisible},e.checkHidden=function(){return(this.flag&qe.hidden)===qe.hidden},e.checkPrint=function(){return(this.flag&qe.print)===qe.print},e.checkNoZoom=function(){return(this.flag&qe.noZoom)===qe.noZoom},e.checkNoRotate=function(){return(this.flag&qe.noRotate)===qe.noRotate},e.checkNoView=function(){return(this.flag&qe.noView)===qe.noView},e.checkReadOnly=function(){return(this.flag&qe.readOnly)===qe.readOnly},e.checkLocked=function(){return(this.flag&qe.locked)===qe.locked},e.checkToggleNoView=function(){return(this.flag&qe.toggleNoView)===qe.toggleNoView},e.checkLockedContents=function(){return(this.flag&qe.lockedContents)===qe.lockedContents},e.check=function(t){return(this.flag&t)===t},e.or=function(t){return this.flag=this.flag|t,this},t}();var Ke=n({jrLicenseSuccess:"jr-license-success",srLicenseSuccess:"sr-license-success",beforeOpenFile:"before-open-file",openingFile:"opening-file",beforeLoadPDFDoc:"before-load-pdf-document",openFileSuccess:"open-file-success",openFileFailed:"open-file-failed",willCloseDocument:"will-close-document",renderFileSuccess:"render-file-success",renderFileFailed:"render-file-error",beforeRenderPage:"before-render-page",renderPageSuccess:"render-page-success",updateZoomMode:"update-zoom-mode",beforeZoomTo:"before-zoom-to",zoomToSuccess:"zoom-to-success",zoomToFailed:"zoom-to-failed",startChangeViewMode:"start-change-view-mode",changeViewModeSuccess:"change-view-mode-success",changeViewModeFailed:"change-view-mode-failed",pagesLayoutRedrawBegin:"pages-layout-redraw-begin",pageLayoutRedraw:"page-layout-redraw",pagesLayoutRedrawEnd:"pages-layout-redraw-end",copyTextSuccess:"copy-text-success",copyTextFailed:"copy-text-failed",tapPage:"tap-page",tapAnnotation:"tap-annotation",pressPage:"press-page",pressAnnotation:"press-annotation",pressText:"press-text",rightClickPage:"right-click-page",rightClickAnnotation:"right-click-annotation",doubleTapPage:"double-tap-page",doubleTapAnnotation:"double-tap-annotation",activeAnnotationBefore:"active-annotation-before",activeAnnotation:"active-annotation",activeAnnotationAfter:"active-annotation-after",panActiveAnnotation:"pan-active-annotation",doubleTapActiveAnnotation:"double-tap-active-annotation",contextMenuActiveAnnotation:"contextmenu-action-annotation",unActiveAnnotation:"unactive-annotation",updateActiveAnnotation:"update-action-annotation",updateActionAnnotation:"update-action-annotation",removeActiveAnnotationBefore:"remove-action-annotation-before",removeActionAnnotationBefore:"remove-action-annotation-before",removeActiveAnnotationSuccess:"remove-action-annotation-success",removeActionAnnotationSuccess:"remove-action-annotation-success",removeActiveAnnotationFailed:"remove-action-annotation-failed",removeActionAnnotationFailed:"remove-action-annotation-failed",beforeSwitchStateHandler:"before-switch-state-handler",switchStateHandler:"switch-state-handler",deactiveStateHandler:"deactive-state-handler",redactAnnotAllApplyed:"applyed-all-redaction",redactAnnotApplyed:"applyed-redaction",pageNumberChange:"page-number-change",beforeDocumentRotation:"before-document-rotation",afterDocumentRotation:"after-document-rotation",snapModeChanged:"snap-mode-changed",createPageAreaRenderer:"create-page-area-renderer",destroyPageAreaRenderer:"destroy-page-area-renderer",startUpdatePageAreaRenderer:"start-update-page-area-renderer",createSnapshotArea:"create-snapshot-area",updateSnapshotArea:"update-snapshot-area",stabilizedSnapshotArea:"stabilized-snapshot-area",switchPageAreaRenderer:"switch-page-area-renderer",fitWidthResizeViewport:"fit-width-resize-viewport",signatureFieldMouseLButtonDown:"signature-field-Lbutton-down",signatureFieldMouseLButtonUp:"signature-field-LButton-up",signatureFieldMouseEnter:"signature-field-mouse-enter",signatureFieldMouseExit:"signature-field-mouse-exit",visiblePagesRenderCompleted:"completed-render-visible-pages",marqueeZoomIn:"marquee-zoom-in",marqueeZoomOut:"marquee-zoom-out",inkSignAdded:"inkSign-added",inkSignDeleted:"inkSign-deleted",onlineSignAdded:"onlineSign-added",onlineSignDeleted:"onlineSign-deleted",pageMoved:"page-moved",pageRemoved:"page-removed",pageAdded:"page-added",customDataAdd:"custom-data-add",customDataImported:"custom-data-imported",customDataRemoved:"custom-data-removed",customDataUpdated:"custom-data-updated",distanceAnnotCreationStart:"distance-creation-start",perimeterAnnotCreationStart:"perimeter-creation-start",updateDistanceAnnot:"update-distance-annot",distanceAnnotCreationEnd:"distance-creation-end",distanceAnnotCreationCancel:"distance-creation-cancel",addEditImage:"add-edit-image",InkImageSelected:"ink-image-selected",OnlineImageSelected:"online-image-selected",checkTheSearch:"check-the-search",activeElementChanged:"active-element-changed",cancelCreatingDistance:"cancel-creating-measurement",completeCreatingDistance:"complete-creating-measurement",eraserSuccess:"eraser-success",addAnnotSuccess:"add-annot-success",cancelAddAnnot:"cancel-add-annot",globalAnnotFlagChanged:"global-annot-flag-changed",toolbarTabsClicked:"toolbar-tabs-clicked",sideBarChanged:"sidebar-changed",showWhatsNew:"show-whats-new",disableScroll:"disable-scroll",enableScroll:"enable-scroll",updateScrollableStatus:"update-scrollable-status",selectText:"select-text",changeEnableJS:"change-enable-js",toggleEngineSr2JrSuccess:"toggle-engine-sr-to-jr-success",iconInited:"iconInited",iconAdded:"iconAdded",iconRemoved:"iconRemoved",annotationPermissionChanged:"annotation-premission-changed",startScrollingPage:"pdfui-start-scrolling-page",scrollingPage:"pdfui-scrolling-page",endScrollingPage:"pdfui-end-scrolling-page",designerAssistantStatusChanged:"form-designer-assistant-status-changed",mouseEnter:"mouse-enter",mouseLeave:"mouse-leave",setFromFieldHighlight:"set_form_field_highlight",AddFontMaps:"set_font_map",thumbnailClicked:"thumbnail-clicked",layerActionActived:"layer-action-actived",redeModeShowSidebar:"rede-mode-show-sidebar",gridToggle:"grid-toggle",snapGridToggle:"snap-grid-toggle",toggleCollaborationMode:"toggleCollaborationMode",findReplaceDialogVisibleChange:"find-replace-dialog-visible-change",showAllComments:"show-all-comments",hideAllComments:"hide-all-comments",focusOnControl:"focus-on-control",blurFromObject:"blur-from-object",documentWillPrint:"document-will-print",documentDidPrint:"document-did-print",documentWillSave:"document-will-save",documentDidSave:"document-did-save",verifyDocSignatureEvent:"verify-doc-signature",verifySignatureEvent:"verify-signature",clearSignatureEvent:"clear-signature",viewSignedVersionDocEvent:"view-signed-version",showFieldPropertiesEvent:"show-field-properties",showSignatureVerifyInfoEvent:"show-signature-tusted-info",compareSignedVersionEvent:"compare-signed-version",showCompareSignedVersionResultEvent:"show-compare-signed-version-result",createInkSignSuccess:"createInkSignSuccess",galleryCreateStamp:"galleryCreateStamp",switchGalleryTabActive:"switchGalleryTabActive",mangeStampInner:"mangeStampInner",tapField:"tap-field",tapGraphicsObject:"tap-graphics-object",spawnPageSuccess:" spawn-page-success",progressChanged:"progress-changed",togglePageContextMenu:"toggle-page-contextmenu"},{annotationUpdated:"annotation-updated",annotationIDUpdated:"annotation-id-updated",annotationAppearanceUpdated:"annotation-appearance-updated",annotationReplyAdd:"annotation-reply-add",annotationReplyAdded:"annotation-reply-add",annotationReviewStateAnnotAdd:"annotation-review-state-annot-add",annotationReviewStateAnnotAdded:"annotation-review-state-annot-add",annotationMarkedStateAnnotAdd:"annotation-marked-state-annot-add",annotationMarkedStateAnnotAdded:"annotation-marked-state-annot-add",annotationStatesCleared:"annotation-states-cleared",annotationRemoved:"annotation-removed",annotationMovedPosition:"annotation-moved-position",annotationPositionMoved:"annotation-moved-position",annotationAdded:"annotation-add",annotationAdd:"annotation-add",moveAnnotsToPages:"moveAnnotsToPages",annotationImported:"annotation-imported",annotationImportedEx:"annotation-imported-ex",annotationLoaded:"annotation-loaded",actionUpdated:"action-updated",actionAdd:"action-add",actionAdded:"action-add",actionRemove:"action-remove",actionRemoved:"action-remove",layerVisibleChange:"layer-visible-change",layerVisibleChanged:"layer-visible-change",layerRemoved:"layer-removed",layerMerged:"layer-merged",bookmarkAdded:"bookmark-added",structureBookmarkAdded:"structure-bookmark-added",bookmarkUpdated:"bookmark-updated",bookmarkRemoved:"bookmark-removed",stateAnnotNameUpdated:"state-annot-name-updated",pageInfoChange:"page-info-change",pageInfoChanged:"page-info-change",pageRotationChange:"page-rotation-change",pageRotationChanged:"page-rotation-change",imageAdded:"image-added",watermarkAdded:"watermark-added",watermarkRemoved:"watermark-removed",graphicsUpdated:"graphics-updated",permissionChanged:"permission-changed",docPasswordChanged:"doc-password-changed",drmEncryptSuccess:"drm-encrypt-success",drmEncryptSucceeded:"drm-encrypt-success",drmEncryptFailed:"drm-encrypt-failed",removePwdAndPerm:"remove-password-and-permission",pwdAndPermRemoved:"remove-password-and-permission",securityTypeChanged:"security-type-changed",pageMoved:"page-moved",pageRemoved:"page-removed",pageAdded:"page-added",insertPages:"import-pages",pagesInserted:"import-pages",importPages:"import-pages",documentAttachmentAdd:"document-attachment-add",docAttachmentAdded:"document-attachment-add",documentAttachmentModify:"document-attachment-modify",docAttachmentModified:"document-attachment-modify",documentAttachmentRemove:"document-attachment-remove",docAttachmentRemoved:"document-attachment-remove",applyRedaction:"apply-redaction",redactionApplied:"apply-redaction",removeReviewState:"remove-review-state",reviewStateRemoved:"remove-review-state",removeMarkedState:"remove-marked-state",markedStateRemoved:"remove-marked-state",formValueChanged:"form-value-changed",metaDataChanged:"meta-data-changed",docModified:"doc-modified",flattened:"flattened",headerFooterUpdated:"headerFooterUpdated",headerFooterAdded:"headerFooterAdded",COChange:"COChange",COChanged:"COChange",pagesReversed:"pages-reversed",pagesMoved:"pages-moved",pagesRemoved:"pages-removed",pagesRotated:"pages-rotated",pageMeasureScaleRatioChanged:" page-measure-scale-ratio-changed",obtainsPageFromEngine:"obtains-page-from-engine",pagesBoxChange:"pages-box-changed",pagesBoxChanged:"pages-box-changed",pagesLabelChange:"pages-label-change",pagesLabelChanged:"pages-label-change",pagesLabelNeedUpdate:"pages-label-need-change",pagesLabelNeedUpdated:"pages-label-need-change",pagesReplace:"pages-replace",pagesReplaced:"pages-replace",recognitionForm:"recognition-form",removeEmbeddedPageThumbnail:"remove-embedded-page-thumbnail",embeddedPageThumbnailRemoved:"remove-embedded-page-thumbnail",objectStartEdit:"object-start-edit",objectEndEdit:"object-end-edit",objectSelectionChanged:"object-selection-changed",objectAdded:"object-added",objectPropertyChanged:"object-property-changed",paragraphTextOnActivate:"paragraph-text-on-activate",paragraphTextOnDeactivate:"paragraph-text-on-deactivate",paragraphTextEnterEdit:"paragraph-text-enter-edit",paragraphTextExitEdit:"paragraph-text-exit-edit",paragraphTextOnChar:"paragraph-text-on-char",articleThreadAdded:"article-thread-added",articleThreadUpdated:"article-thread-updated",articleThreadRemoved:"article-thread-removed",articleBeadAdded:"article-bead-added",articleBeadRemoved:"article-bead-removed",articleBeadUpdated:"article-bead-updated",articleEnterReadMode:"article-enter-read-mode",articleOutReadMode:"article-out-read-mode",signChinaNoApply:"sign-china-no-apply",signChinaFlowNoApply:"sign-china-flow-no-apply",signChinaLegalNoticeConfirm:"sign-china-legal-notice-confirm",invalidRect:"invalidRect",formReloaded:"formReloaded"});let Je;function Ze(t){return function(){if(!Je){const t=(0,St.getDPI)();Je=[t.x,t.y]}return Je}()[t]}function Qe(t,e=0){return t*Ze(e)/72}let tn=function(t){function r(){return t.apply(this,arguments)||this}e(r,t);var i=r.prototype;return i.getTileConfig=function(t=this.scale,e=this.rotate){const n=this.pdfViewer.getSmartScale(t),r=this.pdfViewer.config.tileSize,i=this.page.getDeviceRect(this.pdfRect,1,e),o=this.page.getDeviceRect(this.pdfRect,n,e),a=o.right-o.left,s=o.bottom-o.bottom;return[Math.ceil(s/r),Math.ceil(a/r),a,s,r,n,t,e,i.left,i.top]},i.getRenderingData=function(e=this.scale,r=this.rotate){return n(t.prototype.getRenderingData.call(this,e,r),{opacity:this.annotationInfo.opacity,tileConfig:this.getTileConfig(e,r)})},r}(function(){function t(t){this.pdfRect={left:0,right:0,top:0,bottom:0},this.deviceRect={left:0,right:0,top:0,bottom:0},this.annotationInfo=this.getDefaultAnnotInfo(),this.eContainer=document.createElement("div"),this.eContainer.classList.add("fv__viewer-fake-annot-container"),this.pdfViewer=t.pdfViewer,this.pageRender=t.pageRender,this.intent=t.info.intent,(0,St.extendOptions)(this.annotationInfo,t.info,this.getDefaultAnnotConfig()),this.annotationInfo.type=this.getType(),this.page=t.pageRender.page,this.scale=t.pageRender.scale,this.rotate=t.pageRender.rotate,this.pageRender.$annotsContainer.append(this.eContainer)}var e=t.prototype;return e.setRect=function(t){this.deviceRect=t;let e=Math.abs(t.right-t.left),n=Math.abs(t.bottom-t.top);const r=Qe(this.annotationInfo.borderInfo.width)*this.scale*2;if(e<r){const n=.5*(r-e)*(t.right-t.left>0?1:-1);t.right+=n,t.left-=n}if(n<r){const e=.5*(r-n)*(t.bottom-t.top>0?1:-1);t.top-=e,t.bottom+=e}e=Math.abs(t.right-t.left),n=Math.abs(t.bottom-t.top);const i=this.pageRender.rotate;this.pdfRect=this.page.reverseDeviceRect(t,this.scale,i),(0,St.cssText)(this.eContainer,{left:t.left+"px",top:t.left+"px",width:e+"px",height:n+"px"})},e.setContent=function(t){this.annotationInfo.content=t,this.annotationInfo.contents=t},e.zoomTo=function(t){this.scale=t},e.draw=function(){this.renderer||(this.renderer=this.generateApRenderer(),this.renderer.prepare(),this.renderer.willRender()),this.renderer.component&&this.renderer.render(this.scale,this.rotate)},e.getContainerElement=function(){return this.eContainer},e.getRenderingData=function(t=this.scale,e=this.rotate){const n=this.pdfViewer.getSmartScale(t),r=this.getDeviceRect(t,e),i=this.getOuterDeviceRect(t,e),o=this.getDeviceRect(n,e);return{annotInfo:this.annotationInfo,annotFlag:new We(this.annotationInfo.flags),smartScale:n,rect:i,outerDeviceRect:i,innerDeviceRect:r,engineRenderingRect:o,scale:t,rotate:e,page:this.page}},e.getDeviceRect=function(t,e){return this.page.getDeviceRect(this.pdfRect,t,e)},e.getOuterDeviceRect=function(t,e){const n=this.annotationInfo.borderInfo;if(n&&5===n.style){const n=this.pageRender.getContainerVisibleRect(),r=n.right-n.left,i=n.bottom-n.top,o=this.page.getDeviceRect(this.pdfRect,t,e),a=(r-(o.right-o.left))/2,s=(i-(o.bottom-o.top))/2;return{left:o.left-a,right:o.right+a,top:o.top-s,bottom:o.bottom+s}}return this.page.getDeviceRect(this.pdfRect,t,e)},e.apply=function(){var t;null===(t=this.renderer)||void 0===t||t.afterRender();const e=this.getCreationJSON();return e.endingStyle&&(e.endStyle=e.endingStyle,delete e.endingStyle),e.rect=this.pdfRect,this.page.addAnnot(e).then((t=>{const e=this.pdfViewer.addEventListener("renderAnnotSuccess",(()=>{this.destroy(),e()})),n=t[0];return this.pageRender.annotsRender.activeAnnot(n.getId()),this.pdfViewer.eventEmitter.emit(Ke.addAnnotSuccess,n),t}))},e.destroy=function(){var t;null===(t=this.renderer)||void 0===t||t.destroy(),this.getContainerElement().remove()},e.getCreationJSON=function(){return this.annotationInfo},e.getDefaultAnnotInfo=function(){return{borderInfo:{width:2,style:be},color:16711680,opacity:1,flags:4,date:new Date}},e.getDefaultAnnotConfig=function(){const t=this.pdfViewer.getDefaultAnnotConfig();return"function"==typeof t?t(this.getType(),this.getIntent()):{}},e.getIntent=function(){return this.intent},t}()),en=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var r=n.prototype;return r.getType=function(){return"square"},r.generateApRenderer=function(){return new Ge(this)},n}(tn),nn=function(t){function r(){return t.apply(this,arguments)||this}e(r,t);var i=r.prototype;return i.doRender=function(t){const e=t.renderingData.annotInfo,n=e.borderInfo||{},r=this.convertPointToPixel(n.width||1,t.scale);if(0==r&&-1==e.borderColor&&!e.fillColor)return;const i=this.canvas.getContext("2d");if(i.clearRect(0,0,this.canvas.width,this.canvas.height),i.save(),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){t.lineWidth=r,i.globalAlpha=e.opacity,0===r||!1===e.hasBorderColor?i.strokeStyle="transparent":i.strokeStyle=this.numberToRGBAString(e.color),i.lineWidth=r;try{switch(n.style){case be:this.renderSolid(i,e,t);break;case Te:break;case Re:this.renderDashed(i,e,t);break;case Pe:0==n.cloudIntensity?this.renderSolid(i,e,t):this.renderCloud(i,e,t)}const r=e.fillColor;r&&(i.fillStyle=this.numberToRGBAString(r),i.fill()),i.stroke(),this.setContents(i,e.contents,t)}finally{i.restore()}}},i.renderSolid=function(t,e,n){this.renderDashed(t,e,n)},i.renderDashed=function(t,e,n){const r=e.borderInfo,i=n.lineWidth,o=n.innerRect,a=n.outerRect,s=r.dashes||[],c=r.dashPhase||0,u=.5*i,l=new ke(.5*(o.left+o.right)-a.left,.5*(o.top+o.bottom)-a.top),h=Math.abs(.5*o.height-u),d=Math.abs(.5*o.width-u);t.lineDashOffset=c,t.setLineDash&&t.setLineDash(s),t.beginPath(),function(t,e,n,r,i,o=0,a=0,s=2*Math.PI,c=!0){t.ellipse?t.ellipse(e,n,r,i,o,a,s,c):(t.save(),t.translate(e,n),t.rotate(o),t.scale(r,i),t.arc(0,0,1,a,s,c),t.restore())}(t,l.x,l.y,d,h),t.closePath()},i.renderCloud=function(t,e,n){const r=e.borderInfo.cloudIntensity,i=.5*n.lineWidth,o=this.shrinkRect(n.innerRect,i),a=this.shrinkRect(n.outerRect,i),s=new ke(.5*(a.right-a.left)-(o.left-a.left),.5*(a.bottom-a.top)-(o.top-a.top)),c=.5*o.height-i,u=.5*o.width-i,l=16/r,h=Math.PI/l,d=2*Math.PI,f=Array(Math.floor(d/h)-1).fill(0).map(((t,e)=>e*h%d)).map((t=>{const e=u*Math.cos(d-t),n=c*Math.sin(d-t);return s.add(e,n)}));new $e(f,o,a).generate(1,t).render(t)},i.shrinkRect=function(t,e){const r=ze.on(t).shrink(e).extract();return n(r,{width:r.right-r.left,height:r.bottom-r.top})},i.setContents=function(t,e,n){if(void 0===e)return;const{innerRect:r,outerRect:i}=n,o=.5*(r.left+r.right)-i.left,a=.5*(r.top+r.bottom)-i.top,s=t;s.beginPath(),s.font="14px Verdana",s.textAlign="left",s.textBaseline="top",s.direction="ltr";var c=s.measureText(e).width;s.fillStyle="#AF6B6B",s.fillText(e,o-c/2,a-7,c),s.closePath()},r}(xe);var rn,on=a(5602),an=a.n(on);function sn(){}!function(t){t.MEASUREMENT="measurement",t.COMPARISON="comparison",t.STAMP="stamp",t.SIGN_CERTIFY="sign-certify",t.SIGNATURE="signature"}(rn||(rn={}));var cn=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};const un="measurement-info",ln={userSpaceUnit:ce,userSpaceScaleValue:1,realUnit:ce,realScaleValue:1,caption:"",markup:!0},hn="measurementInfo";let dn=function(t){function r(){return t.apply(this,arguments)||this}e(r,t),r.inject=function(){return{pdfViewer:an()}};var i=r.prototype;return i.allInjected=function(){this.pdfViewer.store.dispatch(hn,ln),this.getStorage().get(rn.MEASUREMENT,un).then((t=>{this.isDestroyed||t&&(this.pdfViewer.getStore().dispatch(hn,n({},this.convertFromRaw(t))),this.addDestroyHook(this.pdfViewer.store.subscribe(hn,(t=>{if(!this.isDestroyed)return this.updateMeasurementInfo(t)}))))})),this.addDestroyHook(this.getStorage().onChange((t=>{t.context.feature===rn.MEASUREMENT&&this.pdfViewer.store.dispatch(hn,this.convertFromRaw(t.newValue))})),this.pdfViewer.addEventListener(Ke.pageNumberChange,(()=>cn(this,void 0,void 0,(function*(){if(this.isDestroyed)return;const t=this.getStorage(),e=yield t.get(rn.MEASUREMENT,un);yield t.set(rn.MEASUREMENT,un,e)})))))},i.updateMeasurementInfo=function(t){return cn(this,void 0,void 0,(function*(){const e=n(n({},yield this.getMeasurementInfo()),t),r=this.convertToRaw(e);yield this.getStorage().set(rn.MEASUREMENT,un,r)}))},i.getMeasurementInfo=function(){return this.pdfViewer.store.getCurrentValue(hn)},i.onMeasurementInfoChange=function(t){return this.pdfViewer.store.subscribe(hn,t)||sn},i.getStorage=function(){return this.pdfViewer.getStorage()},i.convertFromRaw=function(t={}){return"object"!=typeof t?n({},ln):{userSpaceUnit:t.userSpaceUnit?new oe(t.userSpaceUnit.fromInchRate,t.userSpaceUnit.name):ce,userSpaceScaleValue:null==t.userSpaceScaleValue?1:t.userSpaceScaleValue,realUnit:t.realUnit?new oe(t.realUnit.fromInchRate,t.realUnit.name):ce,realScaleValue:null==t.realScaleValue?1:t.realScaleValue,caption:t.caption||"",markup:!1!==t.markup}},i.convertToRaw=function(t){return{userSpaceUnit:t.userSpaceUnit?{fromInchRate:t.userSpaceUnit.fromInchRate,name:t.userSpaceUnit.name}:ln.userSpaceUnit,userSpaceScaleValue:t.userSpaceScaleValue||ln.userSpaceScaleValue,realUnit:t.realUnit?{fromInchRate:t.realUnit.fromInchRate,name:t.realUnit.name}:ln.realUnit,realScaleValue:t.realScaleValue||ln.realScaleValue,caption:t.caption||ln.caption,markup:void 0===t.markup?ln.markup:t.markup}},i.isSame=function(t,e){return JSON.stringify(this.convertToRaw(t))===JSON.stringify(this.convertToRaw(e))},r}(St.Disposable);const fn=t=>{{const e=t.getIoC().getInstanceByClass(dn).getMeasurementInfo();return e.markup&&e.caption?e.caption+"\n":""}},pn=t=>({markup:t.getIoC().getInstanceByClass(dn).getMeasurementInfo().markup}),gn=t=>{for(let e=t.length-1;e>=0;e--){t[e].destroy(),t.splice(e,1)}return[]},mn=(t,e,r)=>{const i=t.getRenderingData(e,r);!i.annotFlag.checkNoZoom()||(e=1);const o=i.outerDeviceRect,a=i.innerDeviceRect;return n(a,{width:a.right-a.left,height:a.bottom-a.top}),n(o,{width:o.right-o.left,height:o.bottom-o.top}),{renderingData:i,innerRect:a,outerRect:o,scale:e,rotate:r}},vn=(t,e)=>{const n=t.canvas,r=n.width,i=n.height;let{x:o,y:a}=e;o-=4,a-=4,o=Math.max(o,2),a=Math.max(a,2),o+8>r&&(o=r-8-2),a+8>i&&(a=i-8-2),t.rotate(0),t.fillStyle="#ffffff",t.rect(o,a,8,8),t.stroke(),t.fill()};let yn=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var r=n.prototype;return r.getType=function(){return"circle"},r.generateApRenderer=function(){return new nn(this)},r.apply=function(){return t.prototype.apply.call(this).then((t=>"CircleDimension"===this.annotationInfo.intent?this.page.getMeasureScaleRatio().then((e=>{if(e&&e.scale){const e=this.pdfViewer.getStore().getCurrentValue("measurementData"),n=fn(this.pdfViewer),r=Ae(e.displayUnit.name)?this.pdfViewer.i18n.t(`measurement.units.${e.displayUnit.name}`):e.displayUnit.name;return t[0].setContent(n+parseFloat(e.area).toFixed(2)+" sq "+r).then((e=>t))}return t})):t))},n}(tn);const{stateHandler:wn,ViewerEvents:Sn}=r,An=wn.IStateHandler,{getDevicePagePoint:xn}=wn.StateHandlerUtils,{keyboardStatus:bn}=r.shared,{BuiltinCommand:Rn,BuiltinShortcutContext:En}=r.keyboard;let Tn=function(t){function n(e,n){var r;return(r=t.call(this,e)||this).type=n,r.cursorStyle="fv__cursor-crosshair",r}e(n,t);var r=n.prototype;return r.pageHandler=function(t){this.pageRender=t;const e=t.$handler;e.addClass(this.cursorStyle);const n=e.get(0),r=this.hammer=new Hammer.Manager(n);r.add(new Hammer.Pan({direction:Hammer.DIRECTION_ALL}));let i,o=!1;const a=this.pdfViewer.getKeyboard();let s=()=>{};a.withContext(En.CREATING_ANNOTATION,(t=>{t.keyup(Rn.CANCEL_CREATING_ANNOTATION_OPERATION,(()=>{this.cancel(),o=!0,s()}),{interceptors:[(t,e)=>{o||e(t)}]})})),r.on("panstart",(t=>{s=a.activeContext(En.CREATING_ANNOTATION),o=!1,i=n.getBoundingClientRect(),this.startPoint=xn(n,t),this.start({left:this.startPoint.x,top:this.startPoint.y})})),r.on("panmove",(t=>{if(o)return;const e=n.getBoundingClientRect(),r=e.left-i.left,a=e.top-i.top,s=this.correctPosition({x:this.startPoint.x+t.deltaX-r,y:this.startPoint.y+t.deltaY-a});return this.currentPoint=s,this.adjust(this.currentFakeAnnot,this.startPoint,s)})),r.on("panend",(t=>{if(s(),o)return;const e=n.getBoundingClientRect(),r=e.left-i.left,a=e.top-i.top,c=this.correctPosition({x:this.startPoint.x+t.deltaX-r,y:this.startPoint.y+t.deltaY-a});this.currentPoint=c,this.end(this.currentFakeAnnot,this.startPoint,c),i=null})),r.on("pancancel",(t=>{if(s(),!o)return i=null,this.pdfViewer.eventEmitter.emit("collab-creating-op",{cancle:1,page:this.pageRender.index}),this.end(this.currentFakeAnnot,this.startPoint,this.currentPoint)})),this.removeZoomToSuccessEvent=this.pdfViewer.addEventListener(Sn.zoomToSuccess,(t=>{!o&&this.currentFakeAnnot&&(this.currentFakeAnnot.zoomTo(t),this.currentFakeAnnot.draw())}))},r.correctPosition=function(t){const e=this.pageRender.getShowWidth(),n=this.pageRender.getShowHeight();return{x:Math.max(0,Math.min(e,t.x)),y:Math.max(0,Math.min(n,t.y))}},r.getSubject=function(){switch(this.type){case"circle":return this.pdfViewer.i18n.t("viewer_:annotSubjects.Oval");case"square":return this.pdfViewer.i18n.t("viewer_:annotSubjects.Rectangle")}return""},r.start=function({left:t,top:e}){const n={flags:4,subject:this.getSubject()};switch(this.type){case"circle":this.currentFakeAnnot=new yn({pdfViewer:this.pdfViewer,pageRender:this.pageRender,info:n});break;case"square":this.currentFakeAnnot=new en({pdfViewer:this.pdfViewer,pageRender:this.pageRender,info:n});break;case"square-crop":this.currentFakeAnnot=new en({pdfViewer:this.pdfViewer,pageRender:this.pageRender,info:{flags:4,subject:this.getSubject(),borderInfo:{width:1},color:255}});break;default:throw new Error("Will never happen")}this.currentFakeAnnot.setRect({left:t,top:e,right:t+10,bottom:e-10})},r.adjust=function(t,{x:e,y:n},{x:r,y:i}){let o,a,s=Math.abs(e-r),c=Math.abs(n-i);bn.isShift?(s=c=Math.min(s,c),o=r<e?e-s:e,a=i<n?n-c:n):(o=Math.min(e,r),a=Math.min(n,i)),s=Math.max(s,1),c=Math.max(c,1),t.setRect({left:o,top:a,right:o+s,bottom:a+c}),t.draw()},r.end=function(t,e,n){this.currentFakeAnnot.apply().then((t=>{if(!this.pdfViewer.config.showCommentList)return;const e=t[0];this.pageRender.annotsRender.getAnnotRender(e.getId()).component.showReplyDialog()})),this.currentFakeAnnot=null},r.cancel=function(){this.currentFakeAnnot&&(this.currentFakeAnnot.destroy(),this.currentFakeAnnot=null),this.pdfViewer.eventEmitter.emit("collab-creating-op",{cancle:1,page:this.pageRender.index})},r.currentPointDirection=function(){const t=this.startPoint.x,e=this.startPoint.y,n=this.currentPoint.x,r=this.currentPoint.y;return n<=t?r<e?"north-west":"south-west":r<e?"north-east":"south-east"},r.destroyPageHandler=function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle),this.offCancelEvent&&this.offCancelEvent(),this.removeZoomToSuccessEvent&&this.removeZoomToSuccessEvent()},r.out=function(){this.destroyPageHandler()},n}(An);const Pn=r.stateHandler,{STATE_HANDLER_CREATE_SQUARE:Cn}=Pn.StateHandlerConsts;let _n=function(t){function n(e){return t.call(this,e,"square")||this}return e(n,t),n.getStateName=function(){return Cn},n}(Tn);const In=r.stateHandler,{STATE_HANDLER_CREATE_CIRCLE:Dn}=In.StateHandlerConsts;let Mn=function(t){function n(e){return t.call(this,e,"circle")||this}return e(n,t),n.getStateName=function(){return Dn},n}(Tn);const Ln=r.vendors.EventEmitter;let kn=function(t){function n(e){var n;return(n=t.call(this)||this).pdfViewer=e,n.eventEmitter=new Ln,n.addDestroyHook((()=>{n.eventEmitter.removeAllListeners()})),n.isLocked=!1,n.isStarted=!1,n}e(n,t);var r=n.prototype;return r.init=function(){},r.start=function(){this.isStarted=!0},r.cancel=function(){this.isStarted=!1},r.emit=function(t,e){this.isLocked||this.eventEmitter.emit(t,e)},r.on=function(t,e){return this.eventEmitter.on(t,e),()=>{this.eventEmitter.off(t,e)}},r.lock=function(){this.isLocked=!0},r.unlock=function(){this.isLocked=!1},n}(St.Disposable),Vn=function(t){function n(e,n,r){var i;return(i=t.call(this,e)||this).target=n,i.hammer=new Hammer.Manager(n),i.hammer.add(new Hammer.Pan(r)),i.addDestroyHook((()=>{i.hammer.destroy()})),i}return e(n,t),n.prototype.init=function(){let t,e,n=0,r=0;const i=i=>o=>{if("start"===i){e=o.target;const n=e.getBoundingClientRect();t={left:n.left,top:n.top}}this.eventEmitter.emit(i,{deltaX:o.deltaX-n,deltaY:o.deltaY-r,srcEvent:o.srcEvent}),"end"!==i&&"cancel"!==i||(e=null,n=0,r=0)};this.hammer.on("panstart",i("start")),this.hammer.on("panmove",i("move")),this.hammer.on("panend",i("end")),this.hammer.on("pancancel",i("cancel"));const o=i=>{if(!e)return;const o=e.getBoundingClientRect();n=o.left-t.left,r=o.top-t.top};window.addEventListener("scroll",o,!0),this.addDestroyHook((()=>{window.removeEventListener("scroll",o,!0)}));const a=t=>{const e=this.target.getBoundingClientRect(),n=t.clientX-e.left,r=t.clientY-e.top;this.eventEmitter.emit("mousemove",{x:n,y:r})};this.target.addEventListener("mousemove",a,!0),this.addDestroyHook((()=>{this.target.removeEventListener("mousemove",a,!0)}))},n}(kn);const Hn=4.396;let On=function(){function t(t){this.component=t}var e=t.prototype;return e.numberToRGBAString=function(t){if("string"==typeof t)return t;const e=(0,St.convertFromNumberToRGBA)(t);return`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`},e.renderLineEnd=function(t,e,n,r,i,o){if(0===r)return;const a=n.renderingData;let s=a.fillColor;"line"===a.annotInfo.type&&(s=a.annotInfo.styleFillColor);const c=n.scale,u=Math.atan2(o.y-i.y,o.x-i.x);switch(t.save(),t.lineJoin="miter",t.beginPath(),r){case De.Square:this.renderSquareEnding(t,o,u,c,e);break;case De.Circle:this.renderCircleEnding(t,o,u,c,e);break;case De.Diamond:this.renderDiamondEnding(t,o,u,c,e);break;case De.OpenArrow:o=o.move(e/2,i),this.renderOpenArrowEnding(t,o,u,c,e);break;case De.ClosedArrow:o=o.move(e/2,i),this.renderClosedArrowEnding(t,o,u,c,e);break;case De.Butt:this.renderButtEnding(t,o,u,c,e);break;case De.ROpenArrow:this.renderROpenArrowEnding(t,o,u,c,e);break;case De.RClosedArrow:this.renderRClosedArrowEnding(t,o,u,c,e);break;case De.Slash:this.renderSlashEnding(t,o,u,c,e)}switch(r){case De.ClosedArrow:case De.RClosedArrow:case De.Diamond:case De.Square:case De.Circle:s&&(t.fillStyle=this.numberToRGBAString(s),t.fill())}t.stroke(),t.restore()},e.renderSquareEnding=function(t,e,n,r,i){const o=Hn*r+3.1*i,a=o/2;t.translate(e.x,e.y),t.rotate(n),t.moveTo(-a,-a),t.rect(-a,-a,o,o)},e.renderCircleEnding=function(t,e,n,r,i){const o=1.75862*r+2*i;t.translate(e.x,e.y),t.rotate(n),t.moveTo(o,0),t.arc(0,0,o,0,2*Math.PI)},e.renderDiamondEnding=function(t,e,n,r,i){const o=Hn*r+3.1*i,a=o/2;t.translate(e.x,e.y),t.rotate(n+Math.PI/4),t.moveTo(-a,-a),t.rect(-a,-a,o,o)},e.renderOpenArrowEnding=function(t,e,n,r,i){const o=30/180*Math.PI;this.renderArrow(t,e,n,r,i,o,!1)},e.renderClosedArrowEnding=function(t,e,n,r,i){const o=30/180*Math.PI;this.renderArrow(t,e,n,r,i,o,!0)},e.renderButtEnding=function(t,e,n,r,i){const o=Math.PI/2,a=Hn*r+3.1*i,s=new ke(e.x+a/2,e.y).rotate(Math.PI-n+o,e),c=s.rotate(Math.PI,e);t.moveTo(s.x,s.y),t.lineTo(c.x,c.y)},e.renderROpenArrowEnding=function(t,e,n,r,i){const o=150/180*Math.PI;this.renderArrow(t,e,n,r,i,o,!1)},e.renderRClosedArrowEnding=function(t,e,n,r,i){const o=150/180*Math.PI;this.renderArrow(t,e,n,r,i,o,!0)},e.renderArrow=function(t,e,n,r,i,o,a=!1){const s=Hn*r+3.1*i,c=new ke(e.x+s,e.y),u=c.rotate(Math.PI-n+o,e),l=c.rotate(Math.PI-n-o,e);t.moveTo(u.x,u.y),t.lineTo(e.x,e.y),t.lineTo(l.x,l.y),a&&t.closePath()},e.renderSlashEnding=function(t,e,n,r,i){const o=60/180*Math.PI,a=Hn*r+3.1*i,s=new ke(e.x+a/2,e.y).rotate(Math.PI-n+o,e),c=s.rotate(Math.PI,e);t.moveTo(s.x,s.y),t.lineTo(c.x,c.y)},t}();const Nn=Math.log(2);let Un=function(t){function n(e){var n;return(n=t.call(this,e)||this).helper=new On(e),n}e(n,t);var r=n.prototype;return r.doRender=function(t){const e=t.renderingData,n=e.page,r=e.annotInfo,i=r.borderInfo||{},o=t.scale,a=t.rotate,s=this.convertPointToPixel(i.width,o);if(0==s&&-1==r.borderColor&&!r.fillColor)return;const c=this.canvas.getContext("2d");if(c.clearRect(0,0,this.canvas.width,this.canvas.height),c.save(),this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent())return;t.lineWidth=s,c.globalAlpha=r.opacity,c.lineWidth=s,0===s||!1===r.hasBorderColor?c.strokeStyle="transparent":c.strokeStyle=this.numberToRGBAString(r.color);const u=t.outerRect;let l=this.convertToPathPoint(e.startPoint,o,u,n,a),h=this.convertToPathPoint(e.endPoint,o,u,n,a);const d=e.leaderLinePoints;let f=this.convertToPathPoint(d.start,o,u,n,a),p=this.convertToPathPoint(d.end,o,u,n,a);if(e.leaderLineOffset>0){const t=e.annotInfo.leaderLineLength>0?1:-1,n=this.convertPointToPixel(e.leaderLineOffset,o);let r=l.move(n,h).rotate(t*Math.PI/2,l);h=h.move(n,l).rotate(t*-Math.PI/2,h),l=r,r=f.move(n,p).rotate(t*Math.PI/2,f),p=p.move(n,f).rotate(t*-Math.PI/2,p),f=r}const g=e.captionOffset,m=new ke(this.convertPointToPixel(g.x,o),-this.convertPointToPixel(g.y,o)),v=this.convertPointToPixel(e.leaderLineExtend,o);try{if(i.style===Re){const t=i.dashes||[],e=i.dashPhase||0;c.setLineDash&&c.setLineDash(t.map((t=>this.convertPointToPixel(t,o)))),c.lineDashOffset=this.convertPointToPixel(e,o)}c.beginPath(),this.renderLine(c,l,h,f,p,v),c.closePath(),c.stroke(),this.helper.renderLineEnd(c,s,t,e.startStyle,p,f),this.helper.renderLineEnd(c,s,t,e.endingStyle,f,p),this.renderLineCaption(c,t,s,f,p,m)}finally{c.restore()}},r.convertToPathPoint=function(t,e,n,r,i=0){const[o,a]=r.getDevicePoint([t.x,t.y],e,i);return new ke(o-n.left,a-n.top)},r.renderLine=function(t,e,n,r,i,o){if(t.moveTo(r.x,r.y),t.lineTo(i.x,i.y),t.moveTo(e.x,e.y),t.lineTo(r.x,r.y),t.moveTo(n.x,n.y),t.lineTo(i.x,i.y),o>0){const a=r.move(-o,e),s=i.move(-o,n);t.moveTo(r.x,r.y),t.lineTo(a.x,a.y),t.moveTo(i.x,i.y),t.lineTo(s.x,s.y),t.moveTo(s.x,s.y)}},r.renderLineCaption=function(t,e,n,r,i,o){const a=e.renderingData,s=e.scale,c=a.annotInfo;let u=c.content;if("string"!=typeof u)return;if(u=u.trim(),u.length<1)return;let l=Math.atan2(i.y-r.y,i.x-r.x);const h=r.distanceTo(i),d=r.move(.5*h,i),f=16*(p=s+1,Math.log(p)/Nn);var p;const g=16777215-(16777215&c.borderColor^10855845);let m;t.save(),t.fillStyle=this.numberToRGBAString(g),t.font=f+"px bold Arial",t.textBaseline="middle",t.textAlign="center";const v=t.measureText(u),y=v.actualBoundingBoxAscent+v.actualBoundingBoxDescent;let w=d.move(o.y,r).rotate(Math.PI/2,d),S=Math.PI/2;switch(S=o.y>0?-Math.PI/2:Math.PI/2,a.captionPos){case Me:if(0!=o.y&&0!=o.x){m=w.move(o.x,d).rotate(S,w);break}m=w;break;case Le:const t=d.move(.5*(n+y)-o.y,i).rotate(Math.PI/2,d);m=0!=o.x?t.move(o.x,d).rotate(S,w):t}if(a.hasCaption&&(t.translate(m.x,m.y),t.rotate(l),t.fillText(u,0,0),t.restore()),t.beginPath(),Math.abs(o.x)<h/2+v.width/2&&Math.abs(o.y)<y)return;let A=o.x>0?-1:1,x=o.x+A*v.width/2;if(Math.abs(o.x)<=v.width/2){x=0;let t=y/2+4;const e=o.y>0?1:-1;let n=0;Math.abs(o.y)>y&&(n=o.y-e*t),w=d.move(n,r).rotate(Math.PI/2,d)}const b=w.move(x,d).rotate(S,w),R=b.move(Math.abs(x)+n/2,w);t.moveTo(d.x,d.y),t.lineTo(w.x,w.y),t.moveTo(R.x,R.y),t.lineTo(b.x,b.y),t.moveTo(b.x,b.y),t.closePath(),t.stroke()},r.setMarkUp=function(t,e){const n=mn(this.component,t,e),{renderingData:r,outerRect:i}=n;t=n.scale,e=n.rotate;const o=r.page,a=r.annotInfo,s=a.borderInfo||{},c=this.convertPointToPixel(s.width,t),u=this.canvas.getContext("2d");u.clearRect(0,0,this.canvas.width,this.canvas.height),u.save(),u.lineWidth=c,u.strokeStyle=this.numberToRGBAString(a.color);let l=this.convertToPathPoint(r.startPoint,t,i,o,e),h=this.convertToPathPoint(r.endPoint,t,i,o,e);const d=r.leaderLinePoints;let f=this.convertToPathPoint(d.start,t,i,o,e),p=this.convertToPathPoint(d.end,t,i,o,e);if(r.leaderLineOffset>0){const e=r.annotInfo.leaderLineLength>0?1:-1,n=this.convertPointToPixel(r.leaderLineOffset,t);let i=l.move(n,h).rotate(e*Math.PI/2,l);h=h.move(n,l).rotate(e*-Math.PI/2,h),l=i,i=f.move(n,p).rotate(e*Math.PI/2,f),p=p.move(n,f).rotate(e*-Math.PI/2,p),f=i}const g=this.convertPointToPixel(r.leaderLineExtend,t);u.beginPath(),this.renderLine(u,l,h,f,p,g),u.closePath(),vn(u,l),vn(u,h)},n}(xe);const jn=De;let Fn=function(t){function r(e){var n;const r=(n=t.call(this,e)||this).annotationInfo;switch(n.annotationInfo.endStyle&&(r.endingStyle=n.annotationInfo.endStyle),r.intent){case Ce:r.endingStyle===jn.None&&(r.endingStyle=jn.OpenArrow);break;case _e:r.startStyle===jn.None&&(r.startStyle=jn.OpenArrow),r.endingStyle===jn.None&&(r.endingStyle=jn.OpenArrow)}return r.hasCaption=r.enableCaption,r.leaderLinePoints.start=r.startPoint,n}e(r,t);var i=r.prototype;return i.setRect=function(t){this.deviceRect=t;let e=Math.abs(t.right-t.left),n=Math.abs(t.bottom-t.top);e=Math.abs(t.right-t.left),n=Math.abs(t.bottom-t.top);const r=this.pageRender.rotate;this.pdfRect=this.page.reverseDeviceRect(t,this.scale,r),this.eContainer.style.cssText+=`\n            width: ${e}px;\n            height: ${n}px;\n        `},i.generateApRenderer=function(){return new Un(this)},i.getType=function(){return"line"},i.getStartPoint=function(){return this.annotationInfo.startPoint},i.getEndPoint=function(){return this.annotationInfo.endPoint},i.setEndPoint=function(t){const[e,n]=this.page.reverseDevicePoint([t.x,t.y],this.scale,this.rotate);this.annotationInfo.endPoint={x:e,y:n},this.annotationInfo.leaderLinePoints.end=this.annotationInfo.endPoint;const{x:r,y:i}=this.annotationInfo.startPoint,[o,a]=this.page.getDevicePoint([r,i],this.scale,this.rotate);this.setRect({left:o,top:a,right:t.x,bottom:t.y}),this.annotationInfo.intent==_e&&this.calculateLeaderLinePoints()},i.calculateLeaderLinePoints=function(){let t=this.getStartPoint(),e=this.getEndPoint(),n=e.y-t.y,r=e.x-t.x,i=-1/(n/r),o=Math.atan(i),a=t.y<=e.y?1:-1,s=this.annotationInfo.leaderLineLength,c=a*Math.cos(o)*s,u=a*Math.sin(o)*s,l={x:t.x+c,y:t.y+u},h=e,d=this.pdfRect;d.left<l.x&&l.x<d.right&&d.bottom<l.y&&l.y<d.top?h={x:e.x+c,y:e.y+u}:(l={x:t.x-c,y:t.y-u},h={x:e.x-c,y:e.y-u}),this.annotationInfo.leaderLinePoints.start=l,this.annotationInfo.leaderLinePoints.end=h},i.getRenderingData=function(){return n(n({},t.prototype.getRenderingData.call(this)),this.annotationInfo)},i.getOuterDeviceRect=function(t,e){const{start:n}=this.annotationInfo.leaderLinePoints,r=this.annotationInfo.startPoint,i=this.annotationInfo.leaderLineExtend,o=this.annotationInfo.borderInfo.width,a=he.convertTo(o,we)*this.scale,s=Math.max(Math.abs(n.x-r.x),Math.abs(n.y-r.y))+i,c=he.convertTo(s,we)*this.scale;return ze.on(this.getDeviceRect(t,e)).expand(c+a).extract()},i.getDefaultAnnotInfo=function(){const e={x:0,y:0},r={x:0,y:0};return n(n({},t.prototype.getDefaultAnnotInfo.call(this)),{startPoint:e,endPoint:r,leaderLineLength:15,leaderLineExtend:5,captionOffset:{x:0,y:0},enableCaption:!1,leaderLinePoints:{start:e,end:r},leaderLineOffset:0,captionPos:Me,content:"",startStyle:gt,endingStyle:gt})},i.apply=function(){return t.prototype.apply.call(this).then((t=>"LineDimension"===this.annotationInfo.intent?this.page.getMeasureScaleRatio().then((e=>{if(e&&e.scale){const e=this.pdfViewer.getStore().getCurrentValue("measurementData"),n=fn(this.pdfViewer),r=Ae(e.displayUnit.name)?this.pdfViewer.i18n.t(`measurement.units.${e.displayUnit.name}`):e.displayUnit.name;return t[0].setContent(n+parseFloat(e.distance).toFixed(2)+" "+r).then((e=>t))}return t})):t))},r}(tn);var Bn;!function(t){t.EndPoint="end-point",t.MidPoint="mid-point",t.IntersectionPoint="intersection-point",t.NearestPoint="nearest-point"}(Bn||(Bn={}));let $n=function(){function t(){}return t.prototype.render=function(t){const e=t.canvas,n=e.width;e.height=e.height,t.clearRect(0,0,n,n),t.strokeStyle="red",t.arc(n/2,n/2,2*Math.PI,0,360),t.stroke()},t}(),Yn=function(){function t(){}return t.prototype.render=function(t){const e=t.canvas,n=e.width;e.height=e.height,t.clearRect(0,0,n,n),t.strokeStyle="red",t.moveTo(n/2,0),t.lineTo(0,n),t.lineTo(n,n),t.closePath(),t.stroke()},t}(),Xn=function(){function t(){}return t.prototype.render=function(t){const e=t.canvas,n=e.width;e.height=e.height,t.clearRect(0,0,n,n),t.strokeStyle="red",t.rect(0,0,n,n),t.stroke()},t}(),zn=function(){function t(){}return t.prototype.render=function(t){const e=t.canvas,n=e.width;e.height=e.height,t.clearRect(0,0,n,n),t.strokeStyle="red",t.moveTo(0,0),t.lineTo(n,n),t.moveTo(0,n),t.lineTo(n,0),t.stroke()},t}(),Gn=function(t){function n(e){var n;return(n=t.call(this)||this).container=e,n.size=16,n.renderer=new $n,n.canvas=document.createElement("canvas"),n.canvas.classList.add("fv__viewer-snapped-point"),n.addDestroyHook((()=>{n.canvas.parentElement===n.container&&n.container.removeChild(n.canvas)})),n.canvas.width=n.size,n.canvas.height=n.size,n}e(n,t);var r=n.prototype;return r.setRenderer=function(t){this.renderer=new t,this.redraw()},r.setSize=function(t){this.size=t,this.canvas.width=t,this.canvas.height=t,this.redraw()},r.setPosition=function(t,e){(0,St.cssText)(this.canvas,{left:t+"px",top:e+"px",margin:`${.5*-this.size}px ${.5*-this.size}px`})},r.show=function(t){switch(this.container.appendChild(this.canvas),t){case Bn.MidPoint:this.setRenderer(Yn);break;case Bn.IntersectionPoint:this.setRenderer(zn);break;case Bn.NearestPoint:this.setRenderer(Xn);break;default:this.setRenderer($n)}},r.hide=function(){this.canvas.parentElement===this.container&&this.container.removeChild(this.canvas)},r.redraw=function(){if(!this.renderer)return;const t=this.canvas.getContext("2d");t&&this.renderer.render(t)},n}(St.Disposable);const{stateHandler:qn,ViewerEvents:Wn}=r,Kn=qn.IStateHandler,{DebouncePromiseQueue:Jn,keyboardStatus:Zn,ThrottleAsyncTaskExecutor:Qn}=r.shared,{LineEndingStyle:tr}=r.Consts,{STATE_HANDLER_CREATE_LINE:er}=qn.StateHandlerConsts,{getDevicePagePoint:nr}=qn.StateHandlerUtils,{isSamePoint:rr}=r.commons,{BuiltinCommand:ir,BuiltinShortcutContext:or}=r.keyboard;let ar=function(t){function r(e,n,r){var i;return(i=t.call(this,e)||this).startStyle=n,i.endStyle=r,i.cursorStyle="fv__cursor-crosshair",i.executor=new Qn(20),i}e(r,t),r.getStateName=function(){return er};var i=r.prototype;return i.createInteractionTool=function(t,e){return new Vn(this.pdfViewer,t,e)},i.pageHandler=function(t){this.pageRender=t;const e=t.$handler;e.addClass(this.cursorStyle);const n=e.get(0);this.snappedPointAssistant=new Gn(n);const r=this.interaction=this.createInteractionTool(n,{direction:Hammer.DIRECTION_ALL});let i;r.init();const o=()=>r.on("mousemove",(t=>{this.executor.exec((()=>this.getSnappedPoint(t).then((e=>{rr(t,e)?(this.snappedPointAssistant.hide(),i=null):(this.snappedPointAssistant.show(e.type),this.snappedPointAssistant.setPosition(e.x,e.y),i=e)}))))}));let a,s;this.offMouseMoveEvent=o();let c,u=!1;const l=this.pdfViewer.getKeyboard();let h=()=>{};l.withContext(or.CREATING_ANNOTATION,(t=>{this.offCancelEvent=t.keyup(ir.CANCEL_CREATING_ANNOTATION_OPERATION,(()=>{h(),this.cancel(),this.interaction.cancel(),u=!0}),{interceptors:[(t,e)=>{u||e(t)}]})})),r.on("start",(t=>{let e;this.offMouseMoveEvent(),h=l.activeContext(or.CREATING_ANNOTATION),u=!1;let r=[0,0];const o=nr(n,t);i?(e=[i.x,i.y],r=[o.x-i.x,o.y-i.y]):e=[o.x,o.y],a=this.pageRender.page.reverseDevicePoint(e,this.pageRender.scale,this.pageRender.getRotation()),c=this.pageRender.page.reverseDevicePoint(r,this.pageRender.scale,this.pageRender.getRotation()),this.start(a[0],a[1])})),r.on("move",(t=>{if(u)return;const[e,n]=function(t,e){if(Zn.isShift){const n=Math.sqrt(t*t+e*e),r=Math.atan2(e,t),i=.25*Math.PI,o=Math.round(r/i)*i;t=n*Math.cos(o),e=n*Math.sin(o)}return[t,e]}(t.deltaX,t.deltaY),r=this.pageRender.page.getDevicePoint(a,this.pageRender.scale,this.pageRender.getRotation()),i=this.pageRender.page.getDevicePoint(c,this.pageRender.scale,this.pageRender.getRotation()),o=[r[0]+e+i[0],r[1]+n+i[1]];this.adjust(this.fakeAnnotation,{x:o[0],y:o[1]}),s=this.pageRender.page.reverseDevicePoint(o,this.pageRender.scale,this.pageRender.getRotation());let l=this.fakeAnnotation.pdfRect,{startPoint:h,endPoint:d}=this.fakeAnnotation.annotationInfo;this.pdfViewer.eventEmitter.emit("collab-creating-op",{type:this.type,page:this.pageRender.page.getIndex(),rect:l,points:[h,d]})})),r.on("end",(t=>{if(!u)return h(),this.offMouseMoveEvent=o(),this.end()})),r.on("cancel",(t=>{u||(this.pdfViewer.eventEmitter.emit("collab-creating-op",{cancle:1,page:this.pageRender.index}),h(),this.cancel(),this.offMouseMoveEvent=o())})),this.__removeZoomToSuccessEventListener=this.pdfViewer.addEventListener(Wn.zoomToSuccess,(()=>{if(u||!this.fakeAnnotation)return;const t=this.pageRender.scale;this.fakeAnnotation.zoomTo(t),this.fakeAnnotation.draw()}))},i.correctCoord=function(t,e){const n=this.pageRender.getScale(),r=t.getPxWidth()*n,i=t.getPxHeight()*n;return[Math.max(0,Math.min(r,e[0])),Math.max(0,Math.min(i,e[1]))]},i.start=function(t,e,n="Line"){let r;r=this.pdfViewer.customs.getMeasuringConfig;let i=!0,o="";if(r){const t=r();t.hasOwnProperty("defaultLeader")&&(i=t.defaultLeader),"custom"==t.labelType&&(o=t.label)}const a=this.pdfViewer.getIoC().getInstanceByClass(dn).getMeasurementInfo();return a.showCustomLabel&&(o=a.caption),this.fakeAnnotation=new Fn({pdfViewer:this.pdfViewer,pageRender:this.pageRender,info:this.createAnnotJson({flags:4,label:o,startPoint:{x:t,y:e},endPoint:{x:t+1,y:e+1},startStyle:this.startStyle,endingStyle:this.endStyle,leaderLineLength:i?15:0,leaderLineExtend:i?5:0,subject:this.pdfViewer.i18n.t("viewer_:annotSubjects."+n)})})},i.createAnnotJson=function(t){return n(t,this.pdfViewer.getDefaultAnnotConfig()("line")),t},i.getSnappedPoint=function(t){return this.pageRender.getPDFPage().then((e=>{if(!e)return t;const n=this.pdfViewer.getSnapMode(this.constructor.getStateName());if(n&&n.length>0){const[r,i]=e.reverseDevicePoint([t.x,t.y],this.pageRender.scale,this.pageRender.rotate);return e.getSnappedPoint({x:r,y:i},n).then((t=>{const[n,r]=e.getDevicePoint([t.x,t.y],this.pageRender.scale,this.pageRender.rotate);return{x:n,y:r,type:t.type}}))}return t}))},i.adjust=function(t,e){this.executor.exec((()=>this.getSnappedPoint(e).then((n=>{rr(e,n)?this.snappedPointAssistant.hide():(this.snappedPointAssistant.setPosition(n.x,n.y),this.snappedPointAssistant.show(n.type)),t.setEndPoint(n),t.draw()}))))},i.end=function(){this.fakeAnnotation&&this.executor.waitForLastTask().then((()=>{this.snappedPointAssistant.hide();const t=this.fakeAnnotation.apply().then((t=>{if(!this.pdfViewer.config.showCommentList)return;const e=t[t.length-2];this.pageRender.annotsRender.getAnnotRender(e.getId()).component.showReplyDialog()}));return this.fakeAnnotation=null,t}))},i.cancel=function(){this.fakeAnnotation&&(this.pdfViewer.eventEmitter.emit("collab-creating-op",{cancle:1,page:this.pageRender.index}),this.snappedPointAssistant.hide(),this.executor.cancel(),this.pdfViewer.eventEmitter.emit(Wn.cancelAddAnnot),this.fakeAnnotation.destroy(),this.fakeAnnotation=null)},i.destroyPageHandler=function(){this.offMouseMoveEvent(),this.snappedPointAssistant.destroy(),this.executor.cancel(),this.interaction&&this.interaction.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle),this.offCancelEvent&&this.offCancelEvent(),this.__removeZoomToSuccessEventListener&&this.__removeZoomToSuccessEventListener()},i.out=function(){this.destroyPageHandler()},r}(Kn);const{stateHandler:sr,ViewerEvents:cr}=r,{STATE_HANDLER_CREATE_ARROW:ur}=sr.StateHandlerConsts,{LineEndingStyle:lr}=r.Consts;let hr=function(t){function r(e){return t.call(this,e,lr.None,lr.OpenArrow)||this}return e(r,t),r.getStateName=function(){return ur},r.prototype.createAnnotJson=function(t){return t.intent="LineArrow",t.subject=this.pdfViewer.i18n.t("viewer_:annotSubjects.Arrow"),n(t,this.pdfViewer.getDefaultAnnotConfig()("line","LineArrow")),t},r}(ar);a(6409);function dr(t){if("clientX"in t)return t.clientX;switch(t.type){case"touchstart":case"touchmove":return t.touches[0].clientX;case"touchend":case"touchcancel":return t.changedTouches[0].clientX}}function fr(t){if("clientY"in t)return t.clientY;switch(t.type){case"touchstart":case"touchmove":return t.touches[0].clientY;case"touchend":case"touchcancel":return t.changedTouches[0].clientY}}var pr,gr="idle",mr="construct",vr="creating";!function(t){t[t.DOWN=0]="DOWN",t[t.UP=1]="UP",t[t.MOVE=2]="MOVE"}(pr||(pr={}));const yr={[pr.DOWN]:["MSPointerDown"],[pr.MOVE]:["MSPointerMove"],[pr.UP]:["MSPointerUp"]},wr={[pr.DOWN]:["pointerdown"],[pr.MOVE]:["pointermove"],[pr.UP]:["pointerup"]},Sr={[pr.DOWN]:["pointerdown","mousedown"],[pr.MOVE]:["pointermove","mousemove"],[pr.UP]:["pointerup","mouseup"]},Ar={[pr.DOWN]:["pointerdown","touchstart"],[pr.MOVE]:["pointermove","touchmove"],[pr.UP]:["pointerup","touchend"]},xr={[pr.DOWN]:["mousedown","touchstart"],[pr.MOVE]:["mousemove","touchmove"],[pr.UP]:["mouseup","touchend"]},br={};function Rr(t,e,n,r){let i,o=0;const a=br[e].map((e=>{let s;const c=e=>{i!==e.type&&Date.now()-o<160?s():(i=e.type,r&&r.once&&s(),n.call(t,function(t){const e={native:t,altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,metaKey:t.metaKey,target:t.target,preventDefault:()=>t.preventDefault(),stopPropagation:()=>t.stopPropagation()};if(window.TouchEvent&&t instanceof window.TouchEvent){const n="touchend"===t.type||"touchcancel"===t.type?t.changedTouches[0]:t.touches[0];e.clientX=n.clientX,e.clientY=n.clientY,e.pageX=n.pageX,e.pageY=n.pageY,e.screenX=n.screenX,e.screenY=n.screenY,e.x=n.clientX,e.y=n.clientY,e.bubbles=t.bubbles,e.relatedTarget=n.target}else(t instanceof MouseEvent||t instanceof PointerEvent)&&(e.clientX=t.clientX,e.clientY=t.clientY,e.pageX=t.pageX,e.pageY=t.pageY,e.screenX=t.screenX,e.screenY=t.screenY,e.x=t.x||t.clientX,e.y=t.y||t.clientY,e.relatedTarget=t.relatedTarget,e.button=t.button,e.buttons=t.buttons,e.bubbles=t.bubbles);return e}(e)),o=Date.now())};return s=()=>{const n=a.indexOf(s);-1!==n&&(t.removeEventListener(e,c,r),a.splice(n,1))},t.addEventListener(e,c,r),s}));return()=>{a.forEach((t=>t()))}}function Er(t){if(St.isIE){if(!St.isIEAtLeast11)return yr[t]}else{if(St.isSafari)return Sr[t];if(St.isAndroid)return St.isTouchDevice?Ar[t]:xr[t]}return wr[t]}St.Lazy.property(br,pr.DOWN,(()=>Er(pr.DOWN))),St.Lazy.property(br,pr.MOVE,(()=>Er(pr.MOVE))),St.Lazy.property(br,pr.UP,(()=>Er(pr.UP)));let Tr=function(t){function n(e,n,r){var i;return(i=t.call(this,e)||this).actionName=r,i.targetElement=n,i.status=gr,i.lastMoveData={},i}e(n,t);var r=n.prototype;return r.startCreating=function(){this.status=vr},r.cancel=function(){this.status=gr},r._addEventListener=function(t,e,n,r){return t.addEventListener(e,n,r),()=>{t.removeEventListener(e,n,r)}},r.init=function(){const t=new Hammer.Manager(this.targetElement);t.add(new Hammer.Tap({event:"doubletap",taps:2,posThreshold:100,time:296}),new Hammer.Pan({direction:Hammer.DIRECTION_ALL}));let e=!0,n=null,r=sn;const i=Rr(this.targetElement,pr.DOWN,(t=>{if(0!==t.button)return;const i=t.clientX,o=t.clientY;if(n={x:t.clientX,y:t.clientY},this.status===gr){r();let e=setTimeout((()=>{this.status=mr,this.emit("start",{clientX:i,clientY:o,srcEvent:t.native})}),300);r=()=>{clearTimeout(e)}}else if(this.status===vr){r(),e=!1;let n=setTimeout((()=>{this.emit("add-point",{clientX:i,clientY:o,srcEvent:t.native}),e=!0}),300);r=()=>{clearTimeout(n)}}}));let o=sn;St.isTouchDevice&&(o=this._addEventListener(this.targetElement,"touchstart",(t=>{t.touches.length>1&&r(),St.isIOSChrome&&t.preventDefault()})));const a=Rr(this.targetElement,pr.MOVE,(t=>{if(St.isTouchDevice&&n&&(Math.abs(t.clientX-n.x)>25||Math.abs(t.clientY-n.y)>25)&&r(),this.isLocked||!e)return;if(this.status===gr){const e=this.targetElement.getBoundingClientRect(),n=t.clientX-e.left,r=t.clientY-e.top;this.emit("mousemove",{x:n,y:r})}if(this.status!==vr)return;if(St.isTouchDevice)return;const i=t.clientX,o=t.clientY;this.emit("move",this.lastMoveData={clientX:i,clientY:o,srcEvent:t.native})}));t.on("doubletap",(t=>{e=!0;const n=t.srcEvent;r(),this.lastMoveData={clientX:dr(n),clientY:fr(n),srcEvent:t},c()}));const s=()=>{this.status===vr&&(this.status=gr,this.unlock(),this.emit("cancel"))},c=()=>{this.status===vr&&(this.status=gr,this.unlock(),this.emit("end",this.lastMoveData),this.lastMoveData=null)},u=this.pdfViewer.getStore().subscribe(this.actionName,(t=>{switch(t){case"complete":c();break;case"cancel":s();break;case"continue":this.startCreating()}}));this.addDestroyHook((()=>{o(),t.destroy(),u(),i(),a()}))},n}(kn);function Pr(t,e,n){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var r=e.length;return function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}(e,void 0!==n&&n<r?n:r)}return t(e,n)}const{stateHandler:Cr,Log:_r,ViewerEvents:Ir}=r,Dr=Cr.IStateHandler,Mr=_r.LoggerFactory,{DebouncePromiseQueue:Lr,getClientX:kr,getClientY:Vr,keyboardStatus:Hr,ThrottleAsyncTaskExecutor:Or}=r.shared,{isTouchDevice:Nr}=r.DeviceInfo,{isSamePoint:Ur}=r.commons,{BuiltinCommand:jr,BuiltinShortcutContext:Fr}=r.keyboard;Mr.getLogger("creation/complexshape/state");let Br=function(t){function n(e,n){var r;return(r=t.call(this,e)||this).type=n,r.cursorStyle="fv__cursor-crosshair",r.executor=new Or(20,!0),r}e(n,t);var r=n.prototype;return r.createInteractionTool=function(t){return new Tr(this.pdfViewer,t,"create-complex-shape")},r.syncAddingAnnot=function(t=!1){let e;if(t)e={cancle:t,page:this.pageRender.index};else{const{pdfRect:t,vertexes:n,lastPoint:r}=this.fakeAnnotation||{};e={type:this.type,page:this.pageRender.page.getIndex(),rect:t,points:[].concat(Pr(Y,n),[r]),closePath:"polygon"==this.type}}this.pdfViewer.eventEmitter.emit("collab-creating-op",e)},r.pageHandler=function(t){this.pageRender=t,this.destroyPageHooks=[];const e=t.$handler;e.addClass(this.cursorStyle);const n=e.get(0);this.snappedPointAssistant=new Gn(n),this.interaction=this.createInteractionTool(n),this.interaction.init();const r=new Lr,i=this.pdfViewer.getKeyboard();let o=()=>{};const a=()=>{o=i.activeContext(Fr.CREATING_ANNOTATION)};function s(t,e,n){if(Hr.isShift){let r=t.getDeviceVertexes();if(r.length>=1){let t=r[r.length-1],i=e-t.x,o=n-t.y;const a=Math.sqrt(i*i+o*o),s=Math.atan2(o,i),c=.25*Math.PI,u=Math.round(s/c)*c;return i=a*Math.cos(u),o=a*Math.sin(u),{deviceX:t.x+i,deviceY:t.y+o}}}return{deviceX:e,deviceY:n}}i.withContext(Fr.CREATING_ANNOTATION,(t=>{t.keyup(jr.CANCEL_CREATING_ANNOTATION_OPERATION,(()=>{o(),this.interaction.unlock(),this.interaction.cancel(),this.cancel()}))})),"polygon"==this.type||"polyline"==this.type||this.pdfViewer.eventEmitter.addListener(Ir.toolbarTabsClicked,(()=>{this.out()})),this.interaction.on("start",(({clientX:t,clientY:e})=>{this.pageRender.annotsRender.unActiveAnnot();let r=n.getBoundingClientRect();const i=t-r.left,s=e-r.top;o(),a(),this.getSnappedPoint(i,s).then((t=>{this.fakeAnnotation=this.create(t.deviceX,t.deviceY),this.interaction.startCreating()}))})),this.interaction.on("add-point",(({clientX:t,clientY:e})=>{let r=n.getBoundingClientRect(),i=t-r.left,o=e-r.top;const a=s(this.fakeAnnotation,i,o);this.getSnappedPoint(a.deviceX,a.deviceY).then((t=>{this.addPoint(this.fakeAnnotation,t)}))})),this.interaction.on("move",(({clientX:t,clientY:e})=>{let r=n.getBoundingClientRect(),i=t-r.left,o=e-r.top;this.executor.exec((()=>{const t=s(this.fakeAnnotation,i,o);return this.getSnappedPoint(t.deviceX,t.deviceY).then((e=>{Ur({x:t.deviceX,y:t.deviceY},{x:e.deviceX,y:e.deviceY})?this.snappedPointAssistant.hide():(this.snappedPointAssistant.show(e.type),this.snappedPointAssistant.setPosition(e.deviceX,e.deviceY)),this.adjust(this.fakeAnnotation,e),this.syncAddingAnnot()}))}))})),this.interaction.on("mousemove",(t=>{this.mousemove(t)})),this.interaction.on("end",(t=>{if(!this.canBeCompleted(this.fakeAnnotation))return void this.interaction.startCreating();o();let e=n.getBoundingClientRect();const r=s(this.fakeAnnotation,t.clientX-e.left,t.clientY-e.top);this.executor.waitForLastTask().finally((()=>{this.getSnappedPoint(r.deviceX,r.deviceY).then((t=>{-1==this.end(this.fakeAnnotation,t)&&(a(),this.interaction.startCreating())}))}))})),this.interaction.on("cancel",(()=>{o(),this.cancel(),this.syncAddingAnnot(!0)}));let c=t=>{this.fakeAnnotation&&(this.fakeAnnotation.zoomTo(t),this.fakeAnnotation.draw())};this.destroyPageHooks.push((()=>r.end()),this.pdfViewer.addEventListener(Ir.zoomToSuccess,(()=>{c(this.pageRender.scale)})),this.pdfViewer.addEventListener(Ir.changeViewModeSuccess,((t,e)=>{c(this.pageRender.scale)})),this.pdfViewer.addEventListener(Ir.fitWidthResizeViewport,(()=>{c(this.pageRender.scale)})))},r.getSnappedPoint=function(t,e){return this.pageRender.getPDFPage().then((n=>{const r=this.pdfViewer.getSnapMode(this.constructor.getStateName());if(r&&r.length>0){const[i,o]=n.reverseDevicePoint([t,e],this.pageRender.scale,this.pageRender.rotate);return n.getSnappedPoint({x:i,y:o},r).then((t=>{const[e,r]=n.getDevicePoint([t.x,t.y],this.pageRender.scale,this.pageRender.rotate);return{deviceX:e,deviceY:r,type:t.type}}))}return{deviceX:t,deviceY:e}}))},r.create=function(t,e){throw new Error("not implemented!")},r.addPoint=function(t,{deviceX:e,deviceY:n}){t.addPoint(e,n),t.draw()},r.mousemove=function(t){this.executor.exec((()=>this.getSnappedPoint(t.x,t.y).then((({deviceX:e,deviceY:n,type:r})=>{Ur(t,{x:e,y:n})?this.snappedPointAssistant.hide():(this.snappedPointAssistant.setPosition(e,n),this.snappedPointAssistant.show(r))}))))},r.adjust=function(t,{deviceX:e,deviceY:n}){t.setLastPoint(e,n),t.draw()},r.end=function(t,e){this.creatingState=0,e&&!Nr&&(t.addPoint(e.deviceX,e.deviceY),t.draw()),t.apply().then((t=>{if(!this.pdfViewer.config.showCommentList)return;const e=t[t.length-2];this.pageRender.annotsRender.getAnnotRender(e.getId()).component.showReplyDialog()})),this.fakeAnnotation=null},r.cancel=function(){this.fakeAnnotation&&(this.syncAddingAnnot(!0),this.executor.cancel(),this.interaction.cancel(),this.fakeAnnotation.destroy(),this.fakeAnnotation=null)},r.canBeCompleted=function(){return!0},r.createAnnotJson=function(t,e){return t},r.docHandler=function(t){Nr?t.enableDragToScroll():t.disableDragToScroll()},r.destroyPageHandler=function(){this.snappedPointAssistant.destroy(),this.destroyPageHooks&&this.destroyPageHooks.forEach((t=>t())),this.pageRender.$handler.removeClass(this.cursorStyle),this.fakeAnnotation&&(this.interaction.status!==gr&&this.pdfViewer.eventEmitter.emit(Ir.cancelAddAnnot),this.fakeAnnotation.destroy(),this.fakeAnnotation=null),this.interaction.destroy(),this.offCancelEvent&&this.offCancelEvent()},r.out=function(){this.destroyPageHandler()},n}(Dr),$r=function(t){function n(e,n=!1){var r;return(r=t.call(this)||this).closing=n,e.length>1&&e.reduce(((t,e,n)=>(r.addSegment(new Yr(t,e,1===n)),e))),r}return e(n,t),n.prototype.render=function(t){t.beginPath(),this.segments.forEach((e=>{e.render(t)})),this.closing&&t.closePath()},n}(Ve),Yr=function(t){function n(e,n,r=!1){var i;return(i=t.call(this,e,n)||this).atTheStart=r,i}return e(n,t),n.prototype.render=function(t){this.atTheStart&&t.moveTo(this.from.x,this.from.y),t.lineTo(this.to.x,this.to.y)},n}(He);function Xr(t,e,n=5){t.fillStyle="#fff",e.forEach((e=>{t.beginPath(),t.arc(e.x,e.y,n,0,360),t.stroke(),t.fill()}))}function zr(t,e,n){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var r=e.length;return function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}(e,void 0!==n&&n<r?n:r)}return t(e,n)}let Gr=function(t){function n(e){var n;return(n=t.call(this,e)||this).helper=new On(e),n}e(n,t);var r=n.prototype;return r.doPrepare=function(){t.prototype.doPrepare.call(this),this.canvas.classList.add("fv__viewer-render-polyline")},r.doRender=function(t){const e=t.renderingData,n=e.annotInfo,r=n.borderInfo||{},i=t.scale,o=t.rotate,a=this.canvas.getContext("2d"),s=this.convertPointToPixel(0==r.width?.5:r.width,i);if(0==s&&-1==n.borderColor&&!n.fillColor)return;if(a.clearRect(0,0,this.canvas.width,this.canvas.height),this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent())return;const c=e.page,u=t.innerRect,l=e.vertexes.map((t=>{const[e,n]=c.getDevicePoint([t.x,t.y],i,o);return new ke(e-u.left,n-u.top)}));t.vertexes=l,a.save(),t.lineWidth=s,a.globalAlpha=n.opacity,a.lineWidth=s,0===s||!1===n.hasBorderColor?a.strokeStyle="transparent":a.strokeStyle=this.numberToRGBAString(n.color);try{switch(r.style){case Re:case be:this.renderSolid(a,n,t)}const i=l[l.length-1],o=l[l.length-2],c=l[0],u=l[1];this.helper.renderLineEnd(a,s,t,e.startStyle,u,c),this.helper.renderLineEnd(a,s,t,e.endingStyle,o,i),this.setContents(a,n.contents,l)}finally{a.restore()}},r.renderSolid=function(t,e,n){const r=n.scale,i=e.borderInfo,o=i.dashes||[],a=i.dashPhase||0;i.style===Re&&(t.setLineDash&&t.setLineDash(o.map((t=>this.convertPointToPixel(t,r)))),t.lineDashOffset=this.convertPointToPixel(a,r));new $r(n.vertexes,!1,5).render(t),t.stroke();try{if(!St.isTouchDevice)return;void 0===n.renderingData.annotInfo.id&&Xr(t,n.vertexes)}catch(t){}},r.setMarkUp=function(t,e){const n=mn(this.component,t,e),{renderingData:r,innerRect:i}=n;t=n.scale,e=n.rotate;const o=r.annotInfo,a=this.canvas.getContext("2d"),s=r.page;a.strokeStyle=this.numberToRGBAString(o.color);r.vertexes.map((n=>{const[r,o]=s.getDevicePoint([n.x,n.y],t,e);return new ke(r-i.left,o-i.top)})).forEach((t=>vn(a,t))),a.restore()},r.setContents=function(t,e,n){if(void 0===e)return;if(!n||n.length<3)return;const r=n[n.length-1],i=t;i.beginPath(),i.font="14px Verdana",i.textAlign="left",i.textBaseline="top",i.direction="ltr";var o=i.measureText(e).width;i.fillStyle="#AF6B6B";const a=n.map((t=>t.x)),s=Math.min.apply(Math,zr(Y,a));Math.max.apply(Math,zr(Y,a));Math.abs(r.x-s)>=o&&r.x>s?i.fillText(e,r.x-o,r.y,o):i.fillText(e,r.x,r.y,o),i.closePath()},n}(xe);function qr(t,e,n){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var r=e.length;return function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}(e,void 0!==n&&n<r?n:r)}return t(e,n)}let Wr=function(t){function r(e){var n,r;((n=t.call(this,e)||this).vertexes=[],n.deviceVertexes=[],n.lastPoint={x:0,y:0},n.annotationInfo.vertexes)&&(r=n.vertexes).push.apply(r,qr(Y,n.annotationInfo.vertexes));return n.annotationInfo.vertexes=n.vertexes,n}e(r,t);var i=r.prototype;return i.getVertexes=function(){return this.vertexes},i.getDeviceVertexes=function(){return this.deviceVertexes},i.addPoint=function(t,e){const[n,r]=this.page.reverseDevicePoint([t,e],this.scale,this.rotate);this.vertexes.push({x:n,y:r}),this.lastPoint={x:n,y:r},this.deviceVertexes.push({x:t,y:e}),this.updateRect()},i.setLastPoint=function(t,e){const n=this.deviceVertexes[this.deviceVertexes.length-1],r="number"==typeof t?t:n.x,i="number"==typeof e?e:n.y,[o,a]=this.page.reverseDevicePoint([r,i],this.scale,this.rotate);this.lastPoint={x:o,y:a},this.updateRect()},i.getLastPoint=function(){return this.lastPoint},i.zoomTo=function(e){this.scale!==e&&(t.prototype.zoomTo.call(this,e),this.deviceVertexes=this.vertexes.map((t=>{const[n,r]=this.page.getDevicePoint([t.x,t.y],e,this.rotate);return{x:n,y:r}})),this.updateRect())},i.removeLastPoint=function(){},i.getRenderingData=function(e,r){const i=t.prototype.getRenderingData.call(this,e,r);let[...o]=this.vertexes;return o.push(this.lastPoint),n(n({},i),{vertexes:o})},i.generateApRenderer=function(){return new Gr(this)},i.getType=function(){return"polyline"},i.getOuterDeviceRect=function(e,n){return t.prototype.getDeviceRect.call(this,e,n)},i.updateRect=function(){if(0===this.deviceVertexes.length)return;const[t,e]=this.page.getDevicePoint([this.lastPoint.x,this.lastPoint.y],this.scale,this.rotate),n={x:t,y:e};let r=n.x,i=n.y,o=n.x,a=n.y;this.deviceVertexes.forEach((t=>{r=Math.min(r,t.x),o=Math.max(o,t.x),i=Math.min(i,t.y),a=Math.max(a,t.y)}));const s=Qe(this.annotationInfo.borderInfo.width)*this.scale*2+20;r-=s/2,i-=s/2,o+=s/2,a+=s/2,this.setRect({left:r,top:i,right:o,bottom:a})},i.apply=function(){return t.prototype.apply.call(this).then((t=>{const{intent:e}=this.annotationInfo;return"PolygonDimension"===e||"PolyLineDimension"===e?this.page.getMeasureScaleRatio().then((n=>{if(n&&n.scale){const n=this.pdfViewer.getStore().getCurrentValue("measurementData"),r=fn(this.pdfViewer),i=Ae(n.displayUnit.name)?this.pdfViewer.i18n.t(`measurement.units.${n.displayUnit.name}`):n.displayUnit.name;return t[0].setContent(r+parseFloat("PolyLineDimension"===e?n.perimeter:n.area).toFixed(2)+" "+i).then((e=>t))}return t})):t}))},r}(tn);function Kr(t,e,n){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var r=e.length;return function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}(e,void 0!==n&&n<r?n:r)}return t(e,n)}let Jr=function(t){function n(e,n=!0){var r;return(r=t.call(this,e)||this).closing=n,r.showText=!0,r}e(n,t);var r=n.prototype;return r.setFlag=function(t,e){this.closing=t,this.showText=e},r.doPrepare=function(){t.prototype.doPrepare.call(this),this.canvas.classList.add("fv__viewer-render-polygon")},r.doRender=function(t){const e=t.renderingData,n=e.annotInfo,r=n.borderInfo||{},i=t.scale,o=t.rotate,a=this.convertPointToPixel(0==r.width?.5:r.width,i);if(0==a&&-1==n.borderColor&&!n.fillColor)return;const s=this.canvas.getContext("2d");if(s.clearRect(0,0,this.canvas.width,this.canvas.height),this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent())return;const c=e.page,{innerRect:u,outerRect:l}=t,h=e.vertexes.map((t=>{const[e,n]=c.getDevicePoint([t.x,t.y],i,o);return new ke(e-u.left,n-u.top)})),d=e.vertexes.map((t=>{const[e,n]=c.getDevicePoint([t.x,t.y],i,o);return new ke(e-l.left,n-l.top)}));t.vertexes=h,s.save(),t.lineWidth=a,s.globalAlpha=n.opacity,0===a||!1===n.hasBorderColor?s.strokeStyle="transparent":s.strokeStyle=this.numberToRGBAString(n.color),s.lineWidth=a;try{switch(r.style){case Re:case be:case Ee:case Te:this.renderSolid(s,n,t),this.setContents(s,n.contents,h);break;case Pe:0==a?this.renderSolid(s,n,t):this.renderCloud(s,n,t),this.setContents(s,n.contents,d)}}finally{s.restore()}},r.renderCloud=function(t,e,n){const r=e.fillColor,i=e.borderInfo.cloudIntensity,o=n.innerRect,a=n.outerRect,s=new $e(n.vertexes,o,a);let c=n.renderingData.vertexes,u=c.length;if(u=u*=2==i?8:16,c.length>=2){u=function(t,e){let n=2,r=Math.abs(t.right-t.left),i=Math.abs(t.bottom-t.top);n=1===e?parseInt((r+i)/4):parseInt((r+i)/6);return n<2&&(n=2),n%2!=0&&(n+=1),n}(this.calculateRect(c),i)}s.generate(16/i,t,u).render(t),r&&(t.fillStyle=this.numberToRGBAString(r),t.fill()),t.stroke();try{if(!St.isTouchDevice)return;const e=[],r=o.left-a.left,i=o.top-a.top;n.vertexes.forEach((t=>{e.push({x:t.x+r,y:o.height-t.y+i})})),void 0===n.renderingData.annotInfo.id&&Xr(t,e)}catch(t){}},r.renderSolid=function(t,e,n){const r=n.scale,i=e.borderInfo,o=i.dashes||[],a=i.dashPhase||0,s=e.fillColor;i.style===Re&&(t.setLineDash&&t.setLineDash(o.map((t=>this.convertPointToPixel(t,r)))),t.lineDashOffset=this.convertPointToPixel(a,r));new $r(n.vertexes,this.closing).render(t),s&&(t.fillStyle=this.numberToRGBAString(s),t.fill()),t.stroke();try{if(!St.isTouchDevice)return;void 0===n.renderingData.annotInfo.id&&Xr(t,n.vertexes)}catch(t){}},r.setMarkUp=function(t,e){const n=mn(this.component,t,e),{renderingData:r,innerRect:i}=n;t=n.scale,e=n.rotate;const o=r.annotInfo,a=o.borderInfo||{},s=this.convertPointToPixel(a.width,t),c=this.canvas.getContext("2d");c.clearRect(0,0,this.canvas.width,this.canvas.height);const u=r.page,l=r.vertexes.map((n=>{const[r,o]=u.getDevicePoint([n.x,n.y],t,e);return new ke(r-i.left,o-i.top)}));c.save(),c.strokeStyle=this.numberToRGBAString(o.color),c.lineWidth=s;const h=this.closing;this.closing=!0,this.renderSolid(c,o,{vertexes:l}),c.beginPath(),l.forEach((t=>vn(c,t))),this.closing=h},r.setContents=function(t,e,n){if(void 0===e)return;if(!n||n.length<3||!this.showText)return;const r=n[n.length-1],i=t;i.beginPath(),i.font="14px Verdana",i.textAlign="left",i.textBaseline="top",i.direction="ltr";var o=i.measureText(e).width;i.fillStyle="#AF6B6B";const a=n.map((t=>t.x)),s=Math.min.apply(Math,Kr(Y,a));Math.abs(r.x-s)>=o&&r.x>s?i.fillText(e,r.x-o,r.y,o):i.fillText(e,r.x,r.y,o),i.closePath()},r.calculateRect=function(t){let e={},n={x:0,y:0};e.left=e.right=t[0].x,e.bottom=e.top=t[0].y;let r=t.length;for(let i=1;i<=r;i++)n=t[i%r],e.left>n.x&&(e.left=n.x),e.bottom>n.y&&(e.bottom=n.y),e.right<n.x&&(e.right=n.x),e.top<n.y&&(e.top=n.y);return e},n}(xe),Zr=function(t){function n(e){var n;(n=t.call(this,e)||this).isCloudy=!1;const r=n.annotationInfo;if(r.borderStyle)switch(r.borderInfo.style=r.borderStyle,r.borderStyle){case Pe:n.annotationInfo.borderInfo.cloudIntensity=r.borderStyleParam,n.isCloudy=!0;break;case Re:n.annotationInfo.borderInfo.dashes=r.borderStyleParam}return r.borderInfo.style===Pe?n.isCloudy=!0:n.isCloudy=!1,n}e(n,t);var r=n.prototype;return r.setFlag=function(t,e){this.renderer.setFlag(t,e)},r.generateApRenderer=function(){const t=this.isCloudy;return new Jr(this,t)},r.getOuterDeviceRect=function(e,n){return this.isCloudy?ze.on(this.getDeviceRect(e,n)).expand(100*e).extract():t.prototype.getDeviceRect.call(this,e,n)},r.getType=function(){return"polygon"},n}(Wr);const{stateHandler:Qr,Log:ti,DeviceInfo:ei}=r,ni=ti.LoggerFactory,{STATE_HANDLER_CREATE_POLYGON:ri}=Qr.StateHandlerConsts,ii=ni.getLogger("CreatePolygonStateHandler");let oi=function(t){function n(e){return t.call(this,e,"polygon")||this}e(n,t),n.getStateName=function(){return ri};var r=n.prototype;return r.create=function(t,e){const n=new Zr({pdfViewer:this.pdfViewer,pageRender:this.pageRender,info:this.createAnnotJson({type:"polygon",flags:4,date:new Date,subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Polygon")})});return n.addPoint(t,e),ei&&ei.isTouchDevice&&n.draw(),this.pdfViewer.eventEmitter.emit(Ke.perimeterAnnotCreationStart,n),n},r.canBeCompleted=function(t){const e=t.getVertexes().length;return e<2&&ii.debug(`polygon has only ${e} points`),e>=2},n}(Br);const{stateHandler:ai,Log:si,DeviceInfo:ci}=r,ui=si.LoggerFactory,{STATE_HANDLER_CREATE_POLYLINE:li}=ai.StateHandlerConsts;ui.getLogger("creation/polyline/state");let hi=function(t){function r(e){return t.call(this,e,"polyline")||this}return e(r,t),r.getStateName=function(){return li},r.prototype.create=function(t,e){const r=this.pdfViewer.getDefaultAnnotConfig()("polyline"),i=new Wr(n({pdfViewer:this.pdfViewer,pageRender:this.pageRender,info:this.createAnnotJson({type:"polyline",flags:4,date:new Date,subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Polyline")})},r));return i.addPoint(t,e),ci&&ci.isTouchDevice&&i.draw(),i},r}(Br);const{stateHandler:di,Log:fi,DeviceInfo:pi}=r,{BORDER_STYLE:gi}=r.Consts,mi=fi.LoggerFactory,{STATE_HANDLER_CREATE_POLYGON_CLOUD:vi}=di.StateHandlerConsts,yi=Object.values(gi),wi=mi.getLogger("CreatePolygonCloudStateHandler");let Si=function(t){function r(e){return t.call(this,e,"polygon")||this}e(r,t),r.getStateName=function(){return vi};var i=r.prototype;return i.create=function(t,e){const r=this.pdfViewer.getDefaultAnnotConfig()("polygon","PolygonCloud"),i=n({type:"polygon",flags:4,date:new Date,borderStyle:gi.CLOUDY,borderStyleParam:2,intent:"PolygonCloud",subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Cloud")},r);let o;if(o=r.borderInfo){yi.indexOf(o.style)>-1&&(i.borderStyle=o.style);const t=o.dashes;Array.isArray(t)&&t.length>0?i.borderStyleParam=t:"number"==typeof o.cloudIntensity&&(i.borderStyleParam=o.cloudIntensity)}const a=new Zr({pdfViewer:this.pdfViewer,pageRender:this.pageRender,info:i});return a.addPoint(t,e),pi&&pi.isTouchDevice&&a.draw(),a},i.canBeCompleted=function(t){const e=t.getVertexes().length;return e<2&&wi.debug(`polygon has only ${e} points`),e>=2},r}(Br);function Ai(t,e,n){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var r=e.length;return function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}(e,void 0!==n&&n<r?n:r)}return t(e,n)}let xi=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var r=n.prototype;return r.convertToCanvasBasedPoint=function(t,e,n,r,i,o){const[a,s]=i.getDevicePoint([t,e],r,o);return{x:a-n.left,y:s-n.top}},r.doRender=function(t){const{scale:e,renderingData:n,rotate:r}=t,i=n.page;let{startCharInfo:o,endCharInfo:a}=n.annotInfo;const s=n.quadPoints,c=n.outerDeviceRect;if(!o){const t=s[0];o={left:t[0].x,top:t[0].y,right:t[1].x,bottom:t[2].y}}if(!a){const t=s[s.length-1];a={left:t[0].x,top:t[0].y,right:t[1].x,bottom:t[2].y}}const u=s.map(((t,n)=>{const o=t.map((t=>this.convertToCanvasBasedPoint(t.x,t.y,c,e,i,r))),a=o.map((t=>t.x)),s=o.map((t=>t.y));let u=Math.min.apply(Math,Ai(Y,a)),l=Math.max.apply(Math,Ai(Y,a)),h=Math.max.apply(Math,Ai(Y,s)),d=Math.min.apply(Math,Ai(Y,s));return{left:u,right:l,bottom:h,top:d,width:l-u,height:h-d,textBlockHeight:h-d}}));t.quadRects=u},n}(xe),bi=function(t){function n(e){var n;return(n=t.call(this,e)||this).lastX=0,n.lastY=0,n}e(n,t);var r=n.prototype;return r.prepare=function(){t.prototype.prepare.call(this),St.isChrome||St.isFirefox||St.isSafari||St.isChromiumEdge||(this.canvas.style.cssText+='\n            -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";\n            -ms-filter: alpha(opacity=50);\n            filter: alpha(opacity=50);\n            -moz-opacity: 0.5;\n            -khtml-opacity: 0.5;\n            opacity: 0.5;\n        ')},r.doRender=function(e){const{smartScale:n,scale:r}=e,i=(this.component,e.renderingData),o=i.annotInfo;if(this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent()){const t=this.canvas.getContext("2d");return t.clearRect(0,0,this.canvas.width,this.canvas.height),void t.save()}if(0==o.hasBorderColor)return;const a=this.canvas.getContext("2d"),s=i.outerDeviceRect,c=s.right-s.left,u=s.bottom-s.top;if(this.container.style.cssText+=`\n                left: ${s.left}px;\n                top: ${s.top}px;\n            `,this.canvas.style.cssText+=`width: ${c}px;height: ${u}px;`,a.save(),a.fillStyle=this.numberToRGBAString(o.color),a.globalAlpha=i.opacity,i.isArea)a.fillRect(0,0,this.canvas.width,this.canvas.height);else{t.prototype.doRender.call(this,e);e.quadRects.forEach((t=>{a.fillRect(t.left,t.top,t.width,t.textBlockHeight)}))}a.restore()},n}(xi),Ri=function(t){function r(e){var r;return(r=t.call(this,e)||this).annotationInfo.dicts=n({AreaHi:"AreaHi"},r.annotationInfo.dicts||{}),r.eContainer.classList.add("fv__viewer-fake-highlight-area-annot"),r}e(r,t);var i=r.prototype;return i.setRect=function(e){t.prototype.setRect.call(this,e),this.annotationInfo.coords=[this.pdfRect],this.annotationInfo.quadPoints=[{x:this.pdfRect.left,y:this.pdfRect.top},{x:this.pdfRect.right,y:this.pdfRect.top},{x:this.pdfRect.right,y:this.pdfRect.bottom},{x:this.pdfRect.left,y:this.pdfRect.bottom}]},i.getDefaultAnnotInfo=function(){const e=t.prototype.getDefaultAnnotInfo.call(this);return e.color=16776960,e},i.getDefaultAnnotConfig=function(){const t=this.pdfViewer.getDefaultAnnotConfig();return"function"==typeof t?t(this.getType(),"Area"):{}},i.generateApRenderer=function(){return new bi(this)},i.getType=function(){return"highlight"},i.getCreationJSON=function(){return n(n({},t.prototype.getCreationJSON.call(this)),{color:this.annotationInfo.color})},i.getRenderingData=function(e,r){const i=t.prototype.getRenderingData.call(this,e,r);return n(n({},i),{coords:[i.outerDeviceRect],isArea:!0})},r}(tn);const Ei=r.stateHandler,Ti=Ei.IStateHandler,{getDevicePagePoint:Pi}=Ei.StateHandlerUtils,{STATE_HANDLER_CREATE_CREATE_AREA_HIGHLIGHT:Ci}=Ei.StateHandlerConsts;let _i=function(t){function n(e){var n;return(n=t.call(this,e)||this).cursorStyle="fv__cursor-crosshair",n}e(n,t),n.getStateName=function(){return Ci};var r=n.prototype;return r.pageHandler=function(t){this.pageRender=t,this.pageDestroyHooks=[];const e=t.$handler.get(0);t.$handler.addClass(this.cursorStyle);const n=this.hammer=new Hammer.Manager(e);n.add(new Hammer.Pan),n.on("panstart",(t=>{this.startPoint=Pi(e,t),this.start(this.startPoint)})),n.on("panmove",(t=>(this.currentPoint={x:this.startPoint.x+t.deltaX,y:this.startPoint.y+t.deltaY},this.adjust(this.fakeAnnotation,this.startPoint,this.currentPoint)))),n.on("panend",(t=>{this.end(this.fakeAnnotation)})),n.on("pancancel",(t=>this.end(this.fakeAnnotation))),this.pageDestroyHooks.push((()=>n.destroy()))},r.start=function({x:t,y:e}){return this.fakeAnnotation=new Ri({pdfViewer:this.pdfViewer,pageRender:this.pageRender,info:{flags:4,subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Highlight")}}),this.fakeAnnotation.setRect({left:t,right:t+1,top:e,bottom:e+1}),this.fakeAnnotation},r.adjust=function(t,{x:e,y:n},{x:r,y:i}){const o=Math.min(e,r),a=Math.min(n,i),s=Math.max(e,r),c=Math.max(n,i);t.setRect({left:o,top:a,right:s,bottom:c}),t.draw()},r.end=function(t){t.apply().then((t=>{if(!this.pdfViewer.config.showCommentList)return;const e=t[t.length-2];this.pageRender.annotsRender.getAnnotRender(e.getId()).component.showReplyDialog()})).then((()=>{0}))},r.destroyPageHandler=function(){this.fakeAnnotation&&this.fakeAnnotation.destroy(),this.pageDestroyHooks&&this.pageDestroyHooks.forEach((t=>t())),this.pageRender.$handler.removeClass(this.cursorStyle)},n}(Ti);function Ii(t,e,n){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var r=e.length;return function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}(e,void 0!==n&&n<r?n:r)}return t(e,n)}const{stateHandler:Di,ViewerEvents:Mi,shared:Li,DeviceInfo:ki}=r,{jQuery:Vi,EventEmitter:Hi}=r.vendors,Oi=Di.IStateHandler,{STATE_HANDLER_CREATE_PENCIL:Ni}=Di.StateHandlerConsts,{getClientX:Ui,getClientY:ji,colorConvertor:Fi}=r.shared,{dpr:Bi}=Li.browser;let $i=function(){function t(){this.isZoom=!1,this.eventEmitter=new Hi}t.inject=function(){return{pdfViewer:r.PDFViewer}};var e=t.prototype;return e.allInjected=function(){const t=new Hammer.Manager(this.pdfViewer.element,{recognizers:[[Hammer.Pinch]]});t.on("pinchstart",(t=>{this.isZoom=!0,this.eventEmitter.emit("pinchstart",t)})),t.on("pinchend",(t=>{Promise.resolve().then((()=>{this.isZoom=!1})),this.eventEmitter.emit("pinchend",t)})),t.on("pinchmove",(t=>{this.eventEmitter.emit("pinchmove",t)}))},e.onPinchstart=function(t){return this.eventEmitter.on("pinchstart",t),()=>{this.eventEmitter.off("pinchstart",t)}},e.onPinchmove=function(t){return this.eventEmitter.on("pinchmove",t),()=>{this.eventEmitter.off("pinchmove",t)}},e.onPinchend=function(t){return this.eventEmitter.on("pinchend",t),()=>{this.eventEmitter.off("pinchend",t)}},t}(),Yi=function(t){function r(){var e;return(e=t.apply(this,arguments)||this).cursorStyle="fv__cursor-pencil",e.isMovingPencil=!1,e.destroyHooks=[],e}e(r,t),r.getStateName=function(){return Ni},r.getStateHandlerName=function(){return"pencilStateHandler"};var i=r.prototype;return i.initTimeout=function(t,e=!0){let n=this.timeout;clearTimeout(n),e&&(this.timeout=setTimeout((()=>{if(this.isMovingPencil)return this.isMovingPencil=!1,this.initTimeout(t,e);this.addAnnot().then((t=>{this.isMovingPencil=!1}))}),t))},i.pageHandler=function(t){let e=this;this.pageRender=t;const r=this.pdfViewer,i=r.getIoC().getInstanceByClass($i),o=t.viewerRender,a=o.scrollWrap;let s=t.$handler;s.addClass(this.cursorStyle);const c=(e=!1,n=1)=>{if(this.pdfPointList&&!(this.pdfPointList.length<1)){if(e&&this.$canvas)return A(),void function(e,n){if(!e||e.length<1)return;let r={left:1e4,right:0,top:0,bottom:1e4},i=t.scale;St.isTouchDevice&&(i=t.scale*n);let o=function(t,e,n,r,i,o){return i.forEach((i=>{let[a,s]=t.getDevicePoint([i.x,i.y],e,n);a>o.right?o.right=a:a<o.left&&(o.left=a),s>o.top?o.top=s:s<o.bottom&&(o.bottom=s),r.push({x:a,y:s,type:i.type})})),r}(t.page,i,t.rotate,[],e,r);const a=u[0].getBoundingClientRect(),s=d.getBoundingClientRect();o.slice(0).map((t=>({...t,x:t.x-(a.left-s.left),y:t.y-(a.top-s.top)}))).forEach((t=>{1==t.type?h.moveTo(t.x*Bi,t.y*Bi):h.lineTo(t.x*Bi,t.y*Bi)})),h.stroke()}(this.pdfPointList,n);clearTimeout(this.timeout),this.addAnnot()}};this.destroyHooks.push((0,St.observeResize)(t.viewerRender.scrollWrap.getScrollHost(),(()=>{this.isPaintingPencil||x()})));const u=this.$canvas=Vi('<canvas style="position: fixed;pointer-events: none;z-index: 1024;">');x(),s.append(this.$canvas.get(0));let l,h=this.$canvas[0].getContext("2d"),d=s[0],f=this.hammer=new Hammer.Manager(d,{recognizers:[[Hammer.Tap]]});if(this.pencilLists=[],this.isMovingPencil=!1,this.pdfPointList=[],this.isPaintingPencil=!1,this.startScale=t.scale,St.isTouchDevice){const t=r.addEventListener(Mi.zoomToSuccess,(()=>{this.transferPencilListsToPDFPointsLists(),c(!0,1)}));this.destroyHooks.push(t)}const p=e=>{if(o.setAllowScrollOnMouseWheel(!1),0==this.pdfPointList.length&&(this.startScale=t.scale,A()),i.isZoom)return;this.isPaintingPencil=!0;let n=this.pencilLists;l=[],n.push(l);let r=Xi(d,e,u[0]);h.closePath(),h.beginPath(),h.moveTo(r.x*Bi,r.y*Bi),l.push({x:r.x,y:r.y,type:1})},g=t=>{if(i.isZoom)return;this.isMovingPencil=!0;let e=Xi(d,t,u[0]);l.push({x:e.x,y:e.y,type:2}),h.lineTo(e.x*Bi,e.y*Bi),h.strokeStyle=this.lineColor,h.stroke(),h.closePath(),h.beginPath(),h.moveTo(e.x*Bi,e.y*Bi);this.pageRender.page},m=t=>{o.setAllowScrollOnMouseWheel(!0);let e=this.pencilLists;if(!this.isPaintingPencil||!e||e.length<1||!this.isMovingPencil||i.isZoom)return;this.isMovingPencil=!1;let n=Xi(d,t,u[0]);h.lineTo(n.x*Bi,n.y*Bi),h.stroke(),this.startAddAnnot()};let v=!1;f.on("tap",(e=>{if(this.isPaintingPencil=!0,0==this.pdfPointList.length&&(this.startScale=t.scale,A()),e.pointers.length>1||i.isZoom)return;h.closePath();let n=Xi(d,e,u[0]);h.beginPath(),h.moveTo(n.x*Bi,n.y*Bi),h.arc(n.x*Bi,n.y*Bi,this.lineWidth,0,2*Math.PI),h.fillStyle=this.lineColor,h.fill(),h.closePath(),this.pencilLists.push([{x:n.x,y:n.y,type:3}]),this.isMovingPencil=!0,this.startAddAnnot()}));let y=!1;function w(t){const e=r.element.parentElement.getBoundingClientRect(),n=s[0].getBoundingClientRect(),i=n.x-e.x,o=n.y-e.y;u.css({position:"absolute",left:-i/t,top:-o/t})}function S(){const t=r.element.parentElement;if(!t)return 1;const e=t.style.transform,[,n]=/scale\((\d+(\.\d+)?)\)/.exec(e)||[];return void 0===n?1:parseFloat(n)}function A(){const r=n({borderInfo:{width:2},color:16711680},e.pdfViewer.getDefaultAnnotConfig()("ink"));r.color=16777215&r.color,x(),e.$canvas.css("opacity",Number(r.opacity)),e.lineWidth=r.borderInfo.width*t.getScale()*Bi,h.lineWidth=r.borderInfo.width*t.getScale()*Bi,e.lineColor=Fi(r.color,"HTML"),h.strokeStyle=Fi(r.color,"HTML"),h.lineJoin="round",h.lineCap="round"}function x(){const e=t.viewerRender.getViewBoxRect(),n=e.right-e.left,r=e.bottom-e.top;u[0].width=n*Bi,u[0].height=r*Bi,u.css({width:n,height:r,position:"fixed",left:e.left,top:e.top})}if(f.on("hammer.input",(t=>{t.pointers.length>1?v=!0:v?"pointerup"==t.srcEvent.type&&(v=!1):"pointermove"==t.srcEvent.type?(y||(p(t),y=!0),g(t)):"pointerup"==t.srcEvent.type&&(m(t),y=!1)})),i.onPinchstart((t=>{w(S())})),i.onPinchmove((t=>{w(S())})),i.onPinchend((e=>{!function(){const e=t.viewerRender.getViewBoxRect();u.css({position:"fixed",left:e.left,top:e.top})}(),Promise.resolve().then((()=>{c(!1,e.scale)}))})),ki.isTouchDevice){const t=t=>{t.preventDefault()};s.on("touchstart",t),this.__off_touch_event=()=>{s.on("touchstart",t)}}else this.__off_touch_event=()=>{};const b=a.getScrollHost(),R=t=>{if(!this.isPaintingPencil||this.isMovingPencil)return;let e=!1;(t.ctrlKey||St.isMac&&t.metaKey)&&(e=!0),c(e)};b.addEventListener("wheel",R);const E=t=>{this.isPaintingPencil&&!this.isMovingPencil&&c()};t.$element.on("blur",E),this.destroyHooks.push((()=>{t.$element.off("blur",E),b.removeEventListener("wheel",R)}))},i.changeToPageDevicePoints=function(t,e){let n=[];n.push.apply(n,Ii(Y,t.reduce(((t,e)=>t.concat(e)),[])));const r=this.$canvas[0].getBoundingClientRect(),i=e.getBoundingClientRect();return n.slice(0).map((t=>({...t,x:t.x+r.left-i.left,y:t.y+r.top-i.top})))},i.transferPencilListsToPDFPointsLists=function(){var t;let e=this.pencilLists;if(!e||e.length<1)return;let n=this.pageRender;const r=n.$handler[0],i=n.page;const o=this.changeToPageDevicePoints(e,r);let a=function(t,e,n,r,i,o){return i.forEach((i=>{let[a,s]=t.reverseDevicePoint([i.x,i.y],e,n);a>o.right?o.right=a:a<o.left&&(o.left=a),s>o.top?o.top=s:s<o.bottom&&(o.bottom=s),r.push({x:a,y:s,type:i.type})})),r}(i,n.scale,n.rotate,[],o,{left:1e4,right:0,top:0,bottom:1e4});(t=this.pdfPointList).push.apply(t,Ii(Y,a)),this.pencilLists=[]},i.startAddAnnot=function(){let t=this.pencilLists;if(!t||t.length<1)return Promise.resolve();let e=this.pageRender;if(this.transferPencilListsToPDFPointsLists(),e.pdfViewer.continuousAddPencil)return void this.addAnnot();let n=e.pdfViewer.getStateHandlerManager().getStateHandlerConfig(this.constructor.getStateHandlerName()),r=n?n.pencilTimeout:null;return r=null!=r?r:3e3,this.initTimeout(r)},i.addAnnot=function(){if(!this.pdfPointList||this.pdfPointList.length<1)return Promise.resolve();let t=this.pageRender;return t.getPDFPage().then((e=>{let n=t.index;const r=t=>{t.index===n&&(this.$canvas[0]&&(this.$canvas[0].width=0),t.pdfViewer.eventEmitter.off("renderAnnotSuccess",r),this.isPaintingPencil=!1)};return e.addAnnot({type:"ink",flags:4,rect:{left:1e4,right:0,top:0,bottom:1e4},inkList:this.pdfPointList,subject:this.pdfViewer.i18n.t("viewer_:annotSubjects.Pencil")}).then((e=>(t.pdfViewer.eventEmitter.emit(Mi.addAnnotSuccess,e[0]),t.pdfViewer.eventEmitter.on("renderAnnotSuccess",r),this.pencilLists=[],this.pdfPointList=[],e))).then((t=>{if(!this.pdfViewer.config.showCommentList)return;const e=t[t.length-2];this.pageRender.annotsRender.getAnnotRender(e.getId()).component.showReplyDialog()}))}))},i.destroyPageHandler=function(){this.__off_touch_event(),this.initTimeout(0,!1),this.pageRender.docRender.formRender.addTask((t=>this.addAnnot().then((t=>{this.$canvas.remove(),this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle),this.pencilLists=null}))),!0),this.destroyHooks.forEach((t=>t()))},i.out=function(){this.destroyPageHandler()},r}(Oi);function Xi(t,e,n){let r=t.getBoundingClientRect(),i=e.srcEvent;const o=Ui(i),a=ji(i),s=n.getBoundingClientRect();return{x:Math.max(r.left,Math.min(r.right,o))-s.left,y:Math.max(r.top,Math.min(r.bottom,a))-s.top}}var zi,Gi;a(1386);!function(t){t.CREATE_ANNOT="create-annots",t.REMOVE_ANNOT="remove-annots",t.UPDATE_ANNOT="update-annots",t.ADD_REPLY="add-reply",t.REMOVE_REPLY="remove-reply",t.ADD_REVIEW_STATE="add-review-state",t.ADD_MARKED_STATE="add-marked-state",t.UPDATE_ANNOT_CONTENT="update-comment-content",t.PPO_REMOVE_PAGE="ppo-remove-page",t.PPO_REMOVE_PAGES="ppo-remove-pages",t.PPO_INSERT_PAGE="ppo-insert-page",t.PPO_ROTATE_PAGE="ppo-rotate-page",t.PPO_MOVE_PAGE="ppo-move-page",t.MOVE_ANNOTS_BETWEEN_PAGES="move-annotations-between-pages",t.IMPORT_ANNOTATIONS_FILE="import-annotations-file"}(zi||(zi={})),function(t){t.fully="fully",t.playable="playable",t.adjustable="adjustable",t.deletable="deletable",t.modifiable="modifiable",t.attachmentDownloadable="attachmentDownloadable",t.replyable="replyable",t.editable="editable"}(Gi||(Gi={}));var qi=a(2047),Wi=a.n(qi);a(1263);let Ki=function(){function t(t,e){this.pageRender=t,this.circle=document.createElement("div"),this.circle.classList.add("eraserCircle"),this.circle.style="position:absolute; border:1px solid #000000;display:block;border-radius:50%;",this.wrapCircle=e,this.$eraserCircle=null,this.clientY,this.clientX,this.$pdfViewerElement=Wi()(this.pageRender.pdfViewer.element)}var e=t.prototype;return e.init=function(){this.$pdfViewerElement.on("scroll",(t=>{this.$eraserCircle&&this.eraserMove(t)})),this.wrapCircle.on("mouseenter",(()=>{this.wrapCircle.append(this.circle),this.$eraserCircle=Wi()(this.circle),this.$eraserCircle.css("display","block")})),this.wrapCircle.on("mousemove",(t=>{this.eraserMove(t)})),this.wrapCircle.on("mouseleave",(t=>{this.$eraserCircle&&this.$eraserCircle.remove()}))},e.eraserMove=function(t){const e=t||window.event,n=this.pageRender.pdfViewer.getStateHandlerManager().getStateHandlerConfig("eraserStateHandler"),r=n?n.width:8;let i=this.$eraserCircle?this.$eraserCircle:Wi()(this.circle);e.clientY&&(this.clientY=e.clientY),e.clientX&&(this.clientX=e.clientX);const o=i[0].getBoundingClientRect();i.width(r),i.height(r);const a=Wi()(this.wrapCircle).offset().top,s=Wi()(this.wrapCircle).offset().left,c=Wi()("html").scrollLeft(),u=this.clientY-o.height/2-a,l=this.clientX-o.width/2-s+c;i.css({top:u,left:l})},e.destroy=function(){this.$eraserCircle&&this.$eraserCircle.remove(),this.wrapCircle.off(),this.$pdfViewerElement.off("scroll")},t}();const{stateHandler:Ji,Log:Zi,ViewerEvents:Qi,shared:to,DeviceInfo:{isDesktop:eo}}=r,{Eraser:no,Point:ro}=to.eraser,io=Ji.IStateHandler,{POINT_TYPE:oo}=r.Consts,{getDevicePagePoint:ao}=Ji.StateHandlerUtils,so=Zi.LoggerFactory.getLogger("EraserStateHandler"),co=eo?8:20;let uo=function(t){function n(){var e;return(e=t.apply(this,arguments)||this).cursorStyle="fv__cursor-eraser fv__cursor-none",e.eraserCircle=null,e}e(n,t),n.getStateName=function(){return"eraser"},n.getStateHandlerName=function(){return"eraserStateHandler"};var r=n.prototype;return r.pageHandler=async function(t){this.pageRender=t;let e=t.$handler,n=new Ki(t,e);n.init(),this.eraserCircle=n,this.allInkList={},this.eraseInkList={},e.addClass(this.cursorStyle);let r=e[0],i=this.hammer=new Hammer.Manager(r,{recognizers:[[Hammer.Pan,{direction:Hammer.DIRECTION_ALL}]]});const o=t.docRender.formRender.addTask((e=>t.page.getAnnots().then((t=>t.filter((t=>"ink"===t.getType()))))),!0);let a;t.getPDFPage().then((e=>{i.on("panstart",(t=>{this.startPoint=ao(r,t),a=o.then((t=>{t.forEach((t=>{this.allInkList[t.getId()]={annot:t,inkList:t.getInkList()}}))}))})),i.on("panmove",(n=>{this.lastPoint=this.currentPoint||this.startPoint,this.currentPoint={x:this.startPoint.x+n.deltaX,y:this.startPoint.y+n.deltaY},a=a.then((n=>o.then((n=>{if(0===n.length&&!this.currentPoint)return;const r=t.pdfViewer.getStateHandlerManager().getStateHandlerConfig(this.constructor.getStateHandlerName()),i=r?r.width:co;return this.erase(e,n,this.currentPoint,i)}))))})),i.on("panend",(e=>{const n=document.getElementById("eraser");n&&n.remove(),a.then((e=>{let n=[],r=[];for(let t in this.eraseInkList){let e=this.allInkList[t],i=this.eraseInkList[t];e.isRemove=i.isRemove,n.push(e),r.push(i)}t.pdfViewer.eventEmitter.emit(Qi.eraserSuccess,n,r);const i=Object.keys(this.eraseInkList).map((t=>this.eraseInkList[t])).filter((t=>!t.isRemove)).map((t=>t.annot.exportToJSON()));this.pdfViewer.collaborate(zi.UPDATE_ANNOT,{annots:i})}))}))}))},r.erase=async function(t,e,n,r=co){const i=this.pdfViewer,o=this.pageRender,a=o.getScale(),s=o.getRotation(),[c,u]=t.reverseDevicePoint([n.x,n.y],a,s),l={x:c,y:u},h=(await(async(t,e)=>{const n=await Promise.all(t.map(e));return t.filter(((t,e)=>n[e]))})(e,(async t=>{const e=t.getRect(),n=await this.pdfViewer.getAnnotAuthorityManager();return(await n.getPermission(t)).isModifiable()?function(t,e){const n=e.x>=t.left&&e.x<=t.right,r=e.y>=t.bottom&&e.y<=t.top;return n&&r}(e,l):null}))).map((t=>{return t.$$lastErasePromise=(t.$$lastErasePromise||Promise.resolve()).then(e,e).then((e=>{let n=o.getAnnotRender(t.getId());return this.eraseInkList[t.getId()]={annot:t,inkList:t.getInkList(),isRemove:!n},e}));function e(){const e=t.getInkList(),n=new no(r/2).erase(e.map((t=>new ro(t.x,t.y,t.type))),new ro(c,u)).reduceRight(((t,e)=>{const n=t[0];return n&&n.type===oo.MOVE_TO&&n.type===e.type||t.unshift(e),t}),[]),a=(s=n,s.reduce(((t,e)=>(e.type===oo.MOVE_TO&&t.push([]),t[t.length-1].push(e),t)),[])).filter((t=>{if(t.length<1)return!1;{let e=t[0],n=0;return t.forEach((t=>{n+=t.distanceTo(e),e=t})),n>.01}}));var s;if(0===a.length){const e=o.getAnnotRender(t.getId());if(e){let t=e.component.annot;return t.getPDFPage().removeAnnot(t).then((()=>{i.collaborate(zi.REMOVE_ANNOT,[{annotId:t.getUniqueID(),pageIndex:o.index}])}))}return void so.debug("annotRender === undefined",e,a,n)}const l=a.reduce(((t,e)=>t.concat(e)),[]);return t.setInkList(l)}}));return Promise.all(h)},r.destroyPageHandler=function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle),this.eraserCircle.destroy()},r.out=function(){this.destroyPageHandler()},n}(io);a(8730),a(9307);var lo=(t,e="en-US")=>{t.endsWith("/")||(t+="/"),e=e.replace(/(\w*?)-(\w*)/,((t,e,n)=>e+"-"+n.toUpperCase()));return((n,r,i)=>({[i]:{Approved:{url:`${t}stamps/${e}/DynamicStamps/Approved.pdf`,fileType:"pdf"},Revised:{url:`${t}stamps/${e}/DynamicStamps/Revised.pdf`,fileType:"pdf"},Reviewed:{url:`${t}stamps/${e}/DynamicStamps/Reviewed.pdf`,fileType:"pdf"},Received:{url:`${t}stamps/${e}/DynamicStamps/Received.pdf`,fileType:"pdf"},Confidential:{url:`${t}stamps/${e}/DynamicStamps/Confidential.pdf`,fileType:"pdf"}},[r]:{Accepted:{url:`${t}stamps/${e}/SignHere/Accepted.pdf`,fileType:"pdf"},Witness:{url:`${t}stamps/${e}/SignHere/Witness.pdf`,fileType:"pdf"},SignHere:{url:`${t}stamps/${e}/SignHere/SignHere.pdf`,fileType:"pdf"},Rejected:{url:`${t}stamps/${e}/SignHere/Rejected.pdf`,fileType:"pdf"},Initial:{url:`${t}stamps/${e}/SignHere/Initial.pdf`,fileType:"pdf"}},[n]:{Approved:{url:`${t}stamps/${e}/StandardStamps/Approved.pdf`,fileType:"pdf"},Void:{url:`${t}stamps/${e}/StandardStamps/Void.pdf`,fileType:"pdf"},Verified:{url:`${t}stamps/${e}/StandardStamps/Verified.pdf`,fileType:"pdf"},Revised:{url:`${t}stamps/${e}/StandardStamps/Revised.pdf`,fileType:"pdf"},Reviewed:{url:`${t}stamps/${e}/StandardStamps/Reviewed.pdf`,fileType:"pdf"},Received:{url:`${t}stamps/${e}/StandardStamps/Received.pdf`,fileType:"pdf"},Final:{url:`${t}stamps/${e}/StandardStamps/Final.pdf`,fileType:"pdf"},Expired:{url:`${t}stamps/${e}/StandardStamps/Expired.pdf`,fileType:"pdf"},Emergency:{url:`${t}stamps/${e}/StandardStamps/Emergency.pdf`,fileType:"pdf"},Draft:{url:`${t}stamps/${e}/StandardStamps/Draft.pdf`,fileType:"pdf"},Confidential:{url:`${t}stamps/${e}/StandardStamps/Confidential.pdf`,fileType:"pdf"},Completed:{url:`${t}stamps/${e}/StandardStamps/Completed.pdf`,fileType:"pdf"}}})).apply(void 0,["Static","SignHere","Dynamic"])};const{DeviceInfo:ho,PDFViewer:fo,shared:{Store:po}}=r;var go;function mo(){return(Math.random()+"").substring(2)+Date.now()}!function(t){t.CUSTOM_STAMP_LIST_ADDED="custom-stamps-added",t.CUSTOM_STAMP_LIST_REMOVED="custom-stamps-removed",t.CUSTOM_STAMP_LIST_UPDATED="custom-stamps-updated",t.DEFAULT_STAMP_LIST_UPDATED="default-stamps-updated",t.DEFAULT_STAMP_LIST_REMOVED="default-stamps-removed",t.SWITCH_STAMP_ICON="switch-stamp-icon"}(go||(go={}));let vo=function(){function t(){this.customStamps={},this.defaultStamps={},this.store=new po,this.defaultStampRewrited=!1;const t=document.createElement("img");t.draggable=!1,t.style.cssText="position: absolute;opacity:0.5",this.currentPreviewerImg=t}t.inject=function(){return{pdfViewer:fo}};var e=t.prototype;return e.setCurrentStamp=function(t,e,n="",r,i=150,o=45){const a=this.currentStamp,s=this.currentStamp=this.getStampIcon(t,e,n,r,i,o);if(!s)throw new Error(`Stamp not found: category: ${t}, name: ${e}`);this.currentPreviewerImg.src=s.showUrl||"",Promise.resolve().then((()=>{this.store.dispatch(go.SWITCH_STAMP_ICON,{current:this.currentStamp,last:a})}))},e.onSwitchStamp=function(t){return this.store.subscribe(go.SWITCH_STAMP_ICON,(e=>{t(e.current,e.last)}))},e.getCurrentStampConfig=function(){return this.currentStamp},e.getPreviewerImage=function(){return this.currentPreviewerImg},e.setDefaultStamps=function(t={}){this.defaultStamps=t,this.defaultStampRewrited=!0,this.store.dispatch(go.DEFAULT_STAMP_LIST_UPDATED,t)},e.setCustomStamps=function(t={}){this.customStamps=t,this.store.dispatch(go.CUSTOM_STAMP_LIST_UPDATED,t)},e.updateDefaultStamps=function(t,e){if(this.defaultStampRewrited)return;const n=this.pdfViewer.libPath,r=this.pdfViewer.getCurrentLanguage(),i=n+r;if(this.lastKey===i)return;this.lastKey=i;const o=lo(n,r);if(t){const{category:e,name:n}=t;o[e]=o[e]||{},o[e][n]=t}if(e){const{category:t,name:n}=e;o[t]&&(delete o[t][n],0===Object.keys(o[t]).length&&delete o[t])}this.defaultStamps=o,this.store.dispatch(go.DEFAULT_STAMP_LIST_UPDATED,o)},e.getDefaultStamps=function(){return this.defaultStamps},e.getCustomStamps=function(){return this.customStamps},e.getFavoriteStamps=function(){var t,e,r;this.updateDefaultStamps();let i=this.pdfViewer.getDeprecatedStorage().getItem("FAVORITE-STAMPS-LIST");const o=this.pdfViewer.viewerUI.rootComponent.pdfUI;o.customs&&o.customs.stampManager&&(i=o.customs.stampManager.getFavoriteStamps());const a=this.getDefaultStamps(),s=this.getCustomStamps(),c=n({},a);if(!i)return c;if(0===i.length)return c;const u={};for(let o=0;o<i.length;o++){const c=i[o].split("."),l=c[0],h=c[1],d=c[2];let f,p={};if(null===(e=null===(t=null==a?void 0:a[l])||void 0===t?void 0:t[h])||void 0===e?void 0:e.url)f=a[l][h].url,u[l+"-"+h]=n({fileType:"pdf",url:f},p);else{let t=null===(r=null==s?void 0:s[l])||void 0===r?void 0:r[h];if(!t)continue;if(Array.isArray(t)){let e=t.find((t=>t.index==d));f=e.url,p.width=e.width,p.height=e.height,p.fileType=e.fileType}else f=t.url,p.width=t.width,p.height=t.height,p.fileType=t.fileType;if(!f)continue;u[l+"-"+h+"-"+d]=n({fileType:"pdf",url:f},p)}}return c.Favorite=u,c},e.getStampIcon=function(t,e,r="",i,o=150,a=45){let s=this.defaultStamps[t]&&this.defaultStamps[t][e],c=this.customStamps[t];if(!s&&c){const t=c[e];s=Array.isArray(t)?t.find((t=>t.index==r)):t}if(!s){let n=this.getFavoriteStamps()[t];if(n){const t=n[e];s=Array.isArray(t)?t.find((t=>t.index==r)):t}}if(s=s||i,!s)return;const u=s.width||o,l=s.height||a;let h=s.showUrl||s.url;if(!ho.isTouchDevice){h=h.replace(/\.(pdf|tif|tiff)$/,".svg");let t=new XMLHttpRequest;t.open("get",h),t.send()}return n({},s,{width:u,height:l,showUrl:h,category:t,name:e})},e.clearCustomStamps=function(){this.customStamps={}},e.addAnnotationIcon=function(t,e=!1){let{category:n,name:r}=t;n in this.customStamps||(this.customStamps[n]={leaf:1});let i=this.customStamps[n][r];e||(i||(i=this.customStamps[n][r]=[]),Array.isArray(i)?(t.index||(t.index=mo()),i.push(t)):(i.index||(i.index=mo()),t.index||(t.index=mo()),this.customStamps[n][r]=[i,t])),this.store.dispatch(go.CUSTOM_STAMP_LIST_ADDED,this.customStamps,t)},e.removeAnnotationIcon=function(t){this.removeIcon(this.customStamps,t)?this.store.dispatch(go.CUSTOM_STAMP_LIST_REMOVED,this.customStamps,t):this.removeIcon(this.defaultStamps,t)&&this.store.dispatch(go.DEFAULT_STAMP_LIST_REMOVED,this.defaultStamps,t)},e.onCustomStampRemoved=function(t){return this.store.subscribe(go.CUSTOM_STAMP_LIST_REMOVED,t)},e.onCustomStampAdded=function(t){return this.store.subscribe(go.CUSTOM_STAMP_LIST_ADDED,t)},e.onDefaultStampRemoved=function(t){return this.store.subscribe(go.DEFAULT_STAMP_LIST_REMOVED,t)},e.onDefaultStampUpdated=function(t){return this.store.subscribe(go.DEFAULT_STAMP_LIST_UPDATED,t)},e.removeIcon=function(t,e){const{category:n,name:r,index:i}=e;let o;for(var a in t){let e=t[a];for(let t in e){let s=e[t];if(r){if(n==a&&t==r){if(Array.isArray(s)){if(void 0===i){delete e[t];continue}e[t]=s.reduce(((t,e,n)=>(i.length>1&&i==e.index||n+""==i||t.push(e),t)),[]);let n=e[t];Array.isArray(n)&&(n.length||delete e[t])}else delete e[t];o=!0}}else n?a==n&&(delete e[t],o=!0):delete e[t]}Object.values(e).some((t=>Array.isArray(t)||"[object Object]"===Object.prototype.toString.call(t)))||delete t[a]}return o},t}();const{stateHandler:yo,ViewerEvents:wo}=r,{jQuery:So,Hammer:Ao}=r.vendors,xo=yo.IStateHandler,{STATE_HANDLER_CREATE_STAMP:bo}=yo.StateHandlerConsts,{getClientX:Ro,getClientY:Eo}=r.shared,{isTouchDevice:To}=r.DeviceInfo;let Po=function(t){function r(e){return t.call(this,e)||this}e(r,t),r.getStateName=function(){return bo},r.setParams=function(t,e){const{category:n,name:r,index:i}=t,o=e.getIoC().getInstanceByClass(vo);try{t.url&&t.fileType?o.setCurrentStamp(n,r,i,t):o.setCurrentStamp(n,r,i,void 0)}catch(t){return console.error(t),void Promise.resolve().then((()=>{e.getStateHandlerManager().switchTo()}))}const a=o.getPreviewerImage(),s=o.getCurrentStampConfig(),{width:c,height:u,showUrl:l}=s;To||(a.style.cssText+=`\n                width: ${4*c/3}px;\n                height: ${4*u/3}px;\n            `,a.src=l,"pdf"==s.fileType&&setTimeout((()=>{e.previewIconDoc(s).then((t=>{a.parentElement&&(a.src=URL.createObjectURL(t))}))}),100))};var i=r.prototype;return i.pageHandler=function(t){this.pageRender=t;let e=t.$handler,r=t.pdfViewer;e.addClass("fv__create-stamp-state-handler");let i=!1,o=e[0],a=this.hammer=new Ao.Manager(o,{recognizers:[[Ao.Tap]]});const s=r.getIoC().getInstanceByClass(vo),c=s.getPreviewerImage();this.previewStampImg=c;function u(n){const r=s.getCurrentStampConfig();let i=o.getBoundingClientRect(),a=n.clientX-i.left,u=n.clientY-i.top;To||(c.style.cssText+=`\n                    transform: scale(${t.getScale()});\n                    top: ${u-2*r.height/3}px;\n                    left: ${a-2*r.width/3}px;\n                `,c.style.display="",e.append(c))}r.getStore().subscribe("switchStampEvent",(t=>{u(t)})),this.addEvent(e,"mousemove",(t=>{i||u(t)})),a.on("tap",(e=>{if(i)return;let a=o.getBoundingClientRect(),u=e.srcEvent,l="";const h=Ro(u),d=Eo(u);let f=[h-a.left,d-a.top];const p=f[0],g=f[1];i=!0;const{width:m,height:v,category:y,name:w,fileType:S,url:A,field:x}=s.getCurrentStampConfig();return t.getPDFPage().then((e=>{let r=2*m/3*t.scale,i=2*v/3*t.scale,o={left:p-r,right:p+r,top:g-i,bottom:g+i};o=e.reverseDeviceRect(o,t.scale,t.getRotation());let a={rotation:((360-90*e.getRotation()-t.getRotation())%360+360)%360,type:"stamp",flags:4,rect:o,subject:t.pdfViewer.i18n.t("viewer_:annotSubjects.Stamp"),iconInfo:{category:y,name:w,fileType:S,url:A,field:x}};return n(a,t.pdfViewer.getDefaultAnnotConfig()("stamp")||{}),e.addAnnot(a)})).then((e=>{const n=t.annotsRender.getAnnotRender(e[0].objectNumber).component;return l=n,t.pdfViewer.eventEmitter.emit(wo.addAnnotSuccess,n.annot),n})).then((e=>{t.pdfViewer.getStateHandlerManager().switchTo(),e.getRenderPromise().finally((()=>{setTimeout((()=>{c.style.cssText+="\n                                    display: none;\n                                    opacity: 0.5;\n                                "}),500),c.style.opacity=1})),i=!1,r.activeElement(e),r.config.showCommentList&&l.showReplyDialog()})).catch((()=>{i=!1,c.style.cssText+="\n                        display: none;\n                        opacity: 0.5;\n                    "}))}))},i.destroyPageHandler=function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass("fv__create-stamp-state-handler");const t=this.previewStampImg;t.parentElement&&t.parentElement.removeChild(t),this.destroyList.map((([t,e,n])=>{t.off(e,n)}))},i.out=function(){this.destroyPageHandler()},i.addEvent=function(t,e,n){this.destroyList=this.destroyList||[],t.on(e,n),this.destroyList.push([t,e,n])},r}(xo);a(9976),a(3356);const{stateHandler:Co,ViewerEvents:_o}=r,Io=Co.IStateHandler,Do=Co.HandStateHandler,{Hammer:Mo,jQuery:Lo}=r.vendors,{DebouncePromiseQueue:ko,getClientX:Vo,getClientY:Ho}=r.shared,{getDevicePagePoint:Oo,deltaDeviceRect:No,appendSelectMark:Uo,removeSelectMark:jo}=Co.StateHandlerUtils,{STATE_HANDLER_CREATE_FILE_ATTACHMENT:Fo}=Co.StateHandlerConsts;let Bo=function(t){function n(e){var n;return(n=t.call(this,e)||this).cursorStyle="fv__cursor-file",n}e(n,t),n.getStateName=function(){return Fo};var r=n.prototype;return r.pageHandler=function(t){this.pageRender=t;let e=t.$handler;e.addClass(this.cursorStyle);const n=Lo('<input id="fileAttachment" type="file" style="display: none;"/>');this.$fileAttachment=n,e.append(n);let r=e[0];(this.hammer=new Mo.Manager(r,{recognizers:[[Mo.Tap]]})).on("tap",(function(e){let i=r.getBoundingClientRect(),o=e.srcEvent;const a=Vo(o),s=Ho(o);let c=[a-i.left,s-i.top];const u=c[0],l=c[1],h=t.pdfViewer;n.off("change").on("change",(function(e){let n=e.target.files[0];if(n&&!(h.customs&&h.customs.isAttachFileOverSize&&h.customs.isAttachFileOverSize(n)))if(n.size>268435456)h.viewerUI.confirm({message:"sidebar.attachment.addAttachmentSizeLimit",level:"warning"});else{if(!(["exe"].indexOf(n.name.split(".")[1])>=0))return t.getPDFPage().then((e=>{let r=new FileReader;const[i,o]=e.reverseDevicePoint([u,l],t.scale,t.getRotation());r.readAsArrayBuffer(n),r.onload=()=>{let a=new Uint8Array(r.result);e.addAnnot({flags:28,type:"fileattachment",rect:{left:i,right:i+20,top:o,bottom:o-24},buffer:a,fileName:n.name,file:n,subject:h.i18n.t("viewer_:annotSubjects.File")}).then((e=>{const n=e[0],r=t.annotsRender.getAnnotRender(n.getId()).component;h.eventEmitter.emit(_o.addAnnotSuccess,r.annot),h.getStateHandlerManager().switchTo(Do.getStateName()),t.annotsRender.activeAnnot(n.getId())}))}}));h.viewerUI.confirm({message:"sidebar.attachment.addAttachmentFileFormat",level:"warning"})}})),n.click()}))},r.destroyPageHandler=function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle),this.$fileAttachment.remove()},r.out=function(){this.destroyPageHandler()},n}(Io);var $o;!function(t){t.STATE_HANDLER_HAND="hand",t.STATE_HANDLER_CHECK_THE_SEARCH="checkTheSearch",t.STATE_HANDLER_CREATE_CARET="createCaret",t.STATE_HANDLER_CREATE_ARROW="createArrow",t.STATE_HANDLER_CREATE_AREA_HIGHLIGHT="createAreaHighlight",t.STATE_HANDLER_CREATE_CREATE_AREA_HIGHLIGHT="createAreaHighlight",t.STATE_HANDLER_CREATE_CIRCLE="createCircle",t.STATE_HANDLER_CREATE_FILE_ATTACHMENT="createFileAttachment",t.STATE_HANDLER_CREATE_HIGHLIGHT="createHighlight",t.STATE_HANDLER_CREATE_IMAGE="createImage",t.STATE_HANDLER_CREATE_LINK="createLink",t.STATE_HANDLER_CREATE_LINE="createLine",t.STATE_HANDLER_CREATE_DISTANCE="createDistance",t.STATE_HANDLER_CREATE_PERIMETER="createPerimeter",t.STATE_HANDLER_CREATE_AREA="createArea",t.STATE_HANDLER_CREATE_CIRCLE_AREA="createCircleArea",t.STATE_HANDLER_CREATE_PENCIL="createPencil",t.STATE_HANDLER_CREATE_POLYGON_CLOUD="createPolygonCloud",t.STATE_HANDLER_CREATE_POLYGON="createPolygon",t.STATE_HANDLER_CREATE_POLYLINE="createPolyline",t.STATE_HANDLER_CREATE_REPLACE="createReplace",t.STATE_HANDLER_CREATE_SQUARE="createSquare",t.STATE_HANDLER_CREATE_SQUIGGLY="createSquiggly",t.STATE_HANDLER_CREATE_STAMP="createStamp",t.STATE_HANDLER_CREATE_STRIKE_OUT="createStrikeOut",t.STATE_HANDLER_CREATE_TEXT="createText",t.STATE_HANDLER_CREATE_UNDERLINE="createUnderline",t.STATE_HANDLER_MARQUEE="marquee",t.STATE_HANDLER_ERASER="eraser",t.STATE_HANDLER_LOUPE="loupe",t.STATE_HANDLER_SELECT_TEXT_ANNOTATION="select-text-annotation",t.STATE_HANDLER_SELECT_TEXT_IMAGE="select-text-image",t.STATE_HANDLER_SELECT_ANNOTATION="select-annotation",t.STATE_HANDLER_CREATE_FREETEXT_BOX="createFreeTextBox",t.STATE_HANDLER_CREATE_FREETEXT_CALLOUT="createFreeTextCallout",t.STATE_HANDLER_CREATE_FREETEXT_TYPEWRITER="createFreeTextTypewriter",t.STATE_HANDLER_CREATE_FIELD_TEXT="CreateTextStateHandler",t.STATE_HANDLER_CREATE_FIELD_SIGNATURE="CreateSignStateHandler",t.STATE_HANDLER_CREATE_FIELD_PUSH_BUTTON="CreatePushButtonStateHandler",t.STATE_HANDLER_CREATE_FIELD_CHECK_BOX="CreateCheckBoxStateHandler",t.STATE_HANDLER_CREATE_RADIO_BUTTON="CreateRadioButtonStateHandler",t.STATE_HANDLER_CREATE_FIELD_COMBO_BOX="CreateComboBoxStateHandler",t.STATE_HANDLER_CREATE_FIELD_LIST_BOX="CreateListBoxStateHandler",t.STATE_HANDLER_CREATE_FIELD_DATE="CreateDateStateHandler",t.STATE_HANDLER_CREATE_FIELD_IMAGE="CreateImageStateHandler",t.STATE_HANDLER_SNAPSHOT_TOOL="snapshot-tool"}($o||($o={}));const Yo="userSpaceUnit",Xo="userSpaceScaleValue",zo="realUnit",Go="realScaleValue";$o.STATE_HANDLER_CREATE_PERIMETER,$o.STATE_HANDLER_CREATE_DISTANCE,$o.STATE_HANDLER_CREATE_AREA,$o.STATE_HANDLER_CREATE_CIRCLE_AREA;let qo=function(t){function n(e,n){var r;return(r=t.call(this,e)||this).target=n,r}return e(n,t),n.prototype.init=function(){let t,e,n,r;const i=n=>{if(0===n.button)if(this.isStarted){if(this.isStarted){r=null,this.isStarted=!1;const i=n.clientX-t,o=n.clientY-e;this.emit("end",{deltaX:i,deltaY:o,srcEvent:n})}}else r=this.target.getBoundingClientRect(),this.isStarted=!0,t=n.clientX,e=n.clientY,this.emit("start",{deltaX:0,deltaY:0,srcEvent:n})},o=r=>{if(this.isLocked)return;if(!this.isStarted){const t=this.target.getBoundingClientRect(),e=r.clientX-t.left,n=r.clientY-t.top;return void this.emit("mousemove",{x:e,y:n})}const i=r.clientX-t,o=r.clientY-e;this.emit("move",n={deltaX:i,deltaY:o,srcEvent:r})},a=()=>{this.isStarted&&(r=null,this.isStarted=!1,this.unlock(),this.emit("cancel"))},s=()=>{this.isStarted&&(r=null,this.isStarted=!1,this.unlock(),this.emit("end",n))},c=n=>{if(!this.isStarted||this.isDestroyed||this.isLocked||!r)return;const i=this.target.getBoundingClientRect(),o=t-r.left,a=e-r.top,s=i.width/r.width;t=i.left+o*s,e=i.top+a*s,r=i};window.addEventListener("scroll",c,!0),this.target.addEventListener("mousedown",i),document.addEventListener("mousemove",o,!0);const u=this.pdfViewer.getStore().subscribe("create-measurement-status",(t=>{switch(t){case"complete":s();break;case"cancel":a()}}));this.addDestroyHook((()=>{this.target.removeEventListener("mousedown",i),document.removeEventListener("mousemove",o),u(),window.removeEventListener("scroll",c,!0)}))},n}(kn);const{CreateMeasurementService:Wo}=r.stateHandler;let Ko=[];const{ViewerEvents:Jo,DeviceInfo:{isTouchDevice:Zo},Consts:{LineEndingStyle:Qo,Intents:ta,CREATING_MEASUREMENT_CONTEXTMENU:ea},shared:{ThrottleAsyncTaskExecutor:na}}=r,{isSamePoint:ra}=r.commons;let ia=function(t){function r(e){var n;return(n=t.call(this,e,Qo.OpenArrow,Qo.OpenArrow)||this).isEnd=!0,n.executor=new na(20,!0),n}e(r,t),r.getStateName=function(){return"createDistance"};var i=r.prototype;return i.createInteractionTool=function(e,n){return Zo?t.prototype.createInteractionTool.call(this,e,n):new qo(this.pdfViewer,e)},i.getMeasurementInfo=function(){const t=this.pdfViewer.getIoC().getInstanceByClass(Wo).getMeasurementInfo();return{unit:t[zo].name,ratio:{userSpaceValue:t[Xo],userSpaceUnit:t[Yo].name,realValue:t[Go],realUnit:t[zo].name}}},i.createAnnotJson=function(t){return t.intent=ta.LINE_DIMENSION,t.enableCaption=!0,t.measure=this.getMeasurementInfo(),n(t,this.pdfViewer.getDefaultAnnotConfig()("line","LineDimension")),t},i.pageHandler=function(e){let n;t.prototype.pageHandler.call(this,e),this.destroyPageHooks=[];let r=this.pdfViewer.viewerUI.createContextMenu(ea,e.$handler.get(0),{selector:".fv__pdf-page-handler-container",items:{complete:{name:this.pdfViewer.i18n.t("viewer_:contextmenu.measurement.complete"),callback:()=>{this.interaction.unlock(),this.interaction.emit("end",n)}},cancel:{name:this.pdfViewer.i18n.t("viewer_:contextmenu.measurement.cancel"),callback:()=>{this.interaction.unlock(),this.interaction.emit("cancel")}}}});const i=r.getItem("complete");r.disable(),this.creatingContextmenu=r,this.interaction.on("start",(()=>{this.isEnd=!1,r.enable()})),this.interaction.on("end",(()=>{this.isEnd=!0,r.disable()})),this.interaction.on("cancel",(()=>{r.disable()})),this.interaction.on("move",(t=>{n=t})),r.onHidden((()=>{this.interaction.unlock()})),r.onShown((()=>{this.interaction.lock(),i.enable()})),this.destroyPageHooks.push(this.pdfViewer.addEventListener(Jo.zoomToSuccess,(t=>{gn(Ko)})),this.pdfViewer.addEventListener(Jo.changeViewModeSuccess,((t,e)=>{gn(Ko)})),this.pdfViewer.addEventListener(Jo.fitWidthResizeViewport,(()=>{gn(Ko)})))},i.start=function(e,n){gn(Ko);const r=t.prototype.start.call(this,e,n,"Distance");return this.pdfViewer.eventEmitter.emit(Jo.distanceAnnotCreationStart,r),this.unsubscribeMeasurementData=this.pdfViewer.getStore().subscribe("measurementData",(t=>{const e=fn(this.pdfViewer),n=Ae(t.displayUnit.name)?this.pdfViewer.i18n.t(`measurement.units.${t.displayUnit.name}`):t.displayUnit.name;r.setContent(e+Math.round(100*t.distance)/100+" "+n),r.draw()})),r},i.adjust=function(t,e){this.executor.exec((()=>this.getSnappedPoint(e).then((n=>{ra(e,n)?this.snappedPointAssistant.hide():(this.snappedPointAssistant.setPosition(n.x,n.y),this.snappedPointAssistant.show(n.type)),this.pdfViewer.eventEmitter.emit(Jo.updateDistanceAnnot,t),t.setEndPoint(n),t.draw()}))))},i.end=function(){this.fakeAnnotation&&this.fakeAnnotation.annotationInfo.content&&(this.unsubscribeMeasurementData&&this.unsubscribeMeasurementData(),this.executor.waitForLastTask().then((()=>{const{markup:e}=pn(this.pdfViewer);if(e)this.fakeAnnotation.annotationInfo.measure=this.getMeasurementInfo(),this.pdfViewer.eventEmitter.emit(Jo.distanceAnnotCreationEnd,this.fakeAnnotation),t.prototype.end.call(this);else{this.fakeAnnotation.renderer.setMarkUp(this.pageRender.scale,this.pageRender.rotate),Ko.push(this.fakeAnnotation)}return Promise.resolve()})))},i.cancel=function(){this.fakeAnnotation&&(this.executor.cancel(),this.pdfViewer.eventEmitter.emit(Jo.distanceAnnotCreationCancel,this.fakeAnnotation),t.prototype.cancel.call(this),this.creatingContextmenu&&this.creatingContextmenu.disable())},i.destroyPageHandler=function(){this.isEnd||this.cancel(),this.creatingContextmenu&&this.creatingContextmenu.destroy(),this.destroyPageHooks&&this.destroyPageHooks.forEach((t=>t())),gn(Ko),t.prototype.destroyPageHandler.call(this)},r}(ar),oa=function(t){function n(e,n){var r;return(r=t.call(this,e,n,"create-measurement-status")||this).target=n,r}return e(n,t),n}(Tr);const{CreateMeasurementService:aa}=r.stateHandler;let sa=[];const{ViewerEvents:ca,DeviceInfo:{isTouchDevice:ua},Consts:{LineEndingStyle:la,Intents:ha,CREATING_MEASUREMENT_CONTEXTMENU:da},shared:{ThrottleAsyncTaskExecutor:fa}}=r;let pa=function(t){function r(e){var n;return(n=t.call(this,e)||this).isEnd=!0,n}e(r,t),r.getStateName=function(){return"createPerimeter"};var i=r.prototype;return i.createInteractionTool=function(t){return new oa(this.pdfViewer,t)},i.getMeasurementInfo=function(){const t=this.pdfViewer.getIoC().getInstanceByClass(aa).getMeasurementInfo();return{unit:t[zo].name,ratio:{userSpaceValue:t[Xo],userSpaceUnit:t[Yo].name,realValue:t[Go],realUnit:t[zo].name}}},i.createAnnotJson=function(t){const e=this.pdfViewer.getDefaultAnnotConfig()("polyline",ha.POLYLINE_DIMENSION);return t.intent=ha.POLYLINE_DIMENSION,t.startStyle=la.OpenArrow,t.endStyle=la.OpenArrow,t.enableCaption=!0,t.measure=this.getMeasurementInfo(),t.subject=this.pdfViewer.i18n.t("viewer_:annotSubjects.Perimeter"),n(t,e)},i.pageHandler=function(e){let n;t.prototype.pageHandler.call(this,e),this.contextmenu=this.pdfViewer.viewerUI.createContextMenu(da,e.$handler.get(0),{selector:".fv__pdf-page-handler-container",items:{complete:{name:this.pdfViewer.i18n.t("viewer_:contextmenu.measurement.complete"),callback:()=>{this.interaction.unlock(),this.interaction.emit("end",n)}},cancel:{name:this.pdfViewer.i18n.t("viewer_:contextmenu.measurement.cancel"),callback:()=>{this.interaction.unlock(),this.interaction.emit("cancel")}}}}),this.contextmenu.disable(),this.completeMenuItem=this.contextmenu.getItem("complete"),this.completeMenuItem.disable(),this.creatingContextmenu=this.contextmenu,this.interaction.on("start",(()=>{this.isEnd=!1,this.contextmenu.enable(),this.completeMenuItem.disable(),gn(sa),this.pdfViewer.eventEmitter.emit(ca.perimeterAnnotCreationStart,this.fakeAnnotation)})),this.interaction.on("end",(()=>{})),this.interaction.on("cancel",(()=>{this.contextmenu.disable()})),this.interaction.on("move",(t=>{n=t})),this.contextmenu.onHidden((()=>{this.interaction.unlock()})),this.contextmenu.onShown((()=>{this.interaction.lock(),this.fakeAnnotation.getVertexes().length>=3?this.completeMenuItem.enable():this.completeMenuItem.disable()})),this.destroyPageHooks.push(this.pdfViewer.addEventListener(ca.zoomToSuccess,(t=>{gn(sa)})),this.pdfViewer.addEventListener(ca.changeViewModeSuccess,((t,e)=>{gn(sa)})),this.pdfViewer.addEventListener(ca.fitWidthResizeViewport,(()=>{gn(sa)})))},i.create=function(e,n){const r=t.prototype.create.call(this,e,n);return this.unsubscribeMeasurementData=this.pdfViewer.getStore().subscribe("measurementData",(t=>{const e=fn(this.pdfViewer),n=Ae(t.displayUnit.name)?this.pdfViewer.i18n.t(`measurement.units.${t.displayUnit.name}`):t.displayUnit.name;r.setContent(e+Math.round(100*t.perimeter)/100+" "+n),r.draw()})),r},i.adjust=function(t,e){e=this.autoAdsorbToStartPoint(t,e)[1],t.setLastPoint(e.deviceX,e.deviceY),this.pdfViewer.eventEmitter.emit(ca.updateDistanceAnnot,t),t.draw()},i.canBeCompleted=function(t){if(!t)return!1;let e=t.getVertexes();if(0==e.length)return!1;let n=t.getLastPoint();return!(1==e.length&&n&&Math.abs(e[0].x-n.x)<Number.EPSILON&&Math.abs(e[0].y-n.y)<Number.EPSILON)},i.end=function(e,n){if(!this.fakeAnnotation)return;if(this.unsubscribeMeasurementData&&this.unsubscribeMeasurementData(),this.fakeAnnotation.getVertexes().length<2)return-1;n=this.autoAdsorbToStartPoint(e,n)[1],this.isEnd=!0,this.contextmenu.disable();const{markup:r}=pn(this.pdfViewer);if(r)this.fakeAnnotation.annotationInfo.measure=this.getMeasurementInfo(),this.pdfViewer.eventEmitter.emit(ca.distanceAnnotCreationEnd,this.fakeAnnotation),e.annotationInfo.measure=this.fakeAnnotation.annotationInfo.measure,t.prototype.end.call(this,e,n);else{this.fakeAnnotation.renderer.setMarkUp(this.pageRender.scale,this.pageRender.rotate),sa.push(this.fakeAnnotation)}},i.cancel=function(){this.fakeAnnotation&&(this.pdfViewer.eventEmitter.emit(ca.distanceAnnotCreationCancel,this.fakeAnnotation),t.prototype.cancel.call(this),this.creatingContextmenu&&this.creatingContextmenu.disable())},i.destroyPageHandler=function(){this.isEnd||this.cancel(),gn(sa),t.prototype.destroyPageHandler.call(this)},i.autoAdsorbToStartPoint=function(t,e){let n=!1;const r=t.deviceVertexes;if(r.length>2){const t=r[0],i=Math.abs(e.deviceX-t.x),o=Math.abs(e.deviceY-t.y),a=Math.max(i,o);a*a<200&&(n=!0,e={deviceX:t.x,deviceY:t.y})}return[n,e]},i.addPoint=function(e,n){const r=this.autoAdsorbToStartPoint(e,n);if(r[0])return this.interaction.cancel(),this.interaction.unlock(),this.interaction.lastMoveData=null,void this.end(e,r[1]);t.prototype.addPoint.call(this,e,n)},r}(hi),ga=function(t){function n(e,n){var r;return(r=t.call(this,e,n,"create-measurement-status")||this).target=n,r}return e(n,t),n}(Tr);const{CreateMeasurementService:ma}=r.stateHandler;let va=[];const{ViewerEvents:ya,Consts:{Intents:wa,CREATING_MEASUREMENT_CONTEXTMENU:Sa,DISTANCE_TOLERANCE:Aa,POINT_TOLERANCE:xa}}=r;function ba(t,e){return t.x===e.x&&t.y===e.y}function Ra(t,e){return t.x*e.y-t.y*e.x}function Ea(t,e,n,r){let i=Ra({x:r.x-n.x,y:r.y-n.y},{x:t.x-n.x,y:t.y-n.y}),o=Ra({x:r.x-n.x,y:r.y-n.y},{x:e.x-n.x,y:e.y-n.y}),a=Ra({x:e.x-t.x,y:e.y-t.y},{x:n.x-t.x,y:n.y-t.y}),s=Ra({x:e.x-t.x,y:e.y-t.y},{x:r.x-t.x,y:r.y-t.y});return(i>0&&o<0||i<0&&o>0)&&(a>0&&s<0||a<0&&s>0)||!!(0===i&&ba(t,n)||0===o&&ba(t,r)||0===a&&ba(e,n)||0===s&&ba(e,r))}let Ta=function(t){function r(e){var n;return(n=t.call(this,e)||this).isEnd=!0,n}e(r,t),r.getStateName=function(){return"createArea"};var i=r.prototype;return i.createInteractionTool=function(t){return new ga(this.pdfViewer,t)},i.getMeasurementInfo=function(){const t=this.pdfViewer.getIoC().getInstanceByClass(ma).getMeasurementInfo();return{unit:t[zo].name,ratio:{userSpaceValue:t[Xo],userSpaceUnit:t[Yo].name,realValue:t[Go],realUnit:t[zo].name}}},i.createAnnotJson=function(t){const e=this.pdfViewer.getDefaultAnnotConfig()("polygon",wa.POLYGON_DIMENSION);return t.enableCaption=!0,t.intent=wa.POLYGON_DIMENSION,t.measure=this.getMeasurementInfo(),t.subject=this.pdfViewer.i18n.t("viewer_:annotSubjects.Area"),n(t,e)},i.pageHandler=function(e){let n;t.prototype.pageHandler.call(this,e),this.destroyPageHooks=[],this.contextmenu=this.pdfViewer.viewerUI.createContextMenu(Sa,e.$handler.get(0),{selector:".fv__pdf-page-handler-container",items:{complete:{name:this.pdfViewer.i18n.t("viewer_:contextmenu.measurement.complete"),callback:()=>{this.interaction.unlock(),this.interaction.emit("end",n)}},cancel:{name:this.pdfViewer.i18n.t("viewer_:contextmenu.measurement.cancel"),callback:()=>{this.interaction.unlock(),this.interaction.emit("cancel")}}}}),this.contextmenu.disable(),this.completeMenuItem=this.contextmenu.getItem("complete"),this.completeMenuItem.disable(),this.creatingContextmenu=this.contextmenu,this.interaction.on("start",(()=>{this.isEnd=!1,this.contextmenu.enable(),this.completeMenuItem.disable(),gn(va)})),this.interaction.on("end",(()=>{})),this.interaction.on("cancel",(()=>{this.contextmenu.disable()})),this.interaction.on("move",(t=>{n=t,this.fakeAnnotation&&this.fakeAnnotation.renderer&&(this.fakeAnnotation.renderer.closing=!0)})),this.contextmenu.onHidden((()=>{this.interaction.unlock()})),this.contextmenu.onShown((()=>{this.interaction.lock(),this.fakeAnnotation.getVertexes().length>=2?this.completeMenuItem.enable():this.completeMenuItem.disable()})),this.destroyPageHooks.push(this.pdfViewer.addEventListener(ya.zoomToSuccess,(t=>{gn(va)})),this.pdfViewer.addEventListener(ya.changeViewModeSuccess,((t,e)=>{gn(va)})),this.pdfViewer.addEventListener(ya.fitWidthResizeViewport,(()=>{gn(va)})))},i.create=function(e,n){const r=t.prototype.create.call(this,e,n);return this.unsubscribeMeasurementData=this.pdfViewer.getStore().subscribe("measurementData",(t=>{const e=fn(this.pdfViewer),n=this.pdfViewer.i18n.t(`measurement.units.${t.displayUnit.name}`);r.setContent(e+Math.round(100*t.area)/100+" sq "+n),r.draw()})),r},i.isPointClosely=function(t,e,n){return Math.abs(t.x-e.x)<n&&Math.abs(t.y-e.y)<n},i.pointDistance=function(t,e){const n=e.x-t.x,r=e.y-t.y;let i=Math.abs(n),o=Math.abs(r);return Math.sqrt(i*i+o*o)},i.isPointOnLine=function(t,e,n){if(this.isPointClosely(t,e,Number.EPSILON)||this.isPointClosely(t,n,Number.EPSILON))return!0;let r=this.pointDistance(t,e),i=this.pointDistance(t,n),o=this.pointDistance(e,n);return Math.abs(r+i-o)<xa},i.checkLineCrossed=function(t,e,n,r){let i,o;if(i=Math.abs(e.x-t.x)<1e-4?Number.POSITIVE_INFINITY:(e.y-t.y)/(e.x-t.x),o=Math.abs(r.x-n.x)<1e-4?Number.POSITIVE_INFINITY:(r.y-n.y)/(r.x-n.x),Number.isFinite(i)&&Number.isFinite(o)&&Math.abs(i-o)<.01||!Number.isFinite(i)&&!Number.isFinite(o))return!(!this.isPointOnLine(t,n,r)&&!this.isPointOnLine(e,n,r));let a,s,c=t.x>e.x?e.x:t.x,u=t.x>e.x?t.x:e.x,l=n.x>r.x?r.x:n.x,h=n.x>r.x?n.x:r.x;if(Number.isFinite(i)){if(Number.isFinite(o))return a=(i*t.x-t.y-o*n.x+n.y)/(i-o),!(a<c-xa||a>u+xa)&&(!(a<l-xa||a>h+xa)&&(s=i*(a-t.x)+t.y,!0));{a=l,s=i*(a-t.x)+t.y;let e=n.y<r.y?n.y:r.y,o=n.y<r.y?r.y:n.y;return e-xa<=s&&s<=o+xa&&c-xa<=a&&a<=u+xa}}{a=c,s=o*(a-n.x)+n.y;let r=t.y<e.y?t.y:e.y,i=t.y<e.y?e.y:t.y;return r-xa<=s&&s<=i+xa&&l-xa<=a&&a<=h+xa}},i.checkIfPointAllowAdded=function(t,e,n=!1){if(t.length<1&&!n)return!0;if(2==t.length&&!n)return!this.isPointOnLine(e,t[0],t[1]);const r=function(t,e){for(let n=0;n<t.length-2;n++)if(Ea(t[n],t[(n+1)%t.length],e,t[t.length-1]))return"disableAdd";for(let n=1;n<t.length-1;n++)if(Ea(t[n],t[(n+1)%t.length],e,t[0]))return"noClosing";return"success"}(t,e);return"success"==r?(this.fakeAnnotation.setFlag(!0,!0),!0):"noClosing"==r&&!n&&(this.fakeAnnotation.setFlag(!1,!1),!0)},i.addPoint=function(t,{deviceX:e,deviceY:n}){const[r,i]=t.page.reverseDevicePoint([e,n],t.scale,t.rotate),o=this.pageRender.$handler;if(!this.checkIfPointAllowAdded(t.getVertexes(),{x:r,y:i}))return void o.addClass("fv__cursor-disable");o.removeClass("fv__cursor-disable");let a=t.getVertexes();if(a.length>2&&this.isPointClosely(a[0],{x:r,y:i},Aa)){const e=a[a.length-1],[n,r]=t.page.getDevicePoint([e.x,e.y],t.scale,t.rotate),i=t.pageRender.$handler[0].getBoundingClientRect();return this.interaction.lastMoveData={clientX:n+i.left,clientY:r+i.top},void this.pdfViewer.getStore().dispatch("create-measurement-status","complete")}t.addPoint(e,n),t.draw()},i.adjust=function(t,e){const[n,r]=t.page.reverseDevicePoint([e.deviceX,e.deviceY],t.scale,t.rotate),i=this.pageRender.$handler;this.checkIfPointAllowAdded(t.getVertexes(),{x:n,y:r})?(i.removeClass("fv__cursor-disable"),t.setLastPoint(e.deviceX,e.deviceY),t.draw(),this.pdfViewer.eventEmitter.emit(ya.updateDistanceAnnot,t)):i.addClass("fv__cursor-disable")},i.end=function(e,n){if(!this.fakeAnnotation)return;this.unsubscribeMeasurementData&&this.unsubscribeMeasurementData();let[...r]=e.getVertexes();if(0==r.length)return;if(null!=n){const[t,i]=e.page.reverseDevicePoint([n.deviceX,n.deviceY],e.scale,e.rotate),o=this.pageRender.$handler;if(!this.checkIfPointAllowAdded(r,{x:t,y:i},!0))return o.addClass("fv__cursor-disable"),-1;o.removeClass("fv__cursor-disable"),this.isPointClosely(r[r.length-1],{x:t,y:i},Aa)?n=null:r.push({x:t,y:i})}this.isEnd=!0,this.contextmenu.disable();const{markup:i}=pn(this.pdfViewer);if(i){this.fakeAnnotation.annotationInfo.measure=this.getMeasurementInfo(),this.pdfViewer.eventEmitter.emit(ya.distanceAnnotCreationEnd,this.fakeAnnotation);const r=this.pdfViewer.getStore().getCurrentValue("measurementData");if(r){const t=fn(this.pdfViewer),n=this.pdfViewer.i18n.t(`measurement.units.${r.displayUnit.name}`);e.setContent(t+Math.round(100*r.area)/100+" sq "+n)}e.annotationInfo.measure=this.fakeAnnotation.annotationInfo.measure,t.prototype.end.call(this,e,n)}else{this.fakeAnnotation.renderer.setMarkUp(this.pageRender.scale,this.pageRender.rotate),va.push(this.fakeAnnotation)}},i.cancel=function(){this.fakeAnnotation&&(this.pdfViewer.eventEmitter.emit(ya.distanceAnnotCreationCancel,this.fakeAnnotation),t.prototype.cancel.call(this),this.creatingContextmenu&&this.creatingContextmenu.disable())},i.destroyPageHandler=function(){this.isEnd||this.cancel(),gn(va),t.prototype.destroyPageHandler.call(this)},r}(oi);const{CreateMeasurementService:Pa}=r.stateHandler;let Ca=[];const{ViewerEvents:_a,Consts:{Intents:Ia}}=r;let Da=function(t){function r(e){var n;return(n=t.call(this,e)||this).isEnd=!0,n}e(r,t),r.getStateName=function(){return"createCircleArea"};var i=r.prototype;return i.start=function(t){const e={flags:4,subject:this.getSubject()};this.currentFakeAnnot=new yn({pdfViewer:this.pdfViewer,pageRender:this.pageRender,info:this.createAnnotJson(e)});let{left:n,top:r}=t;this.currentFakeAnnot.setRect({left:n,top:r,right:n+10,bottom:r-10}),this.pdfViewer.eventEmitter.emit(_a.distanceAnnotCreationStart,this.currentFakeAnnot),this.unsubscribeMeasurementData=this.pdfViewer.getStore().subscribe("measurementData",(t=>{const e=fn(this.pdfViewer),n=Ae(t.displayUnit.name)?this.pdfViewer.i18n.t(`measurement.units.${t.displayUnit.name}`):t.displayUnit.name;t.area&&this.currentFakeAnnot.setContent(e+t.area.toFixed(2)+" sq "+n),this.currentFakeAnnot.draw()})),gn(Ca)},i.adjust=function(e,n,r){t.prototype.adjust.call(this,e,n,r),this.pdfViewer.eventEmitter.emit(_a.updateDistanceAnnot,e)},i.end=function(e,n,r){this.unsubscribeMeasurementData&&this.unsubscribeMeasurementData();const{markup:i}=pn(this.pdfViewer);i?(e.annotationInfo.measure=this.getMeasurementInfo(),this.pdfViewer.eventEmitter.emit(_a.distanceAnnotCreationEnd,e),t.prototype.end.call(this,e,n,r)):Ca.push(e)},i.getMeasurementInfo=function(){const t=this.pdfViewer.getIoC().getInstanceByClass(Pa).getMeasurementInfo();return{unit:t[zo].name,ratio:{userSpaceValue:t[Xo],userSpaceUnit:t[Yo].name,realValue:t[Go],realUnit:t[zo].name}}},i.createAnnotJson=function(t){const e=this.pdfViewer.getDefaultAnnotConfig()("circle",Ia.CIRCLE_DIMENSION);return t.enableCaption=!0,t.intent=Ia.CIRCLE_DIMENSION,t.measure=this.getMeasurementInfo(),n(t,e)},i.pageHandler=function(e){t.prototype.pageHandler.call(this,e),this.destroyPageHooks=[],this.destroyPageHooks.push(this.pdfViewer.addEventListener(_a.zoomToSuccess,(t=>{gn(Ca)})),this.pdfViewer.addEventListener(_a.changeViewModeSuccess,((t,e)=>{gn(Ca)})),this.pdfViewer.addEventListener(_a.fitWidthResizeViewport,(()=>{gn(Ca)})))},i.destroyPageHandler=function(){t.prototype.destroyPageHandler.call(this),gn(Ca)},r}(Mn),Ma=function(){function t(){}t.inject=function(){return{pdfViewer:r.PDFViewer}};var e=t.prototype;return e.getInternalStampService=function(){var t;return null===(t=this.pdfViewer)||void 0===t?void 0:t.getIoC().getInstanceByClass(vo)},e.getCurrentStampInfo=function(){if(this.pdfViewer.getStateHandlerManager().getCurrentStates()!==Po)return;const t=this.getInternalStampService().getCurrentStampConfig();return t?{category:t.category,iconName:t.name,width:t.width,height:t.height,url:t.url,fileType:t.fileType}:void 0},e.onSelectStampInfo=function(t){return this.getInternalStampService().onSwitchStamp((()=>{t(this.getCurrentStampInfo())}))},t}(),La=function(){function t(t){this.pdfViewer=t}var n=t.prototype;return n.getStampService=function(){return this.pdfViewer.getIoC().getInstanceByClass(Ma)},n.init=function({showReplyDialog:t,hideReplyDialog:e,showPopup:n,hidePopup:r,showPropertiesDialog:i,hidePropertiesDialog:o,contextMenuIsEnable:a}={}){let s=this.pdfViewer.getStateHandlerManager();s.register(p),s.register(_),s.register(M),s.register(V),s.register(N),s.register(B),s.register(at),s.register(Mt),s.register(Yt),s.register(Jt),s.register(_n),s.register(Mn),s.register(ar),s.register(hr),s.register(oi),s.register(hi),s.register(Si),s.register(_i),s.register(Yi),s.register(uo),s.register(Po),s.register(Bo),s.register(ia),s.register(pa),s.register(Ta),s.register(Da),(t||e||n||r||i||o||a)&&this._overwriteAnnot(t,e,n,r,i,o,a)},n._overwriteAnnot=function(t,n,r,i,o,a,s){this.pdfViewer.getAnnotManager().registerMatchRule((function(c,u){return c.isMarkup()?function(c){function u(){return c.apply(this,arguments)||this}e(u,c);var l=u.prototype;return l.showReplyDialog=function(...e){var n;return t?t.bind(this).apply(void 0,e):(n=c.prototype.showReplyDialog).call.apply(n,[this].concat(e))},l.hideReplyDialog=function(...e){if(!n){var r;if(t)return;return(r=c.prototype.hideReplyDialog).call.apply(r,[this].concat(e))}return n.bind(this).apply(void 0,e)},l.showPopup=function(...t){var e;return r?r.bind(this).apply(void 0,t):(e=c.prototype.showPopup).call.apply(e,[this].concat(t))},l.hidePopup=function(...t){if(!i){var e;if(r)return;return(e=c.prototype.hidePopup).call.apply(e,[this].concat(t))}return i.bind(this).apply(void 0,t)},l.showPropertiesDialog=function(...t){var e;return o?o.bind(this).apply(void 0,t):(e=c.prototype.showPropertiesDialog).call.apply(e,[this].concat(t))},l.hidePropertiesDialog=function(...t){if(!a){var e;if(o)return;return(e=c.prototype.hidePropertiesDialog).call.apply(e,[this].concat(t))}return a.bind(this).apply(void 0,t)},l.contextMenuIsEnable=function(...t){var e;return s?s.bind(this).apply(void 0,t):(e=c.prototype.contextMenuIsEnable).call.apply(e,[this].concat(t))},u}(u):u}))},t}()}(),s}()}));